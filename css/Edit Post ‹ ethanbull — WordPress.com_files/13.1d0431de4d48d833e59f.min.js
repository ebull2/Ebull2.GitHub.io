(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{"./client/blocks/comment-button/index.jsx":function(e,t,s){"use strict";var o=s("./node_modules/prop-types/index.js"),n=s.n(o),a=s("./node_modules/react/index.js"),r=s.n(a),i=s("./node_modules/react-redux/es/index.js"),c=s("./packages/i18n-calypso/dist/esm/index.js"),l=s("./node_modules/lodash/lodash.js"),d=s("./client/components/gridicon/index.jsx"),p=s("./client/state/comments/selectors.js");s("./client/blocks/comment-button/style.scss");function m(e){const t=e.commentCount,s=e.href,o=e.onClick,n=e.showLabel,a=e.tagName,i=e.target,p=Object(c.useTranslate)();return r.a.createElement(a,Object(l.omitBy)({className:"comment-button",href:"a"===a?s:null,onClick:o,target:"a"===a?i:null},l.isNull),r.a.createElement(d.a,{icon:"comment",size:e.size,className:"comment-button__icon"}),r.a.createElement("span",{className:"comment-button__label"},t>0&&r.a.createElement("span",{className:"comment-button__label-count"},t),n&&t>0&&r.a.createElement("span",{className:"comment-button__label-status"},p("Comment","Comments",{context:"noun",count:t}))))}m.propTypes={commentCount:n.a.number,href:n.a.string,onClick:n.a.func,showLabel:n.a.bool,tagName:n.a.string,target:n.a.string},m.defaultProps={commentCount:0,href:null,onClick:l.noop,showLabel:!0,size:24,tagName:"li",target:null};t.a=Object(i.b)((e,t)=>{const s=t.post,o=void 0===s?{}:s,n=o.site_ID,a=o.ID,r=t.commentCount;return{commentCount:Object(p.l)(e,n,a)||r}})(m)},"./client/blocks/comment-button/style.scss":function(e,t,s){},"./client/blocks/comments/comment-actions.scss":function(e,t,s){},"./client/blocks/comments/comment-approve-action.scss":function(e,t,s){},"./client/blocks/comments/comment-edit-form.scss":function(e,t,s){},"./client/blocks/comments/form-root.jsx":function(e,t,s){"use strict";var o=s("./node_modules/react/index.js"),n=s.n(o),a=s("./node_modules/prop-types/index.js"),r=s.n(a),i=s("./node_modules/lodash/lodash.js"),c=s("./client/blocks/comments/form.jsx");const l=e=>{let t=e.post,s=e.commentText,o=e.activeReplyCommentId,a=e.commentsTree,r=e.onUpdateCommentText,l=void 0===r?i.noop:r;return o||Object(i.some)(a,e=>e.data&&e.data.isPlaceholder&&!e.data.parent)?null:n.a.createElement(c.a,{post:t,parentCommentId:null,commentText:s,onUpdateCommentText:l})};l.propTypes={post:r.a.object.isRequired,commentText:r.a.string,activeReplyCommentId:r.a.number,commentsTree:r.a.object,onUpdateCommentText:r.a.func},t.a=l},"./client/blocks/comments/form-textarea.jsx":function(e,t,s){"use strict";var o=s("./node_modules/react/index.js"),n=s.n(o),a=s("./node_modules/@babel/runtime/helpers/extends.js"),r=s.n(a),i=s("./node_modules/@babel/runtime/helpers/defineProperty.js"),c=s.n(i),l=s("./node_modules/prop-types/index.js"),d=s.n(l),p=s("./node_modules/react-redux/es/index.js"),m=s("./client/components/data/query-users-suggestions/index.jsx"),u=s("./client/state/users/suggestions/selectors.js");var h=e=>{class t extends n.a.PureComponent{render(){return n.a.createElement(o.Fragment,null,!!this.props.siteId&&n.a.createElement(m.a,{siteId:this.props.siteId}),n.a.createElement(e,this.props))}}return c()(t,"propTypes",{siteId:d.a.number}),Object(p.b)((e,t)=>({siteId:t.siteId,suggestions:Object(u.a)(e,t.siteId)}))(t)},b=s("./client/blocks/user-mentions/add.jsx");var f=e=>{class t extends n.a.PureComponent{render(){return n.a.createElement(e,r()({},this.props,{ref:this.props.forwardedRef}))}}return c()(t,"propTypes",{siteId:d.a.number}),h(Object(b.a)(n.a.forwardRef((e,s)=>n.a.createElement(t,r()({},e,{forwardedRef:s})))))},j=s("./client/lib/url/index.js"),g=s("./client/config/index.js");let _=n.a.forwardRef((e,t)=>n.a.createElement("textarea",{className:"comments__form-textarea",value:e.value,placeholder:e.placeholder,ref:t,onKeyUp:e.onKeyUp,onKeyDown:e.onKeyDown,onFocus:e.onFocus,onBlur:e.onBlur,onChange:e.onChange,onPaste:e.onPaste,autoFocus:e.enableAutoFocus}));Object(g.c)("reader/paste-to-link")&&(_=(e=>{class t extends n.a.Component{constructor(e){super(e),c()(this,"handlePaste",e=>{const t=e.clipboardData&&e.clipboardData.getData("text/plain"),s=this.textareaRef.current;t&&t.length>0&&s&&s.selectionStart!==s.selectionEnd&&Object(j.i)(t)&&(e.preventDefault(),this.insertLink(t))}),this.textareaRef=this.props.forwardedRef,this.textareaRef||(this.textareaRef=n.a.createRef())}insertLink(e){const t=this.textareaRef.current;if(!t)return;const s=t.value.slice(0,t.selectionStart),o=t.value.slice(t.selectionStart,t.selectionEnd),n=t.value.slice(t.selectionEnd,t.value.length+1),a='<a href="'+encodeURI(e)+'">'+o+"</a>",r=t.value.length;document.execCommand("insertText",!1,a),r===t.value.length&&(t.value=s+a+n,t.selectionEnd=s.length+a.length)}render(){return n.a.createElement(e,r()({},this.props,{onPaste:this.handlePaste,ref:this.textareaRef}))}}return c()(t,"displayName","withPasteToLink( ".concat(e.displayName||e.name," )")),c()(t,"propTypes",{}),n.a.forwardRef((e,s)=>n.a.createElement(t,r()({},e,{forwardedRef:s})))})(_)),Object(g.c)("reader/user-mention-suggestions")&&(_=f(_));t.a=_},"./client/blocks/comments/form.jsx":function(e,t,s){"use strict";var o=s("./node_modules/react/index.js"),n=s.n(o),a=s("./node_modules/prop-types/index.js"),r=s.n(a),i=s("./node_modules/classnames/index.js"),c=s.n(i),l=s("./node_modules/react-redux/es/index.js"),d=s("./node_modules/lodash/lodash.js"),p=s("./packages/i18n-calypso/dist/esm/index.js"),m=s("./client/components/auto-direction/index.jsx"),u=s("./client/components/forms/form-input-validation/index.jsx"),h=s("./client/components/gravatar/index.jsx"),b=s("./client/state/current-user/selectors.js"),f=s("./client/state/comments/actions.js"),j=s("./client/reader/stats.js"),g=s("./client/blocks/comments/helper.jsx"),_=s("./client/lib/protect-form/index.tsx"),y=s("./client/blocks/comments/form-textarea.jsx");s("./client/blocks/comments/form.scss");class E extends n.a.Component{constructor(e){super(),this.state={commentText:e.commentText||"",haveFocus:!1},Object.getOwnPropertyNames(E.prototype).filter(e=>0===e.indexOf("handle")).filter(e=>"function"==typeof this[e]).forEach(e=>this[e]=this[e].bind(this))}componentWillReceiveProps(e){this.setState({commentText:e.commentText||""})}handleSubmit(e){e.preventDefault(),this.submit()}handleKeyDown(e){13===e.keyCode&&(e.ctrlKey||e.metaKey)&&(e.preventDefault(),this.submit()),27===e.keyCode&&this.props.placeholderId&&(this.props.onUpdateCommentText(this.props.commentText),this.props.deleteComment(this.props.post.site_ID,this.props.post.ID,this.props.placeholderId))}handleFocus(){this.setState({haveFocus:!0})}handleTextChange(e){const t=e.target.value;this.setState({commentText:t}),this.props.onUpdateCommentText(t)}resetCommentText(){this.setState({commentText:""}),this.props.onUpdateCommentText("")}hasCommentText(){return this.state.commentText.trim().length>0}submit(){const e=this.props.post,t=this.state.commentText.trim();return t?(this.props.placeholderId&&this.props.deleteComment(e.site_ID,e.ID,this.props.placeholderId),this.props.parentCommentId?this.props.replyComment(t,e.site_ID,e.ID,this.props.parentCommentId):this.props.writeComment(t,e.site_ID,e.ID),Object(j.recordAction)("posted_comment"),Object(j.recordGaEvent)("Clicked Post Comment Button"),Object(j.recordTrackForPost)("calypso_reader_article_commented_on",e,{parent_post_id:this.props.parentCommentId?this.props.parentCommentId:void 0}),this.resetCommentText(),this.props.onCommentSubmit(),!0):(this.resetCommentText(),!1)}renderError(){let e;if(!this.props.error)return null;switch(this.props.errorType){case"comment_duplicate":e=Object(p.translate)("Duplicate comment detected. It looks like you've already said that!");break;default:e=Object(p.translate)("Sorry - there was a problem posting your comment.")}return n.a.createElement(u.a,{isError:!0,text:e})}render(){const e=this.props.post;if(e&&e.discussion&&!1===e.discussion.comments_open&&!Object(g.a)(e))return e.discussion.comment_count&&e.discussion.comment_count>0?n.a.createElement("p",{className:"comments__form-closed"},Object(p.translate)("Comments closed.")):null;const t=c()({"is-active":this.hasCommentText(),"is-visible":this.state.haveFocus||this.hasCommentText()}),s=c()({focused:this.state.haveFocus,"expanding-area":!0}),o=!!this.props.parentCommentId;return n.a.createElement("form",{className:"comments__form"},n.a.createElement(_.a,{isChanged:this.hasCommentText()}),n.a.createElement("fieldset",null,n.a.createElement(h.a,{user:this.props.currentUser}),n.a.createElement("div",{className:s},n.a.createElement("pre",null,n.a.createElement("span",null,this.state.commentText),n.a.createElement("br",null)),n.a.createElement(m.a,null,n.a.createElement(y.a,{value:this.state.commentText,placeholder:Object(p.translate)("Enter your comment hereâ€¦"),onKeyUp:this.handleKeyUp,onKeyDown:this.handleKeyDown,onFocus:this.handleFocus,onBlur:this.handleBlur,onChange:this.handleTextChange,siteId:e.site_ID,enableAutoFocus:o}))),n.a.createElement("button",{className:t,disabled:0===this.state.commentText.length,onClick:this.handleSubmit},this.props.error?Object(p.translate)("Resend"):Object(p.translate)("Send")),this.renderError()))}}E.propTypes={post:r.a.object.isRequired,parentCommentId:r.a.number,placeholderId:r.a.string,commentText:r.a.string,onUpdateCommentText:r.a.func.isRequired,onCommentSubmit:r.a.func,currentUser:r.a.object.isRequired,writeComment:r.a.func.isRequired,deleteComment:r.a.func.isRequired,replyComment:r.a.func.isRequired},E.defaultProps={onCommentSubmit:d.noop},t.a=Object(l.b)(e=>({currentUser:Object(b.b)(e)}),{writeComment:f.p,deleteComment:f.b,replyComment:f.h})(E)},"./client/blocks/comments/form.scss":function(e,t,s){},"./client/blocks/comments/helper.jsx":function(e,t,s){"use strict";s.d(t,"b",function(){return n}),s.d(t,"a",function(){return a});var o=s("./client/reader/discover/helper.js");function n(e){return!!a(e)||!(!e.discussion||!(e.discussion.comments_open||e.discussion.comment_count>0))}function a(e){return!(!o.j(e)||!o.l(e)||o.k(e))}},"./client/blocks/comments/post-comment-content.scss":function(e,t,s){},"./client/blocks/comments/post-comment-with-error.scss":function(e,t,s){},"./client/blocks/comments/post-comment.jsx":function(e,t,s){"use strict";var o=s("./node_modules/@babel/runtime/helpers/extends.js"),n=s.n(o),a=s("./node_modules/@babel/runtime/helpers/defineProperty.js"),r=s.n(a),i=s("./node_modules/react/index.js"),c=s.n(i),l=s("./node_modules/prop-types/index.js"),d=s.n(l),p=s("./node_modules/lodash/lodash.js"),m=s("./node_modules/react-redux/es/index.js"),u=s("./packages/i18n-calypso/dist/esm/index.js"),h=s("./client/components/gridicon/index.jsx"),b=s("./node_modules/classnames/index.js"),f=s.n(b),j=s("./client/config/index.js"),g=s("./client/state/current-user/selectors.js"),_=s("./client/components/time-since/index.jsx"),y=s("./client/components/gravatar/index.jsx"),E=s("./client/reader/stats.js"),k=s("./client/reader/route/index.js"),x=s("./client/components/auto-direction/index.jsx"),O=s("./client/components/emojify/index.jsx");s("./client/blocks/comments/post-comment-content.scss");class v extends c.a.Component{render(){return this.props.isPlaceholder?c.a.createElement("div",{className:f()("comments__comment-content",this.props.className)},this.props.content.split("\n").map((e,t)=>c.a.createElement("span",{key:t},e,c.a.createElement("br",null)))):c.a.createElement(x.a,null,c.a.createElement("div",{className:f()("comments__comment-content-wrapper",this.props.className)},c.a.createElement(O.a,null,c.a.createElement("div",{className:"comments__comment-content",ref:this.props.setWithDimensionsRef,dangerouslySetInnerHTML:{__html:this.props.content}}))))}}r()(v,"propTypes",{content:d.a.string.isRequired,isPlaceholder:d.a.bool,className:d.a.string,setWithDimensionsRef:d.a.func}),r()(v,"defaultProps",{setWithDimensionsRef:()=>{}});var C=Object(u.localize)(v),w=s("./client/blocks/comments/form.jsx"),I=s("./node_modules/redux/es/redux.js"),S=s("./client/components/notice/index.jsx"),R=s("./client/state/comments/actions.js"),T=s("./client/blocks/comments/form-textarea.jsx");s("./client/blocks/comments/comment-edit-form.scss");class N extends i.Component{constructor(e){super(),r()(this,"handleSubmit",e=>{e.preventDefault(),this.submit()}),r()(this,"handleKeyDown",e=>{13===e.keyCode&&(e.ctrlKey||e.metaKey)&&(e.preventDefault(),this.submit()),27===e.keyCode&&this.props.placeholderId&&this.props.deleteComment(this.props.post.site_ID,this.props.post.ID,this.props.placeholderId)}),r()(this,"handleFocus",()=>this.setState({haveFocus:!0})),r()(this,"handleTextChange",e=>{const t=e.target.value;this.setState({commentText:t})}),r()(this,"resetCommentText",()=>{this.setState({commentText:""})}),r()(this,"hasCommentText",()=>this.state.commentText.trim().length>0),this.state={commentText:e.commentText||"",haveFocus:!1}}componentWillReceiveProps(e){this.setState({commentText:e.commentText||""})}submit(){const e=this.props.post,t=this.state.commentText.trim();return t?(this.props.editComment(e.site_ID,e.ID,this.props.commentId,{content:t}),Object(E.recordAction)("edited_comment"),Object(E.recordGaEvent)("Clicked Edit Comment Button"),this.resetCommentText(),this.props.onCommentSubmit(),!0):(this.resetCommentText(),!1)}renderError(){const e=this.props.error;let t;if(!e)return null;switch(e.error){case"comment_duplicate":t=Object(u.translate)("Duplicate comment detected. It looks like you've already said that!");break;default:t=Object(u.translate)("Sorry - there was a problem posting your comment.")}return c.a.createElement(S.b,{text:t,className:"comments__notice",showDismiss:!1,status:"is-error"})}render(){const e=f()({"is-active":this.hasCommentText(),"is-visible":this.state.haveFocus||this.hasCommentText()}),t=f()({focused:this.state.haveFocus,"expanding-area":!0}),s=!!this.props.parentCommentId;return c.a.createElement("form",{className:"comments__edit-form"},c.a.createElement("fieldset",null,c.a.createElement("div",{className:t},c.a.createElement("pre",null,c.a.createElement("span",null,this.state.commentText),c.a.createElement("br",null)),c.a.createElement(x.a,null,c.a.createElement(T.a,{value:this.state.commentText,onKeyUp:this.handleKeyUp,onKeyDown:this.handleKeyDown,onFocus:this.handleFocus,onBlur:this.handleBlur,onChange:this.handleTextChange,enableAutoFocus:s}))),c.a.createElement("button",{className:e,disabled:0===this.state.commentText.length,onClick:this.handleSubmit},Object(u.translate)("Send")),this.renderError()))}}N.propTypes={post:d.a.object.isRequired,commentId:d.a.number,commentText:d.a.string,onCommentSubmit:d.a.func,editComment:d.a.func.isRequired},N.defaultProps={onCommentSubmit:p.noop};var P=Object(m.b)(null,e=>Object(I.b)({editComment:R.c},e))(N),D=s("./client/state/comments/constants.js"),L=s("./client/lib/formatting/index.js");s("./client/blocks/comments/post-comment.scss"),s("./client/blocks/comments/post-comment-with-error.scss");class U extends c.a.Component{renderCommentForm(){const e=this.props,t=e.post,s=e.commentsTree,o=e.commentId,n=e.onUpdateCommentText,a=e.activeReplyCommentId,r=Object(p.get)(s,[o,"data","content"]),i=Object(p.get)(s,[o,"data","parent","ID"],null),l=Object(p.get)(s,[o,"data","placeholderError"]),d=Object(p.get)(s,[o,"data","placeholderErrorType"]);return a!==i?null:c.a.createElement(w.a,{post:t,parentCommentId:i,commentText:r,onUpdateCommentText:n,placeholderId:o,error:l,errorType:d})}render(){return c.a.createElement("li",{className:"comments__comment is-error"},this.renderCommentForm(),this.props.repliesList)}}U.propTypes={post:d.a.object.isRequired,repliesList:d.a.object,commentsTree:d.a.object.isRequired,onUpdateCommentText:d.a.func.isRequired,commentId:d.a.oneOfType([d.a.string,d.a.number]).isRequired};class A extends c.a.Component{render(){const e=this.props.commentsTree,t=Object(p.get)(e[this.props.commentId],"data");if(!t)return null;const s=Object(p.get)(t,"author.name","").replace(/&#(\d+);/g,(e,t)=>String.fromCharCode(t));return c.a.createElement("li",{className:"comments__comment depth-0"},c.a.createElement("div",{className:"comments__comment-author"},c.a.createElement("div",{className:"comments__comment-trackbackicon"},c.a.createElement(h.a,{icon:"link",size:24})),Object(p.get)(t,"author.URL")?c.a.createElement("a",{href:t.author.URL,target:"_blank",rel:"noopener noreferrer",className:"comments__comment-username"},s):c.a.createElement("strong",{className:"comments__comment-username"},s),c.a.createElement("div",{className:"comments__comment-timestamp"},c.a.createElement("a",{href:t.URL},c.a.createElement(_.a,{date:t.date})))))}}A.propTypes={commentId:d.a.number,commentsTree:d.a.object};var F=s("./client/blocks/like-button/button.jsx"),q=s("./client/state/comments/selectors.js");class M extends c.a.Component{constructor(){super(),this.boundHandleLikeToggle=this.handleLikeToggle.bind(this)}handleLikeToggle(e){e?this.props.likeComment(this.props.siteId,this.props.postId,this.props.commentId):this.props.unlikeComment(this.props.siteId,this.props.postId,this.props.commentId),Object(E.recordAction)(e?"liked_comment":"unliked_comment"),Object(E.recordGaEvent)(e?"Clicked Comment Like":"Clicked Comment Unlike"),Object(E.recordTrack)("calypso_reader_"+(e?"liked":"unliked")+"_comment",{blog_id:this.props.siteId,comment_id:this.props.commentId})}render(){const e=Object(p.pick)(this.props,["showZeroCount","tagName"]),t=Object(p.get)(this.props.commentLike,"like_count"),s=Object(p.get)(this.props.commentLike,"i_like"),o=Object(u.translate)("Liked");return c.a.createElement(F.a,n()({},e,{likeCount:t,liked:s,onLikeToggle:this.boundHandleLikeToggle,likedLabel:o,iconSize:18}))}}M.propTypes={siteId:d.a.number.isRequired,postId:d.a.number.isRequired,commentId:d.a.number.isRequired,showZeroCount:d.a.bool,tagName:d.a.string,commentLike:d.a.object,likeComment:d.a.func.isRequired,unlikeComment:d.a.func.isRequired};var z=Object(m.b)((e,t)=>({commentLike:Object(q.d)(e,t.siteId,t.postId,t.commentId)}),e=>Object(I.b)({likeComment:R.e,unlikeComment:R.o},e))(M);s("./client/blocks/comments/comment-approve-action.scss");const B=e=>{let t=e.translate,s=e.status,o=e.approveComment,n=e.unapproveComment;const a="approved"===s,r=f()("comments__comment-actions-approve",{"is-approved":a});return c.a.createElement("button",{className:r,onClick:a?n:o},c.a.createElement(h.a,{icon:"checkmark",size:18}),c.a.createElement("span",{className:"comments__comment-actions-like-label"},t(a?"Approved":"Approve")))};B.propTypes={translate:d.a.func.isRequired,approveComment:d.a.func,unapproveComment:d.a.func,status:d.a.string.isRequired},B.defaultProps={approveComment:p.noop,unapproveComment:p.noop};var W=Object(u.localize)(B),V=s("./client/components/ellipsis-menu/index.jsx"),G=s("./client/components/popover/menu-item.jsx"),K=s("./client/components/popover/menu-separator.jsx");s("./client/blocks/comments/comment-actions.scss");const H=e=>{let t=e.post,s=e.comment,o=s.isPlaceholder,n=s.status,a=e.showModerationTools,r=e.translate,i=e.activeEditCommentId,l=e.activeReplyCommentId,d=e.commentId,p=e.handleReply,m=e.onReplyCancel,u=e.approveComment,b=e.unapproveComment,j=e.trashComment,g=e.spamComment,_=e.editComment,y=e.editCommentCancel,E=e.showReadMore,k=e.onReadMore;const x=t&&t.discussion&&!0===t.discussion.comments_open,O=l===d,v=i===d,C="approved"===n;return o?null:c.a.createElement("div",{className:"comments__comment-actions"},E&&c.a.createElement("button",{className:"comments__comment-actions-read-more",onClick:k},c.a.createElement(h.a,{icon:"chevron-down",size:18,className:"comments__comment-actions-read-more-icon"}),r("Read More")),x&&c.a.createElement("button",{className:"comments__comment-actions-reply",onClick:p},c.a.createElement(h.a,{icon:"reply",size:18}),c.a.createElement("span",{className:"comments__comment-actions-reply-label"},r("Reply"))),O&&c.a.createElement("button",{className:"comments__comment-actions-cancel-reply",onClick:m},r("Cancel reply")),v&&c.a.createElement("button",{className:"comments__comment-actions-cancel-reply",onClick:y},r("Cancel")),c.a.createElement(z,{className:"comments__comment-actions-like",tagName:"button",siteId:t.site_ID,postId:t.ID,commentId:d}),a&&c.a.createElement("div",{className:"comments__comment-actions-moderation-tools"},c.a.createElement(W,{status:n,approveComment:u,unapproveComment:b}),c.a.createElement("button",{className:"comments__comment-actions-trash",onClick:j},c.a.createElement(h.a,{icon:"trash",size:18}),c.a.createElement("span",{className:"comments__comment-actions-like-label"},r("Trash"))),c.a.createElement("button",{className:"comments__comment-actions-spam",onClick:g},c.a.createElement(h.a,{icon:"spam",size:18}),c.a.createElement("span",{className:"comments__comment-actions-like-label"},r("Spam"))),c.a.createElement("button",{className:"comments__comment-actions-edit",onClick:_},c.a.createElement(h.a,{icon:"pencil",size:18}),c.a.createElement("span",{className:"comments__comment-actions-like-label"},r("Edit"))),c.a.createElement(V.a,{toggleTitle:r("More")},c.a.createElement(G.a,{className:f()("comments__comment-actions-approve",{"is-approved":C}),icon:"checkmark",onClick:C?b:u},r(C?"Approved":"Approve")),c.a.createElement(G.a,{icon:"trash",onClick:j},r("Trash")),c.a.createElement(G.a,{icon:"spam",onClick:g},r("Spam")),c.a.createElement(K.a,null),c.a.createElement(G.a,{icon:"pencil",onClick:_},r("Edit")))))};H.defaultProps={onReadMore:p.noop};var Q=Object(m.b)(null,(e,t)=>{const s=t.post,o=s.site_ID,n=s.ID,a=t.commentId;return{approveComment:()=>e(Object(R.a)(o,n,a,"approved")),unapproveComment:()=>e(Object(R.a)(o,n,a,"unapproved")),trashComment:()=>e(Object(R.a)(o,n,a,"trash")),spamComment:()=>e(Object(R.a)(o,n,a,"spam"))}})(Object(u.localize)(H)),Y=s("./client/blocks/conversation-caterpillar/index.jsx"),Z=s("./client/lib/with-dimensions/index.jsx");class X extends c.a.PureComponent{constructor(){super(...arguments),r()(this,"state",{showReplies:!1,showFull:!1}),r()(this,"handleToggleRepliesClick",()=>{this.setState({showReplies:!this.state.showReplies})}),r()(this,"handleReply",()=>{this.props.onReplyClick(this.props.commentId),this.setState({showReplies:!0})}),r()(this,"handleAuthorClick",e=>{Object(E.recordAction)("comment_author_click"),Object(E.recordGaEvent)("Clicked Author Name"),Object(E.recordTrack)("calypso_reader_comment_author_click",{blog_id:this.props.post.site_ID,post_id:this.props.post.ID,comment_id:this.props.commentId,author_url:e.target.href})}),r()(this,"handleCommentPermalinkClick",e=>{Object(E.recordPermalinkClick)("timestamp_comment",{},{blog_id:this.props.post.site_ID,post_id:this.props.post.ID,comment_id:this.props.commentId,author_url:e.target.href})}),r()(this,"getAllChildrenIds",e=>{const t=this.props.commentsTree;if(!e)return[];const s=Object(p.get)(t,[e,"children"],[]);return s.concat(Object(p.flatMap)(s,e=>this.getAllChildrenIds(e)))}),r()(this,"shouldRenderCaterpillar",()=>{const e=this.props,t=e.enableCaterpillar,s=e.commentsToShow,o=e.commentId,n=this.getAllChildrenIds(o);return t&&s&&Object(p.some)(n,e=>!s[e])}),r()(this,"shouldRenderReplies",()=>{const e=this.props,t=e.commentsToShow,s=e.commentId,o=this.getAllChildrenIds(s);return t&&Object(p.some)(o,e=>t[e])}),r()(this,"getAuthorDetails",e=>{const t=Object(p.get)(this.props.commentsTree,[e,"data"],{}),s=Object(p.get)(t,"author",{}),o=Object(L.b)(s.name);return{comment:t,commentAuthor:s,commentAuthorUrl:s.site_ID?Object(k.f)(null,s.site_ID):s&&s.URL,commentAuthorName:o}}),r()(this,"renderAuthorTag",e=>{let t=e.authorName,s=e.authorUrl,o=e.commentId,n=e.className;return s?c.a.createElement("a",{href:s,className:n,onClick:this.handleAuthorClick,id:"comment-".concat(o)},c.a.createElement(O.a,null,t)):c.a.createElement("strong",{className:n,id:"comment-".concat(o)},c.a.createElement(O.a,null,t))}),r()(this,"onReadMore",()=>{this.setState({showFull:!0}),this.props.post&&this.props.expandComments({siteId:this.props.post.site_ID,commentIds:[this.props.commentId],postId:this.props.post.ID,displayType:D.c.full}),Object(E.recordAction)("comment_read_more_click"),Object(E.recordGaEvent)("Clicked Comment Read More"),Object(E.recordTrack)("calypso_reader_comment_read_more_click",{blog_id:this.props.post.site_ID,post_id:this.props.post.ID,comment_id:this.props.commentId})})}renderRepliesList(){const e=this.props,t=e.commentsToShow,s=e.depth,o=e.commentId,n=e.commentsTree,a=e.maxChildrenToShow,r=e.enableCaterpillar,i=e.post,l=e.maxDepth,d=Object(p.get)(n,[o,"children"]),m=d&&d.length<a,b=this.state.showReplies||m||r,f=!t||t[o]?s+1:s;if(!d||d.length<1)return null;const j=Object(u.translate)("show %(numOfReplies)d reply","show %(numOfReplies)d replies",{count:d.length,args:{numOfReplies:d.length}}),g=Object(u.translate)("hide %(numOfReplies)d reply","hide %(numOfReplies)d replies",{count:d.length,args:{numOfReplies:d.length}});let _=null;return m||r||(_=this.state.showReplies?g:j),c.a.createElement("div",null,!!_&&c.a.createElement("button",{className:"comments__view-replies-btn",onClick:this.handleToggleRepliesClick},c.a.createElement(h.a,{icon:"reply",size:18})," ",_),b&&c.a.createElement("ol",{className:"comments__list"},d.map(e=>c.a.createElement(J,{showNestingReplyArrow:this.props.showNestingReplyArrow,showReadMoreInActions:this.props.showReadMoreInActions,enableCaterpillar:r,depth:f,maxDepth:l,key:e,commentId:e,commentsTree:n,commentsToShow:t,post:i,onReplyClick:this.props.onReplyClick,onReplyCancel:this.props.onReplyCancel,activeReplyCommentId:this.props.activeReplyCommentId,onEditCommentClick:this.props.onEditCommentClick,onEditCommentCancel:this.props.onEditCommentCancel,activeEditCommentId:this.props.activeEditCommentId,onUpdateCommentText:this.props.onUpdateCommentText,onCommentSubmit:this.props.onCommentSubmit}))))}renderCommentForm(){if(this.props.activeReplyCommentId!==this.props.commentId)return null;return Object(p.get)(this.props.commentsTree,[this.props.commentId,"data","placeholderState"])===D.b.PENDING?null:c.a.createElement(w.a,{post:this.props.post,parentCommentId:this.props.commentId,commentText:this.props.commentText,onUpdateCommentText:this.props.onUpdateCommentText,onCommentSubmit:this.props.onCommentSubmit})}render(){const e=this.props,t=e.commentsTree,s=e.commentId,o=e.depth,a=e.enableCaterpillar,r=e.maxDepth,i=e.post,l=e.commentsToShow,d=e.overflowY,m=e.showReadMoreInActions,b=e.hidePingbacksAndTrackbacks,g=Object(p.get)(t,[s,"data"]),E="trackback"===g.type||"pingback"===g.type;if(!g||b&&E)return null;if(l&&!l[s])return this.shouldRenderReplies()&&c.a.createElement("div",null,this.renderRepliesList());const k=this.state.showFull||!a?D.c.full:l[s],x=Object(p.some)(Object(p.get)(t,[this.props.commentId,"children"]),e=>Object(p.get)(t,[e,"data","placeholderState"])===D.b.ERROR);if(g.isPlaceholder?(g.author=this.props.currentUser,g.author.name=this.props.currentUser.display_name):g.author.name=Object(L.b)(g.author.name),g.isPlaceholder&&g.placeholderState===D.b.ERROR)return c.a.createElement(U,n()({},this.props,{repliesList:this.renderRepliesList()}));if(E)return c.a.createElement(A,this.props);const O=Object(p.get)(g,"parent.ID"),v=this.getAuthorDetails(s),w=v.commentAuthorUrl,I=v.commentAuthorName,S=this.getAuthorDetails(O),R=S.commentAuthorUrl,T=S.commentAuthorName,N=f()("comments__comment",{["depth-"+o]:o<=r&&o<=3});return c.a.createElement("li",{className:N},c.a.createElement("div",{className:"comments__comment-author"},w?c.a.createElement("a",{href:w,onClick:this.handleAuthorClick},c.a.createElement(y.a,{user:g.author})):c.a.createElement(y.a,{user:g.author}),this.renderAuthorTag({authorUrl:w,authorName:I,commentId:s,className:"comments__comment-username"}),this.props.showNestingReplyArrow&&T&&c.a.createElement("span",{className:"comments__comment-respondee"},c.a.createElement(h.a,{icon:"chevron-right",size:16}),this.renderAuthorTag({className:"comments__comment-respondee-link",authorName:T,authorUrl:R,commentId:O})),c.a.createElement("div",{className:"comments__comment-timestamp"},c.a.createElement("a",{href:g.URL,target:"_blank",rel:"noopener noreferrer",onClick:this.handleCommentPermalinkClick},c.a.createElement(_.a,{date:g.date})))),g.status&&"unapproved"===g.status?c.a.createElement("p",{className:"comments__comment-moderation"},Object(u.translate)("Your comment is awaiting moderation.")):null,this.props.activeEditCommentId!==this.props.commentId&&c.a.createElement(C,{content:g.content,setWithDimensionsRef:this.props.setWithDimensionsRef,isPlaceholder:g.isPlaceholder,className:k}),Object(j.c)("comments/moderation-tools-in-posts")&&this.props.activeEditCommentId===this.props.commentId&&c.a.createElement(P,{post:this.props.post,commentId:this.props.commentId,commentText:g.content,onCommentSubmit:this.props.onEditCommentCancel}),c.a.createElement(Q,{post:this.props.post||{},comment:g,showModerationTools:this.props.showModerationTools,activeEditCommentId:this.props.activeEditCommentId,activeReplyCommentId:this.props.activeReplyCommentId,commentId:this.props.commentId,editComment:this.props.onEditCommentClick,editCommentCancel:this.props.onEditCommentCancel,handleReply:this.handleReply,onReplyCancel:this.props.onReplyCancel,showReadMore:d&&!this.state.showFull&&m,onReadMore:this.onReadMore}),x?null:this.renderCommentForm(),this.shouldRenderCaterpillar()&&c.a.createElement(Y.b,{blogId:i.site_ID,postId:i.ID,parentCommentId:s,commentsToShow:l}),this.renderRepliesList())}}r()(X,"propTypes",{commentsTree:d.a.object.isRequired,commentId:d.a.oneOfType([d.a.string,d.a.number]).isRequired,onReplyClick:d.a.func,depth:d.a.number,post:d.a.object,maxChildrenToShow:d.a.number,onCommentSubmit:d.a.func,maxDepth:d.a.number,showNestingReplyArrow:d.a.bool,showReadMoreInActions:d.a.bool,hidePingbacksAndTrackbacks:d.a.bool,commentsToShow:d.a.object,enableCaterpillar:d.a.bool,currentUser:d.a.object.isRequired}),r()(X,"defaultProps",{onReplyClick:p.noop,errors:[],depth:1,maxDepth:1/0,maxChildrenToShow:5,onCommentSubmit:p.noop,showNestingReplyArrow:!1,showReadMoreInActions:!1,hidePingbacksAndTrackbacks:!1});const J=Object(m.b)(e=>({currentUser:Object(g.b)(e)}),{expandComments:R.d})(Object(Z.a)(X));t.a=J},"./client/blocks/comments/post-comment.scss":function(e,t,s){},"./client/blocks/conversation-caterpillar/index.jsx":function(e,t,s){"use strict";var o=s("./node_modules/@babel/runtime/helpers/defineProperty.js"),n=s.n(o),a=s("./node_modules/react/index.js"),r=s.n(a),i=s("./node_modules/prop-types/index.js"),c=s.n(i),l=s("./node_modules/react-redux/es/index.js"),d=s("./node_modules/lodash/lodash.js"),p=s("./packages/i18n-calypso/dist/esm/index.js"),m=s("./client/reader/stats.js"),u=s("./client/state/comments/selectors.js"),h=s("./client/state/comments/actions.js"),b=s("./client/state/comments/constants.js");const f=(e,t,s)=>{if(!(e&&t&&t.parent&&s))return!1;const o=Object(d.get)(s,[t.parent.ID,"data"]);return t.parent.ID===e.ID||f(e,o,s)};var j=s("./client/components/gravatar-caterpillar/index.jsx");s.d(t,"a",function(){return E});const g=10,_=10;class y extends r.a.Component{constructor(){super(...arguments),n()(this,"getExpandableComments",()=>{const e=this.props,t=e.comments,s=e.commentsToShow,o=e.parentCommentId,n=e.commentsTree,a=!o,r=Object(d.get)(n,[o,"data"]),i=a?t:Object(d.filter)(t,e=>f(r,e,n));return Object(d.filter)(i,e=>!s[e.ID])}),n()(this,"handleTickle",()=>{const e=this.props,t=e.blogId,s=e.postId,o=Object(d.takeRight)(this.getExpandableComments(),_);this.props.expandComments({siteId:t,postId:s,commentIds:Object(d.map)(o,"ID"),displayType:b.c.excerpt}),this.props.expandComments({siteId:t,postId:s,commentIds:Object(d.compact)(Object(d.map)(o,e=>Object(d.get)(e,"parent.ID",null))),displayType:b.c.excerpt}),Object(m.recordAction)("comment_caterpillar_click"),Object(m.recordGaEvent)("Clicked Caterpillar"),Object(m.recordTrack)("calypso_reader_comment_caterpillar_click",{blog_id:t,post_id:s})})}render(){const e=this.props,t=e.translate,s=e.parentCommentId,o=e.comments,n=this.getExpandableComments(),a=Object(d.takeRight)(n,_),i=!s,c=this.props.commentCount-Object(d.size)(o),l=i?c+Object(d.size)(n):Object(d.size)(n),p=Object(d.uniqBy)(Object(d.map)(a,"author"),"avatar_URL"),m=Object(d.size)(p),u=Object(d.get)(Object(d.last)(p),"name");return r.a.createElement("div",{className:"conversation-caterpillar"},r.a.createElement(j.a,{users:p,onClick:this.handleTickle,maxGravatarsToDisplay:g}),r.a.createElement("button",{className:"conversation-caterpillar__count",onClick:this.handleTickle,title:l>0&&t("View %(count)s comment for this post","View %(count)s comments for this post",{count:+l,args:{count:l}})},l>1&&m>1&&t("Load previous comments from %(commenterName)s and others",{args:{commenterName:u,count:l}}),l>1&&1===m&&t("Load previous comments from %(commenterName)s",{args:{commenterName:u,count:l}}),1===l&&t("Load previous comment from %(commenterName)s",{args:{commenterName:u}})))}}n()(y,"propTypes",{blogId:c.a.number.isRequired,postId:c.a.number.isRequired,commentsTree:c.a.object.isRequired,comments:c.a.array.isRequired,commentsToShow:c.a.object,parentCommentId:c.a.number});const E=Object(p.localize)(y),k=Object(l.b)((e,t)=>{const s=t.blogId,o=t.postId;return{comments:Object(u.e)(e,s,o),commentsTree:Object(u.i)(e,s,o,"all")}},{expandComments:h.d})(E);t.b=k},"./client/blocks/conversation-follow-button/button.jsx":function(e,t,s){"use strict";var o=s("./node_modules/@babel/runtime/helpers/defineProperty.js"),n=s.n(o),a=s("./node_modules/prop-types/index.js"),r=s.n(a),i=s("./node_modules/react/index.js"),c=s.n(i),l=s("./node_modules/lodash/lodash.js"),d=s("./packages/i18n-calypso/dist/esm/index.js"),p=s("./client/components/gridicon/index.jsx");class m extends c.a.Component{constructor(){super(...arguments),n()(this,"toggleFollow",e=>{e&&e.preventDefault(),this.props.onFollowToggle(!this.props.isFollowing)})}render(){const e=this.props,t=e.isFollowing,s=e.translate,o=["button","has-icon","conversation-follow-button",this.props.className],n=s(t?"Following Conversation":"Follow Conversation");this.props.isFollowing&&o.push("is-following");const a=c.a.createElement(p.a,{key:"following",icon:"reader-following-conversation",size:20}),r=c.a.createElement(p.a,{key:"follow",icon:"reader-follow-conversation",size:20}),i=c.a.createElement("span",{key:"label",className:"conversation-follow-button__label"},n);return c.a.createElement(this.props.tagName,{onClick:this.toggleFollow,className:o.join(" "),title:n},[a,r,i])}}n()(m,"propTypes",{isFollowing:r.a.bool.isRequired,onFollowToggle:r.a.func,tagName:r.a.oneOfType([r.a.string,r.a.func])}),n()(m,"defaultProps",{isFollowing:!1,onFollowToggle:l.noop,tagName:"button"}),t.a=Object(d.localize)(m)},"./client/blocks/conversation-follow-button/helper.js":function(e,t,s){"use strict";s.d(t,"a",function(){return a});var o=s("./client/reader/discover/helper.js"),n=s("./client/blocks/comments/helper.jsx");function a(e){return e.site_ID&&!e.is_external&&Object(n.b)(e)&&!Object(o.j)(e)}},"./client/blocks/conversation-follow-button/index.jsx":function(e,t,s){"use strict";var o=s("./node_modules/@babel/runtime/helpers/defineProperty.js"),n=s.n(o),a=s("./node_modules/prop-types/index.js"),r=s.n(a),i=s("./node_modules/react/index.js"),c=s.n(i),l=s("./node_modules/lodash/lodash.js"),d=s("./node_modules/react-redux/es/index.js"),p=s("./client/blocks/conversation-follow-button/button.jsx"),m=s("./client/state/reader/conversations/utils.js"),u=s("./client/state/reader/conversations/follow-status.js");function h(e,t){let s=t.siteId,o=t.postId;return Object(l.get)(e,["reader","conversations","items",Object(m.a)(s,o)])===u.a.following}function b(e,t){let s=t.siteId,o=t.postId;return Object(l.get)(e,["reader","conversations","items",Object(m.a)(s,o)],null)}var f=s("./packages/i18n-calypso/dist/esm/index.js"),j=s("./client/state/data-layer/wpcom-http/actions.js"),g=s("./client/state/data-layer/wpcom-http/utils.js"),_=s("./client/state/notices/actions.js"),y=s("./client/state/data-layer/handler-registry.js");function E(e){let t=e.payload,s=t.siteId,o=t.postId,n=e.meta.previousState;return[Object(_.b)(Object(f.translate)("Sorry, we had a problem following that conversation. Please try again.")),x({siteId:s,postId:o,followStatus:n})]}function k(e){let t=e.payload,s=t.siteId,o=t.postId,n=e.meta.previousState;return[Object(_.b)(Object(f.translate)("Sorry, we had a problem unfollowing that conversation. Please try again.")),x({siteId:s,postId:o,followStatus:n})]}function x(e){return{type:"READER_CONVERSATION_UPDATE_FOLLOW_STATUS",payload:{siteId:e.siteId,postId:e.postId,followStatus:e.followStatus}}}Object(y.b)("state/data-layer/wpcom/read/sites/posts/follow/index.js",{READER_CONVERSATION_FOLLOW:[Object(g.a)({fetch:e=>Object(j.a)({method:"POST",apiNamespace:"wpcom/v2",path:"/read/sites/".concat(e.payload.siteId,"/posts/").concat(e.payload.postId,"/follow"),body:{}},e),onSuccess:(e,t)=>{return t&&t.success?Object(_.f)(Object(f.translate)("The conversation has been successfully followed."),{duration:5e3}):E(e)},onError:E})]}),Object(y.b)("state/data-layer/wpcom/read/sites/posts/mute/index.js",{READER_CONVERSATION_MUTE:[Object(g.a)({fetch:function(e){return Object(j.a)({method:"POST",apiNamespace:"wpcom/v2",path:"/read/sites/".concat(e.payload.siteId,"/posts/").concat(e.payload.postId,"/mute"),body:{}},e)},onSuccess:function(e,t){return t&&t.success?Object(_.d)(Object(f.translate)("The conversation has been successfully unfollowed."),{duration:5e3}):k(e)},onError:k})]});var O=s("./client/reader/stats.js"),v=s("./client/state/analytics/actions.js");class C extends i.Component{constructor(){super(...arguments),n()(this,"handleFollowToggle",e=>{const t=this.props,s=t.siteId,o=t.postId,n=t.post,a=t.followSource,r=Object(l.assign)(Object(O.getTracksPropertiesForPost)(n),{follow_source:a});e?(this.props.recordTracksEvent("calypso_reader_conversations_post_followed",r),this.props.followConversation({siteId:s,postId:o})):(this.props.recordTracksEvent("calypso_reader_conversations_post_muted",r),this.props.muteConversation({siteId:s,postId:o})),this.props.onFollowToggle(e)})}render(){return c.a.createElement(p.a,{isFollowing:this.props.isFollowing,onFollowToggle:this.handleFollowToggle,className:this.props.className,tagName:this.props.tagName})}}n()(C,"propTypes",{siteId:r.a.number.isRequired,postId:r.a.number.isRequired,onFollowToggle:r.a.func,tagName:r.a.oneOfType([r.a.string,r.a.func]),post:r.a.object,followSource:r.a.string}),n()(C,"defaultProps",{onFollowToggle:l.noop});t.a=Object(d.b)((e,t)=>({isFollowing:h(e,{siteId:t.siteId,postId:t.postId})}),{followConversation:function(e){let t=e.siteId,s=e.postId;return(e,o)=>{e({type:"READER_CONVERSATION_FOLLOW",payload:{siteId:t,postId:s},meta:{previousState:b(o(),{siteId:t,postId:s})}})}},muteConversation:function(e){let t=e.siteId,s=e.postId;return(e,o)=>{e({type:"READER_CONVERSATION_MUTE",payload:{siteId:t,postId:s},meta:{previousState:b(o(),{siteId:t,postId:s})}})}},recordTracksEvent:v.i})(C)},"./client/blocks/conversations/list.jsx":function(e,t,s){"use strict";s.d(t,"a",function(){return C});var o=s("./node_modules/@babel/runtime/helpers/objectSpread.js"),n=s.n(o),a=s("./node_modules/@babel/runtime/helpers/slicedToArray.js"),r=s.n(a),i=s("./node_modules/@babel/runtime/helpers/defineProperty.js"),c=s.n(i),l=s("./node_modules/react/index.js"),d=s.n(l),p=s("./node_modules/prop-types/index.js"),m=s.n(p),u=s("./node_modules/react-redux/es/index.js"),h=s("./node_modules/lodash/lodash.js"),b=s("./client/state/selectors/get-active-reply-comment-id.js"),f=s("./client/blocks/comments/post-comment.jsx"),j=s("./client/state/comments/constants.js"),g=s("./client/state/comments/selectors.js"),_=s("./client/blocks/conversation-caterpillar/index.jsx"),y=s("./client/reader/stats.js"),E=s("./client/blocks/comments/form-root.jsx"),k=s("./client/state/comments/actions.js"),x=s("./client/state/comments/utils.js"),O=s("./client/state/current-user/selectors.js");const v=20;class C extends d.a.Component{constructor(){var e;super(...arguments),e=this,c()(this,"state",{activeEditCommentId:null}),c()(this,"onEditCommentClick",e=>this.setState({activeEditCommentId:e})),c()(this,"onEditCommentCancel",()=>this.setState({activeEditCommentId:null})),c()(this,"onUpdateCommentText",e=>this.setState({commentText:e})),c()(this,"onReplyClick",e=>{this.setActiveReplyComment(e),Object(y.recordAction)("comment_reply_click"),Object(y.recordGaEvent)("Clicked Reply to Comment"),Object(y.recordTrack)("calypso_reader_comment_reply_click",{blog_id:this.props.post.site_ID,comment_id:e})}),c()(this,"onReplyCancel",()=>{this.setState({commentText:null}),Object(y.recordAction)("comment_reply_cancel_click"),Object(y.recordGaEvent)("Clicked Cancel Reply to Comment"),Object(y.recordTrack)("calypso_reader_comment_reply_cancel_click",{blog_id:this.props.post.site_ID,comment_id:this.props.activeReplyCommentId}),this.resetActiveReplyComment()}),c()(this,"reqMoreComments",function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.props;const s=t.siteId,o=t.postId,n=t.enableCaterpillar;if(!t.shouldRequestComments||!t.commentsFetchingStatus)return;const a=t.commentsFetchingStatus,r=a.haveEarlierCommentsToFetch,i=a.haveLaterCommentsToFetch;if(n&&(r||i)){const e=r?"before":"after";t.requestPostComments({siteId:s,postId:o,direction:e})}}),c()(this,"getParentId",(e,t)=>Object(h.get)(e,[t,"data","parent","ID"])),c()(this,"commentHasParent",(e,t)=>!!this.getParentId(e,t)),c()(this,"commentIsLoaded",(e,t)=>!!Object(h.get)(e,t)),c()(this,"getInaccessibleParentsIds",(e,t)=>{if(0===Object(h.size)(t))return[];const s=Object(h.filter)(t,t=>this.commentHasParent(e,t)),o=Object(h.map)(s,t=>this.getParentId(e,t)),n=Object(h.partition)(o,t=>this.commentIsLoaded(e,t)),a=r()(n,2),i=a[0];return a[1].concat(this.getInaccessibleParentsIds(e,i))}),c()(this,"getCommentsToShow",()=>{const e=this.props,t=e.commentIds,s=e.expansions,o=e.commentsTree,a=e.sortedComments,r=Object(h.min)(t),i=(a||[]).filter(e=>e.ID>=r||e.isPlaceholder).map(e=>e.ID),c=Object(h.compact)(Object(h.map)(i,e=>this.getParentId(o,e))),l=Object(h.fill)(Array(i.length),j.c.excerpt),d=Object(h.fill)(Array(c.length),j.c.excerpt),p=Object(h.zipObject)(i.concat(c),l.concat(d));return n()({},p,s)}),c()(this,"setActiveReplyComment",e=>{const t=Object(h.get)(this.props,"post.site_ID"),s=Object(h.get)(this.props,"post.ID");t&&s&&this.props.setActiveReply({siteId:t,postId:s,commentId:e})}),c()(this,"resetActiveReplyComment",()=>{this.setActiveReplyComment(null)})}componentDidMount(){this.resetActiveReplyComment(),this.reqMoreComments()}componentWillReceiveProps(e){const t=e.hiddenComments,s=e.commentsTree,o=e.siteId,n=e.commentErrors;Object(h.size)(t)<v&&this.reqMoreComments(),this.getInaccessibleParentsIds(s,Object.keys(this.getCommentsToShow())).filter(e=>!n[Object(x.d)(o,e)]).forEach(t=>{e.requestComment({commentId:t,siteId:o})})}render(){const e=this.props,t=e.commentsTree,s=e.post,o=e.enableCaterpillar;if(!s)return null;const n=this.getCommentsToShow(),a=!this.props.commentsFetchingStatus.haveEarlierCommentsToFetch&&!this.props.commentsFetchingStatus.haveLaterCommentsToFetch?Object(h.filter)(t,e=>"comment"===Object(h.get)(e,"data.type")).length:s.discussion.comment_count,r=o&&Object(h.size)(n)<a;return d.a.createElement("div",{className:"conversations__comment-list"},d.a.createElement("ul",{className:"conversations__comment-list-ul"},r&&d.a.createElement(_.b,{blogId:s.site_ID,postId:s.ID,commentCount:a,commentsToShow:n}),Object(h.map)(t.children,e=>d.a.createElement(f.a,{showNestingReplyArrow:!0,hidePingbacksAndTrackbacks:!0,enableCaterpillar:o,post:s,commentsTree:t,key:e,commentId:e,maxDepth:2,commentsToShow:n,onReplyClick:this.onReplyClick,onReplyCancel:this.onReplyCancel,activeReplyCommentId:this.props.activeReplyCommentId,onEditCommentClick:this.onEditCommentClick,onEditCommentCancel:this.onEditCommentCancel,activeEditCommentId:this.state.activeEditCommentId,onUpdateCommentText:this.onUpdateCommentText,onCommentSubmit:this.resetActiveReplyComment,commentText:this.state.commentText,showReadMoreInActions:!0,displayType:j.c.excerpt})),d.a.createElement(E.a,{post:this.props.post,commentsTree:this.props.commentsTree,commentText:this.state.commentText,onUpdateCommentText:this.onUpdateCommentText,activeReplyCommentId:this.props.activeReplyCommentId})))}}c()(C,"propTypes",{post:m.a.object.isRequired,commentIds:m.a.array.isRequired,shouldRequestComments:m.a.bool,setActiveReply:m.a.func}),c()(C,"defaultProps",{enableCaterpillar:!0,shouldRequestComments:!0,setActiveReply:h.noop});const w=Object(u.b)((e,t)=>{const s=t.post,o=s.site_ID,n=s.ID,a=s.discussion,r=Object(O.g)(e);return{siteId:o,postId:n,sortedComments:Object(g.e)(e,o,n),commentsTree:Object(g.i)(e,o,n,"all",r),commentsFetchingStatus:Object(g.a)(e,o,n,a.comment_count)||{},expansions:Object(g.f)(e,o,n),hiddenComments:Object(g.g)(e,o,n),activeReplyCommentId:Object(b.a)({state:e,siteId:o,postId:n}),commentErrors:Object(g.c)(e)}},{requestPostComments:k.m,requestComment:k.i,setActiveReply:k.n})(C);t.b=w},"./client/blocks/daily-post-button/helper.js":function(e,t,s){"use strict";s.d(t,"b",function(){return a}),s.d(t,"a",function(){return r});var o=s("./client/config/index.js");const n={dp_prompt:"prompt",dp_photo_challenge:"photo",dp_discover:"discover"};function a(e){return e.site_ID===Object(o.a)("daily_post_blog_id")&&!!n[e.type]}function r(e){return n[e.type]}},"./client/blocks/daily-post-button/index.jsx":function(e,t,s){"use strict";var o=s("./node_modules/@babel/runtime/helpers/defineProperty.js"),n=s.n(o),a=s("./node_modules/react/index.js"),r=s.n(a),i=s("./node_modules/classnames/index.js"),c=s.n(i),l=s("./node_modules/page/page.js"),d=s.n(l),p=s("./node_modules/prop-types/index.js"),m=s.n(p),u=s("./node_modules/qs/lib/index.js"),h=s("./node_modules/lodash/lodash.js"),b=s("./client/components/gridicon/index.jsx"),f=s("./node_modules/react-redux/es/index.js"),j=s("./packages/i18n-calypso/dist/esm/index.js"),g=s("./client/sections-helper.js"),_=s("./client/components/sites-popover/index.jsx"),y=s("./client/components/button/index.jsx"),E=s("./client/state/reader/posts/actions.js"),k=s("./client/reader/stats.js"),x=s("./client/blocks/daily-post-button/helper.js"),O=s("./client/state/selectors/get-primary-site-id.js"),v=s("./client/state/sites/selectors.js"),C=s("./client/state/current-user/selectors.js");s("./client/blocks/daily-post-button/style.scss");function w(){Object(g.c)("post-editor")}class I extends r.a.Component{constructor(){super(),n()(this,"openEditorWithSite",e=>{const t=function(e){return{title:{prompt:Object(j.translate)("Daily Prompt: "),photo:Object(j.translate)("Photo Challenge: "),discover:Object(j.translate)("Discover Challenge: ")}[Object(x.a)(e)]+e.title,url:e.URL}}(this.props.post);return Object(k.recordAction)("daily_post_challenge"),Object(k.recordGaEvent)("Clicked on Daily Post challenge"),Object(k.recordTrackForPost)("calypso_reader_daily_post_challenge_site_picked",this.props.post),this.props.markPostSeen(this.props.post,this.props.site),d()("/post/".concat(e,"?").concat(Object(u.stringify)(t))),!0}),n()(this,"toggle",e=>{if(e.preventDefault(),!this.state.showingMenu&&(Object(k.recordAction)("open_daily_post_challenge"),Object(k.recordGaEvent)("Opened Daily Post Challenge"),Object(k.recordTrackForPost)("calypso_reader_daily_post_challenge_opened",this.props.post),this.props.onlyOneSite))return this.openEditorWithSite(this.props.primarySiteSlug);this.deferMenuChange(!this.state.showingMenu)}),n()(this,"closeMenu",()=>{this._isMounted&&this.deferMenuChange(!1)}),n()(this,"renderSitesPopover",()=>r.a.createElement(_.a,{key:"menu",header:r.a.createElement("div",null," ",Object(j.translate)("Post on")," "),context:this.dailyPostButtonRef.current,visible:this.state.showingMenu,groups:!0,onSiteSelect:this.openEditorWithSite,onClose:this.closeMenu,position:"top",className:"is-reader"})),this.state={showingMenu:!1},this._closeTimerId=null,this._isMounted=!1,this.dailyPostButtonRef=r.a.createRef()}componentDidMount(){this._isMounted=!0}componentWillUnmount(){this._isMounted=!1,this._closeTimerId&&(clearTimeout(this._closeTimerId),this._closeDefer=null)}deferMenuChange(e){this._closeTimerId&&clearTimeout(this._closeTimerId),this._closeTimerId=Object(h.defer)(()=>{this._closeTimerId=null,this.setState({showingMenu:e})})}render(){const e=Object(h.get)(this.props,"post.title"),t=c()({"daily-post-button__button":!0,"ignore-click":!0,"is-active":this.state.showingMenu});return this.props.canParticipate?r.a.createElement(this.props.tagName,{className:"daily-post-button",onClick:this.toggle,onTouchStart:w,onMouseEnter:w},[r.a.createElement(y.a,{ref:this.dailyPostButtonRef,key:"button",compact:!0,primary:!0,className:t},r.a.createElement(b.a,{icon:"create"}),r.a.createElement("span",null,Object(j.translate)("Post about %(title)s",{args:{title:e}})," ")),this.state.showingMenu?this.renderSitesPopover():null]):null}}n()(I,"propTypes",{post:m.a.object.isRequired,site:m.a.object.isRequired,position:m.a.string,tagName:m.a.string,canParticipate:m.a.bool.isRequired,primarySiteSlug:m.a.string,onlyOneSite:m.a.bool.isRequired}),n()(I,"defaultProps",{position:"top",tagName:"span"}),t.a=Object(f.b)(e=>{const t=Object(O.a)(e),s=Object(C.b)(e),o=Object(h.get)(s,"visible_site_count",0);return{canParticipate:!!t,primarySiteSlug:Object(v.v)(e,t),onlyOneSite:1===o}},{markPostSeen:E.b})(I)},"./client/blocks/daily-post-button/style.scss":function(e,t,s){},"./client/blocks/follow-button/button.jsx":function(e,t,s){"use strict";var o=s("./node_modules/@babel/runtime/helpers/defineProperty.js"),n=s.n(o),a=s("./node_modules/prop-types/index.js"),r=s.n(a),i=s("./node_modules/react/index.js"),c=s.n(i),l=s("./node_modules/lodash/lodash.js"),d=s("./packages/i18n-calypso/dist/esm/index.js"),p=s("./client/components/gridicon/index.jsx");class m extends c.a.Component{constructor(){super(...arguments),n()(this,"toggleFollow",e=>{e&&e.preventDefault(),this.props.disabled||this.props.onFollowToggle&&this.props.onFollowToggle(!this.props.following)})}componentWillMount(){this.strings={FOLLOW:this.props.translate("Follow"),FOLLOWING:this.props.translate("Following")}}render(){let e=this.props.followLabel?this.props.followLabel:this.strings.FOLLOW;const t=["button","follow-button","has-icon",this.props.className],s=this.props.iconSize;this.props.following&&(t.push("is-following"),e=this.props.followingLabel?this.props.followingLabel:this.strings.FOLLOWING),this.props.disabled&&t.push("is-disabled");const o=c.a.createElement(p.a,{key:"following",icon:"reader-following",size:s}),n=c.a.createElement(p.a,{key:"follow",icon:"reader-follow",size:s}),a=c.a.createElement("span",{key:"label",className:"follow-button__label"},e);return c.a.createElement(this.props.tagName,{onClick:this.toggleFollow,className:t.join(" "),title:e},[o,n,a])}}n()(m,"propTypes",{following:r.a.bool.isRequired,onFollowToggle:r.a.func,iconSize:r.a.number,tagName:r.a.oneOfType([r.a.string,r.a.func]),disabled:r.a.bool,followLabel:r.a.string,followingLabel:r.a.string}),n()(m,"defaultProps",{following:!1,onFollowToggle:l.noop,iconSize:20,tagName:"button",disabled:!1}),t.a=Object(d.localize)(m)},"./client/blocks/like-button/button.jsx":function(e,t,s){"use strict";var o=s("./node_modules/@babel/runtime/helpers/defineProperty.js"),n=s.n(o),a=s("./node_modules/prop-types/index.js"),r=s.n(a),i=s("./node_modules/react/index.js"),c=s.n(i),l=s("./node_modules/classnames/index.js"),d=s.n(l),p=s("./node_modules/lodash/lodash.js"),m=s("./packages/i18n-calypso/dist/esm/index.js"),u=s("./client/components/gridicon/index.jsx");const h=e=>{let t=e.size;return c.a.createElement("span",{className:"like-button__like-icons"},c.a.createElement(u.a,{icon:"star",size:t}),c.a.createElement(u.a,{icon:"star-outline",size:t}))};h.propTypes={size:r.a.number},h.defaultProps={size:24};var b=h;class f extends i.PureComponent{constructor(e){super(e),this.toggleLiked=this.toggleLiked.bind(this)}toggleLiked(e){e&&e.preventDefault(),this.props.onLikeToggle&&this.props.onLikeToggle(!this.props.liked)}render(){const e=this.props,t=e.likeCount,s=e.tagName,o=void 0===s?"li":s,n=e.showZeroCount,a=e.postId,r=e.slug,i=e.translate,l=e.onMouseEnter,m=e.onMouseLeave,u=t>0||n,h="a"===o,f={"like-button":!0,"ignore-click":!0,"is-mini":this.props.isMini,"is-animated":this.props.animateLike,"has-count":u,"has-label":this.props.showLabel};let j=i("Like",{context:"verb: imperative",comment:'Label for a button to "like" a post.'});this.props.liked&&(f["is-liked"]=!0,j=this.props.likedLabel?this.props.likedLabel:i("Liked",{comment:'Displayed when a person "likes" a post.'})),u&&(j=i("Like","Likes",{count:t,context:"noun",comment:"Number of likes."}));const g=c.a.createElement("span",{className:"like-button__label"},c.a.createElement("span",{className:"like-button__label-count"},u?t:""),this.props.showLabel&&c.a.createElement("span",{className:"like-button__label-status"},j)),_=h?"/stats/post/".concat(a,"/").concat(r):null;return c.a.createElement(o,Object(p.omitBy)({href:_,className:d()(f),onClick:h?null:this.toggleLiked,onMouseEnter:l,onMouseLeave:m},p.isNull),c.a.createElement(b,{size:this.props.iconSize}),g)}}n()(f,"propTypes",{liked:r.a.bool,showZeroCount:r.a.bool,likeCount:r.a.number,showLabel:r.a.bool,tagName:r.a.string,onLikeToggle:r.a.func,likedLabel:r.a.string,iconSize:r.a.number,animateLike:r.a.bool,postId:r.a.number,slug:r.a.string}),n()(f,"defaultProps",{liked:!1,showZeroCount:!1,likeCount:0,showLabel:!0,iconSize:24,animateLike:!0,postId:null,slug:null});t.a=Object(m.localize)(f)},"./client/blocks/post-edit-button/index.jsx":function(e,t,s){"use strict";var o=s("./node_modules/prop-types/index.js"),n=s.n(o),a=s("./node_modules/react/index.js"),r=s.n(a),i=s("./client/components/gridicon/index.jsx"),c=s("./packages/i18n-calypso/dist/esm/index.js"),l=s("./client/state/posts/utils.js");const d=e=>{let t=e.post,s=e.site,o=e.iconSize,n=e.onClick,a=e.translate;const c=Object(l.e)(t,s);return r.a.createElement("a",{className:"post-edit-button",href:c,onClick:n},r.a.createElement(i.a,{icon:"pencil",size:o,className:"post-edit-button__icon"}),r.a.createElement("span",{className:"post-edit-button__label"},a("Edit")))};d.propTypes={post:n.a.object.isRequired,site:n.a.object.isRequired,iconSize:n.a.number,onClick:n.a.func},d.defaultProps={iconSize:24},t.a=Object(c.localize)(d)},"./client/blocks/reader-author-link/index.jsx":function(e,t,s){"use strict";var o=s("./node_modules/@babel/runtime/helpers/objectDestructuringEmpty.js"),n=s.n(o),a=s("./node_modules/prop-types/index.js"),r=s.n(a),i=s("./node_modules/react/index.js"),c=s.n(i),l=s("./node_modules/lodash/lodash.js"),d=s("./node_modules/classnames/index.js"),p=s.n(d),m=s("./client/reader/lib/author-name-blacklist/index.js"),u=s("./client/reader/stats.js"),h=s("./client/components/emojify/index.jsx");s("./client/blocks/reader-author-link/style.scss");const b=e=>{let t=e.author,s=e.post,o=e.siteUrl,a=e.children,r=e.className,i=e.onClick;o||(o=t.URL);const d=Object(l.get)(t,"name",null);if(!d||Object(m.a)(d))return null;const b=p()("reader-author-link",r);return o?c.a.createElement("a",{className:b,href:o,onClick:e=>{n()(e),u.recordAction("click_author"),u.recordGaEvent("Clicked Author Link"),s&&u.recordTrackForPost("calypso_reader_author_link_clicked",s),i()}},c.a.createElement(h.a,null,a)):c.a.createElement("span",{className:b},c.a.createElement(h.a,null,a))};b.propTypes={author:r.a.object.isRequired,post:r.a.object,siteUrl:r.a.string},b.defaultProps={onClick:l.noop},t.a=b},"./client/blocks/reader-author-link/style.scss":function(e,t,s){},"./client/blocks/reader-avatar/index.jsx":function(e,t,s){"use strict";var o=s("./node_modules/@babel/runtime/helpers/slicedToArray.js"),n=s.n(o),a=s("./node_modules/prop-types/index.js"),r=s.n(a),i=s("./node_modules/react/index.js"),c=s.n(i),l=s("./node_modules/lodash/lodash.js"),d=s("./client/components/gravatar/index.jsx"),p=s("./client/blocks/site-icon/index.jsx"),m=s("./packages/i18n-calypso/dist/esm/index.js"),u=s("./node_modules/classnames/index.js"),h=s.n(u),b=s("./client/lib/safe-image-url/index.js");s("./client/blocks/reader-avatar/style.scss");const f=e=>{let t,s=e.author,o=e.siteIcon,a=e.feedIcon,r=e.siteUrl,i=e.isCompact,m=void 0!==i&&i,u=e.preferGravatar,f=void 0!==u&&u,j=e.preferBlavatar,g=void 0!==j&&j,_=e.showPlaceholder,y=void 0!==_&&_,E=e.onClick;Object(l.endsWith)(a,"wp.com/i/buttonw-com.png")&&(a=null);const k=Object(b.a)(o),x=Object(b.a)(a);k?t={icon:{img:k}}:x&&(t={icon:{img:x}});let O=!!Object(l.get)(t,"icon.img"),v=!(!s||!s.has_avatar);if(O&&v){const e=t.icon.img.split("?"),o=n()(e,1)[0];Object(l.startsWith)(s.avatar_URL,o)&&(v=!1)}v&&f?O=!1:g&&(v=!1,y=!1);const C=O&&v;let w,I;m?(w=32,I=C?24:32):(w=96,I=C?32:96);const S=h()("reader-avatar",{"is-compact":m,"has-site-and-author-icon":C,"has-site-icon":O,"has-gravatar":v||y}),R=[O&&c.a.createElement(p.a,{key:"site-icon",size:w,site:t}),(v||y)&&c.a.createElement(d.a,{key:"author-avatar",user:s,size:I})];return c.a.createElement("div",{className:S,onClick:E,"aria-hidden":"true"},r?c.a.createElement("a",{href:r},R):R)};f.propTypes={author:r.a.object,siteIcon:r.a.string,feedIcon:r.a.string,siteUrl:r.a.string,preferGravatar:r.a.bool,showPlaceholder:r.a.bool,isCompact:r.a.bool,onClick:r.a.func},f.defaultProps={onClick:l.noop},t.a=Object(m.localize)(f)},"./client/blocks/reader-avatar/style.scss":function(e,t,s){},"./client/blocks/reader-excerpt/index.jsx":function(e,t,s){"use strict";var o=s("./node_modules/prop-types/index.js"),n=s.n(o),a=s("./node_modules/react/index.js"),r=s.n(a),i=s("./client/components/auto-direction/index.jsx"),c=s("./client/components/emojify/index.jsx");s("./client/blocks/reader-excerpt/style.scss");const l=e=>{let t=e.post,s=e.isDiscover,o=t.better_excerpt||t.excerpt;return s&&(o=t.excerpt),r.a.createElement(i.a,null,r.a.createElement(c.a,null,r.a.createElement("div",{className:"reader-excerpt__content reader-excerpt",dangerouslySetInnerHTML:{__html:o}})))};l.propTypes={post:n.a.object.isRequired,isDiscover:n.a.bool},t.a=l},"./client/blocks/reader-excerpt/style.scss":function(e,t,s){},"./client/blocks/reader-featured-image/index.jsx":function(e,t,s){"use strict";var o=s("./node_modules/prop-types/index.js"),n=s.n(o),a=s("./node_modules/react/index.js"),r=s.n(a),i=s("./node_modules/lodash/lodash.js"),c=s("./node_modules/classnames/index.js"),l=s.n(c),d=s("./client/lib/css-safe-url/index.js"),p=s("./client/lib/resize-image-url/index.js");s("./client/blocks/reader-featured-image/style.scss");const m=e=>{let t=e.imageUrl,s=e.imageWidth,o=e.href,n=e.children,a=e.onClick,i=e.className,c=e.fetched;if(void 0===t)return null;const m=c?t:Object(p.a)(t,{w:s}),u={backgroundImage:"url("+Object(d.a)(m)+")",backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center center"},h=l()(i,"reader-featured-image");return r.a.createElement("a",{className:h,href:o,style:u,onClick:a},n)};m.propTypes={imageUrl:n.a.string,href:n.a.string,onClick:n.a.func},m.defaultProps={onClick:i.noop,imageWidth:250},t.a=m},"./client/blocks/reader-featured-image/style.scss":function(e,t,s){},"./client/blocks/reader-featured-video/index.jsx":function(e,t,s){"use strict";var o=s("./node_modules/@babel/runtime/helpers/defineProperty.js"),n=s.n(o),a=s("./node_modules/prop-types/index.js"),r=s.n(a),i=s("./node_modules/react/index.js"),c=s.n(i),l=s("./node_modules/react-redux/es/index.js"),d=s("./node_modules/lodash/lodash.js"),p=s("./node_modules/react-dom/index.js"),m=s.n(p),u=s("./packages/i18n-calypso/dist/esm/index.js"),h=s("./node_modules/classnames/index.js"),b=s.n(h),f=s("./node_modules/percentage-regex/index.js");const j=s.n(f)()({exact:!0}),g=e=>j.test(e),_={default:{sizingFunction:function(e,t){const s=e.aspectRatio;let o=e.width,n=e.height;return isNaN(s)||(o=t,n=t/s),g(o)&&(o=t*(parseInt(o,10)/100)),g(n)&&(n=o*(parseInt(n,10)/100)),{width:"".concat(0|o,"px"),height:"".concat(0|n,"px"),paddingRight:"1px"}}},spotify:{sizingFunction:function(e,t){let s;return{width:t+"px",height:(s=e.aspectRatio?Math.min(t/e.aspectRatio,t+80):t+80)+"px"}},urlRegex:/\/\/embed.spotify.com/},soundcloud:{sizingFunction:function(e,t){const s=e.aspectRatio||1;let o="100%";return e.iframe.indexOf("visual=true")>-1&&(o=Math.floor(t/s)+"px"),{width:t+"px",height:o}},urlRegex:/\/\/w\.soundcloud\.com\/player/}};function y(e){let t;if(_.hasOwnProperty(e.type))return _[e.type];const s=function(e){const t=new RegExp('src="([^"]+)"').exec(e);return t.length>1?t[1]:null}(e.iframe);if(s)for(t in _)if(_.hasOwnProperty(t)&&_[t].urlRegex&&s.match(_[t].urlRegex))return _[t];return _.default}const E={getEmbedSizingFunction:function(e){const t=y(e);return t.sizingFunction.bind(t,e)}};var k=E;var x=s("./client/blocks/reader-featured-image/index.jsx");function O(e,t){return e.reader.thumbnails.items[t]}var v=s("./node_modules/redux/es/redux.js"),C=s("./node_modules/debug/src/browser.js"),w=s.n(C),I=s("./node_modules/get-video-id/index.js"),S=s.n(I),R=s("./node_modules/superagent/lib/client.js"),T=s.n(R);const N=w()("calypso:redux:reader-service-thumbnails");function P(e,t){return{type:"READER_THUMBNAIL_RECEIVE",embedUrl:e,thumbnailUrl:t}}function D(e,t){return{type:"READER_THUMBNAIL_REQUEST_FAILURE",embedUrl:e,error:t}}const L=e=>t=>{const s=S()(e)||{},o=s.id;switch(s.service){case"youtube":{const s="https://img.youtube.com/vi/".concat(o,"/mqdefault.jpg");return t(P(e,s)),Promise.resolve()}case"videopress":{const s="https://thumbs.videopress.com/".concat(o,"?c=1");return t(P(e,s)),Promise.resolve()}case"vimeo":{N("Requesting thumbnail for embed ".concat(e)),t({type:"READER_THUMBNAIL_REQUEST",embedUrl:e});const s="https://vimeo.com/api/v2/video/".concat(o,".json");return T.a.get(s).then(s=>{const o=Object(d.get)(s,["body",0,"thumbnail_large"]);o?(t(function(e){return{type:"READER_THUMBNAIL_REQUEST_SUCCESS",embedUrl:e}}(e)),t(P(e,o))):t(D(e,{type:"BAD_API_RESPONSE",response:s}))},s=>{t(D(e,s))})}default:return t(D(e,{type:"UNSUPPORTED_EMBED"})),Promise.resolve()}};class U extends i.Component{componentWillMount(){this.request(this.props)}componentWillReceiveProps(e){e.embedUrl!==this.props.embedUrl&&this.request(e)}request(e){e.shouldRequestThumbnail&&e.embedUrl&&e.requestThumbnail(e.embedUrl)}render(){return null}}U.propTypes={shouldRequestThumbnail:r.a.bool,requestThumbnail:r.a.func};var A=Object(l.b)((e,t)=>({shouldRequestThumbnail:!O(e,t.embedUrl)}),e=>Object(v.b)({requestThumbnail:L},e))(U);s("./client/blocks/reader-featured-video/style.scss");class F extends c.a.Component{constructor(){super(...arguments),n()(this,"setVideoSizingStrategy",e=>{let t=Object(d.constant)({});if(e){const s=m.a.findDOMNode(this).parentNode.offsetWidth,o=k.getEmbedSizingFunction(e);t=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s;return o(e)}}this.getEmbedSize=t}),n()(this,"updateVideoSize",()=>{if(this.videoEmbedRef){const e=m.a.findDOMNode(this.videoEmbedRef).querySelector("iframe"),t=m.a.findDOMNode(this).parentNode.offsetWidth;Object.assign(e.style,this.getEmbedSize(t))}}),n()(this,"throttledUpdateVideoSize",Object(d.throttle)(this.updateVideoSize,100)),n()(this,"handleThumbnailClick",e=>{this.props.allowPlaying&&(e.preventDefault(),this.props.onThumbnailClick())}),n()(this,"setVideoEmbedRef",e=>{this.videoEmbedRef=e,this.setVideoSizingStrategy(this.props.videoEmbed)})}componentDidMount(){this.props.allowPlaying&&"undefined"!=typeof window&&window.addEventListener("resize",this.throttledUpdateVideoSize)}componentWillUnmount(){this.props.allowPlaying&&"undefined"!=typeof window&&window.removeEventListener("resize",this.throttledUpdateVideoSize)}componentWillReceiveProps(){this.throttledUpdateVideoSize()}render(){const e=this.props,t=e.thumbnailUrl,s=e.autoplayIframe,o=e.iframe,n=e.translate,a=e.allowPlaying,r=e.className,i=e.href;if(!e.isExpanded&&t)return c.a.createElement(x.a,{imageUrl:t,onClick:this.handleThumbnailClick,className:r,href:i},a&&c.a.createElement("img",{className:"reader-featured-video__play-icon",src:"/calypso/images/reader/play-icon.png",title:n("Play Video"),alt:n("Play button")}));const l=!!t,d=b()(r,"reader-featured-video");return c.a.createElement("div",{className:d},c.a.createElement(A,{embedUrl:this.props.videoEmbed.src}),l&&c.a.createElement("div",{ref:this.setVideoEmbedRef,className:"reader-featured-video__video",dangerouslySetInnerHTML:{__html:t?s:o}}))}}n()(F,"propTypes",{thumbnailUrl:r.a.string,autoplayIframe:r.a.string,iframe:r.a.string,videoEmbed:r.a.object,allowPlaying:r.a.bool,onThumbnailClick:r.a.func,className:r.a.string,href:r.a.string,isExpanded:r.a.bool,expandCard:r.a.func}),n()(F,"defaultProps",{allowPlaying:!0,onThumbnailClick:d.noop,className:""});t.a=Object(l.b)((e,t)=>({thumbnailUrl:O(e,t.videoEmbed.src)}))(Object(u.localize)(F))},"./client/blocks/reader-featured-video/style.scss":function(e,t,s){},"./client/blocks/reader-post-actions/index.jsx":function(e,t,s){"use strict";var o=s("./node_modules/prop-types/index.js"),n=s.n(o),a=s("./node_modules/react/index.js"),r=s.n(a),i=s("./node_modules/classnames/index.js"),c=s.n(i),l=s("./client/blocks/comment-button/index.jsx"),d=s("./client/reader/like-button/index.jsx"),p=s("./client/blocks/reader-share/index.jsx"),m=s("./client/blocks/post-edit-button/index.jsx"),u=s("./client/blocks/reader-post-options-menu/index.jsx"),h=s("./client/blocks/comments/helper.jsx"),b=s("./client/reader/like-helper.jsx");var f=s("./client/state/posts/utils.js"),j=s("./client/reader/stats.js"),g=s("./packages/i18n-calypso/dist/esm/index.js"),_=s("./client/blocks/reader-visit-link/index.jsx");s("./client/blocks/reader-post-actions/style.scss");const y=e=>{const t=e.post,s=e.site,o=e.onCommentClick,n=e.showEdit,a=e.showVisit,i=e.showMenu,g=e.showMenuFollow,y=e.iconSize,E=e.className,k=e.visitUrl,x=e.fullPost,O=e.translate;const v=c()("reader-post-actions",E);return r.a.createElement("ul",{className:v},a&&r.a.createElement("li",{className:"reader-post-actions__item reader-post-actions__visit"},r.a.createElement(_.a,{href:k||t.URL,iconSize:y,onClick:function(){j.recordPermalinkClick("card",t)}},O("Visit"))),n&&s&&Object(f.I)("edit_post",t)&&r.a.createElement("li",{className:"reader-post-actions__item"},r.a.createElement(m.a,{post:t,site:s,onClick:()=>{j.recordAction("edit_post"),j.recordGaEvent("Clicked Edit Post","full_post"),j.recordTrackForPost("calypso_reader_edit_post_clicked",t)},iconSize:y})),function(e){return!e.site_is_private}(t)&&r.a.createElement("li",{className:"reader-post-actions__item"},r.a.createElement(p.a,{post:t,position:"bottom",tagName:"div",iconSize:y})),Object(h.b)(t)&&r.a.createElement("li",{className:"reader-post-actions__item"},r.a.createElement(l.a,{key:"comment-button",commentCount:t.discussion.comment_count,onClick:o,tagName:"div",size:y})),Object(b.a)(t)&&r.a.createElement("li",{className:"reader-post-actions__item"},r.a.createElement(d.a,{key:"like-button",siteId:+t.site_ID,postId:+t.ID,post:t,site:s,fullPost:x,tagName:"div",forceCounter:!0,iconSize:y,showZeroCount:!1,likeSource:"reader"})),i&&r.a.createElement("li",{className:"reader-post-actions__item"},r.a.createElement(u.a,{className:"ignore-click",showFollow:g,post:t})))};y.propTypes={post:n.a.object.isRequired,site:n.a.object,onCommentClick:n.a.func,showEdit:n.a.bool,iconSize:n.a.number,showMenu:n.a.bool,showMenuFollow:n.a.bool,visitUrl:n.a.string,fullPost:n.a.bool},y.defaultProps={showEdit:!0,showVisit:!1,showMenu:!1,iconSize:24,showMenuFollow:!0};t.a=Object(g.localize)(y)},"./client/blocks/reader-post-actions/style.scss":function(e,t,s){},"./client/blocks/reader-post-card/index.jsx":function(e,t,s){"use strict";var o=s("./node_modules/@babel/runtime/helpers/defineProperty.js"),n=s.n(o),a=s("./node_modules/prop-types/index.js"),r=s.n(a),i=s("./node_modules/react/index.js"),c=s.n(i),l=s("./node_modules/react-redux/es/index.js"),d=s("./node_modules/lodash/lodash.js"),p=s("./node_modules/classnames/index.js"),m=s.n(p),u=s("./node_modules/react-dom/index.js"),h=s.n(u),b=s("./node_modules/component-closest/index.js"),f=s.n(b),j=s("./client/components/card/index.jsx"),g=s("./client/state/reader/posts/display-types.js"),_=s("./client/reader/stats.js"),y=s("./client/blocks/reader-post-actions/index.jsx"),E=s("./client/components/gridicon/index.jsx"),k=s("./client/blocks/reader-avatar/index.jsx"),x=s("./client/components/time-since/index.jsx"),O=s("./client/reader/get-helpers.js"),v=s("./client/blocks/reader-site-stream-link/index.jsx"),C=s("./client/reader/route/index.js"),w=s("./client/reader/lib/author-name-blacklist/index.js"),I=s("./client/blocks/reader-author-link/index.jsx"),S=s("./client/lib/string/index.js");const R=3;class T extends c.a.Component{constructor(){super(...arguments),n()(this,"recordSingleTagClick",()=>{const e=this.props.tag;Object(_.recordAction)("click_tag"),Object(_.recordGaEvent)("Clicked Tag Link"),Object(_.recordTrackForPost)("calypso_reader_tag_clicked",this.props.post,{tag:e.slug})})}render(){const e=this.props.tag;return c.a.createElement("span",{className:"reader-post-card__tag"},c.a.createElement("a",{href:"/tag/"+e.slug,className:"reader-post-card__tag-link ignore-click",onClick:this.recordSingleTagClick},e.name))}}class N extends c.a.Component{constructor(){super(...arguments),n()(this,"recordDateClick",()=>{Object(_.recordPermalinkClick)("timestamp_card",this.props.post)})}render(){const e=this.props,t=e.post,s=e.site,o=e.feed,n=e.isDiscoverPost,a=e.showSiteName,r=e.showAvatar,i=Object(d.get)(t,"feed_ID"),l=Object(d.get)(s,"ID"),p=Object(O.d)({site:s,feed:o,post:t}),m=!!Object(d.get)(t,"author.name",null),u=m&&Object(S.a)(p,t.author.name),h=!n&&m&&!Object(w.a)(t.author.name)&&(!u||!a),b=Object(C.f)(i,l),f=Object(d.get)(s,"icon.img"),j=Object(d.get)(o,"image");let g=Object(d.values)(t.tags);g.sort((e,t)=>t.post_count-e.post_count),g=Object(d.take)(g,R);const _=Object(d.map)(g,e=>c.a.createElement(T,{tag:e,key:e.slug}));return c.a.createElement("div",{className:"reader-post-card__byline ignore-click"},r&&c.a.createElement(k.a,{siteIcon:f,feedIcon:j,author:t.author,preferGravatar:!0,siteUrl:b,isCompact:!0}),c.a.createElement("div",{className:"reader-post-card__byline-details"},(h||a)&&c.a.createElement("div",{className:"reader-post-card__byline-author-site"},h&&c.a.createElement(I.a,{className:"reader-post-card__link",author:t.author,siteUrl:b,post:t},t.author.name),h&&a?", ":"",a&&c.a.createElement(v.a,{className:"reader-post-card__site reader-post-card__link",feedId:i,siteId:l,post:t},p)),c.a.createElement("div",{className:"reader-post-card__timestamp-and-tag"},t.date&&t.URL&&c.a.createElement("span",{className:"reader-post-card__timestamp"},c.a.createElement("a",{className:"reader-post-card__timestamp-link",onClick:this.recordDateClick,href:t.URL,target:"_blank",rel:"noopener noreferrer"},c.a.createElement(x.a,{date:t.date}))),_.length>0&&c.a.createElement("span",{className:"reader-post-card__tags"},c.a.createElement(E.a,{icon:"tag"}),_))))}}n()(N,"propTypes",{post:r.a.object.isRequired,site:r.a.object,feed:r.a.object,isDiscoverPost:r.a.bool,showSiteName:r.a.bool,showAvatar:r.a.bool}),n()(N,"defaultProps",{isDiscoverPost:!1,showAvatar:!0});var P=N,D=s("./client/components/auto-direction/index.jsx"),L=s("./client/components/emojify/index.jsx"),U=s("./client/lib/resize-image-url/index.js"),A=s("./client/lib/css-safe-url/index.js"),F=s("./client/lib/post-normalizer/utils.js"),q=s("./client/blocks/reader-excerpt/index.jsx"),M=s("./client/state/reader/posts/normalization-rules.js"),z=s("./client/state/reader/posts/sizes.js");const B=e=>{let t=e.post,s=e.children,o=e.isDiscover;const n=function(e){const t=e.images&&[...e.images]||[],s=Object(F.e)(e);s&&t.splice(s,1);const o=Object(d.filter)(t,M.a);return Object(d.take)(o,4)}(t),a=Object(d.map)(n,(e,s)=>{const o=Object(U.a)(e.src,{w:z.g/n.length}),a={backgroundImage:"url("+Object(A.a)(o)+")",backgroundSize:"cover",backgroundPosition:"50% 50%",backgroundRepeat:"no-repeat"};return c.a.createElement("li",{key:"post-".concat(t.ID,"-image-").concat(s),className:"reader-post-card__gallery-item"},c.a.createElement("div",{className:"reader-post-card__gallery-image",style:a}))});return c.a.createElement("div",{className:"reader-post-card__post"},c.a.createElement("ul",{className:"reader-post-card__gallery"},a),c.a.createElement("div",{className:"reader-post-card__post-details"},c.a.createElement(D.a,null,c.a.createElement("h1",{className:"reader-post-card__title"},c.a.createElement("a",{className:"reader-post-card__title-link",href:t.URL},c.a.createElement(L.a,null,t.title)))),c.a.createElement(q.a,{post:t,isDiscover:o}),s))};B.propTypes={post:r.a.object.isRequired,isDiscover:r.a.bool};var W=B;class V extends c.a.Component{constructor(){super(...arguments),n()(this,"state",{cardWidth:800}),n()(this,"handleClick",e=>{if(this.props.isExpanded)return void this.props.onClick(e);e.preventDefault();const t=this.props,s=t.post,o=t.site,n=t.postKey;this.props.expandCard({post:s,site:o,postKey:n})}),n()(this,"getViewportHeight",()=>Math.max(document.documentElement.clientHeight,window.innerHeight||0)),n()(this,"getMaxPhotoHeight",()=>this.getViewportHeight()-176),n()(this,"setCardWidth",()=>{if(this.widthDivRef){const e=this.widthDivRef.getClientRects()[0].width;e>0&&this.setState({cardWidth:e})}}),n()(this,"handleWidthDivLoaded",e=>{this.widthDivRef=e})}componentDidMount(){this.resizeListener=window.addEventListener("resize",Object(d.debounce)(this.setCardWidth,50)),this.setCardWidth()}componentWillUnmount(){window.removeEventListener("resize",this.resizeListener)}renderFeaturedImage(){const e=this.props,t=e.post,s=e.title,o=t.canonical_media.src,n={height:t.canonical_media.height,width:t.canonical_media.width},a={backgroundImage:"url("+Object(A.a)(o)+")",backgroundSize:this.state.isExpanded?"contain":"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center"};let r,i;if(this.props.isExpanded){const e=this.state.cardWidth,t=n.width,s=n.height;r=t/s*(i=Math.min(s/t*e,this.getMaxPhotoHeight())),a.height=i,a.width=r}const l=m()({"reader-post-card__photo":!0,"is-expanded":this.props.isExpanded}),d=s||"Â ",p=this.props.isExpanded?{height:i,width:r,margin:"0 auto"}:{};return c.a.createElement("div",{style:p},c.a.createElement("a",{className:l,href:t.URL,style:a,onClick:this.handleClick},c.a.createElement("div",{ref:this.handleWidthDivLoaded,style:{width:"100%"}})),c.a.createElement(D.a,null,c.a.createElement("h1",{className:"reader-post-card__title"},c.a.createElement("a",{className:"reader-post-card__title-link",href:t.URL,onClick:this.props.onClick},c.a.createElement(L.a,null,d)))))}render(){const e=this.props,t=e.post,s=e.children,o=t.canonical_media.src?this.renderFeaturedImage():null;return c.a.createElement("div",{className:"reader-post-card__post"},o,c.a.createElement("div",{className:"reader-post-card__post-details"},s))}}V.propTypes={post:r.a.object,site:r.a.object,title:r.a.string,onClick:r.a.func},V.defaultProps={onClick:d.noop};var G=V,K=s("./node_modules/@babel/runtime/helpers/extends.js"),H=s.n(K),Q=s("./client/blocks/reader-featured-video/index.jsx"),Y=s("./client/blocks/reader-featured-image/index.jsx");const Z=e=>{let t=e.canonicalMedia,s=e.postUrl,o=e.allowVideoPlaying,n=e.onVideoThumbnailClick,a=e.isVideoExpanded;return t?"video"===t.mediaType?c.a.createElement(Q.a,H()({},t,{videoEmbed:t,allowPlaying:o,onThumbnailClick:n,isExpanded:a})):c.a.createElement(Y.a,{imageUrl:t.src,href:s,fetched:t.fetched}):null};Z.propTypes={canonicalMedia:r.a.object,postUrl:r.a.string,allowVideoPlaying:r.a.bool,onVideoThumbnailClick:r.a.func,isVideoExpanded:r.a.bool},Z.defaultProps={allowVideoPlaying:!0};var X=Z;const J=e=>{let t=e.post,s=e.children,o=e.isDiscover,n=e.expandCard,a=e.postKey,r=e.isExpanded,i=e.site,l=null;return"video"===Object(d.get)(t,"canonical_media.mediaType")&&(l=Object(d.partial)(n,{postKey:a,post:t,site:i})),c.a.createElement("div",{className:"reader-post-card__post"},c.a.createElement(X,{canonicalMedia:t.canonical_media,postUrl:t.URL,onVideoThumbnailClick:l,isVideoExpanded:r}),c.a.createElement("div",{className:"reader-post-card__post-details"},c.a.createElement(D.a,null,c.a.createElement("h1",{className:"reader-post-card__title"},c.a.createElement("a",{className:"reader-post-card__title-link",href:t.URL},c.a.createElement(L.a,null,t.title)))),c.a.createElement(q.a,{post:t,isDiscover:o}),s))};J.propTypes={post:r.a.object.isRequired,isDiscover:r.a.bool};var $=J,ee=s("./client/blocks/conversations/list.jsx"),te=s("./client/blocks/reader-post-options-menu/index.jsx");const se=e=>{let t=e.post,s=e.postByline,o=e.children,n=e.isDiscover,a=e.onClick;return c.a.createElement("div",{className:"reader-post-card__post",onClick:a},c.a.createElement(X,{canonicalMedia:t.canonical_media,postUrl:t.URL,allowVideoPlaying:!1}),c.a.createElement("div",{className:"reader-post-card__post-details"},s,c.a.createElement(te.a,{className:"ignore-click",showFollow:!0,post:t,position:"bottom"}),c.a.createElement(D.a,null,c.a.createElement("h1",{className:"reader-post-card__title"},c.a.createElement("a",{className:"reader-post-card__title-link",href:t.URL},c.a.createElement(L.a,null,t.title)))),c.a.createElement(q.a,{post:t,isDiscover:n}),o))};se.propTypes={post:r.a.object.isRequired,postByline:r.a.object,isDiscover:r.a.bool};var oe=se;class ne extends c.a.Component{render(){return c.a.createElement("div",{className:"reader-post-card__conversation-post"},c.a.createElement(oe,this.props),c.a.createElement(ee.b,{post:this.props.post,commentIds:this.props.commentIds}))}}n()(ne,"propTypes",{post:r.a.object.isRequired,commentIds:r.a.array.isRequired});var ae=ne,re=s("./client/reader/follow-button/index.jsx"),ie=s("./client/blocks/daily-post-button/index.jsx"),ce=s("./client/blocks/daily-post-button/helper.js"),le=s("./client/reader/discover/helper.js"),de=s("./packages/i18n-calypso/dist/esm/index.js"),pe=s("./client/reader/discover/stats.js"),me=s("./client/reader/follow-sources.jsx");class ue extends c.a.Component{constructor(){super(...arguments),n()(this,"recordFollowToggle",e=>{Object(pe.a)(e,this.props.siteUrl)})}render(){if(!this.props.followUrl)return null;const e=this.props.translate("Follow %(siteName)s",{args:{siteName:this.props.siteName}}),t=this.props.translate("Following %(siteName)s",{args:{siteName:this.props.siteName}});return c.a.createElement(re.a,{className:"is-discover",siteUrl:this.props.followUrl,iconSize:20,onFollowToggle:this.recordFollowToggle,followLabel:e,followingLabel:t,followSource:me.a})}}n()(ue,"propTypes",{siteName:r.a.string.isRequired,followUrl:r.a.string.isRequired});var he=Object(de.localize)(ue),be=s("./client/state/ui/reader/card-expansions/actions.js"),fe=s("./client/reader/post-key.js");function je(e,t){const s=Object(fe.c)(t);return!(!s||!e.ui.reader.cardExpansions[s])}s("./client/blocks/reader-post-card/style.scss");class ge extends c.a.Component{constructor(){super(...arguments),n()(this,"propagateCardClick",()=>{const e=Object(d.get)(this.props,"discoverPost")||this.props.post;this.props.onClick(e)}),n()(this,"handleCardClick",e=>{const t=h.a.findDOMNode(this),s=window.getSelection&&window.getSelection();e.button>0||e.metaKey||e.controlKey||e.shiftKey||e.altKey?f()(e.target,".reader-post-card__title-link",t)&&_.recordPermalinkClick("card_title_with_modifier",this.props.post):(f()(e.target,".should-scroll",t)&&setTimeout(function(){window.scrollTo(0,0)},100),f()(e.target,".ignore-click, [rel~=external]",t)||f()(e.target,"a",t)&&f()(e.target,".reader-excerpt",t)||s&&s.toString()||e.defaultPrevented||(e.preventDefault(),this.propagateCardClick()))})}render(){const e=this.props,t=e.post,s=e.discoverPost,o=e.discoverSite,n=e.site,a=e.feed,r=e.onCommentClick,i=e.showPrimaryFollowButton,l=e.isSelected,p=e.showSiteName,u=e.followSource,h=e.isDiscoverStream,b=e.postKey,f=e.isExpanded,_=e.expandCard,E=e.compact,k=!!(t.display_type&g.a.PHOTO_ONLY)&&!E,x=!!(t.display_type&g.a.GALLERY)&&!E,O=!!(t.display_type&g.a.FEATURED_VIDEO)&&!E,v=t.is_discover,C=Object(d.truncate)(t.title,{length:140,separator:/,? +/}),w=m()("reader-post-card",{"has-thumbnail":!!t.canonical_media,"is-photo":k,"is-gallery":x,"is-selected":l,"is-discover":v,"is-expanded-video":O&&f,"is-compact":E});let I;if(v&&!E){const e=Object(le.b)(t)||null;I=e&&c.a.createElement(he,{siteName:e,followUrl:Object(le.f)(t)})}const S=c.a.createElement(y.a,{post:s||t,site:n,visitUrl:t.URL,showVisit:!0,showMenu:!0,fullPost:!1,showMenuFollow:!v,onCommentClick:r,showEdit:!1,className:"ignore-click",iconSize:18});let R,T;if(h&&s&&o){const e=Object.assign({},s||{},{date:t.date,URL:t.URL,primary_tag:t.primary_tag});R=c.a.createElement(P,{post:e,site:o,showSiteName:!0})}else R=c.a.createElement(P,{post:t,site:n,feed:a,showSiteName:p||v,showAvatar:!E});T=E?c.a.createElement(ae,{post:t,title:C,isDiscover:v,postByline:R,commentIds:b.comments,onClick:this.handleCardClick}):k?c.a.createElement(G,{post:t,site:n,title:C,onClick:this.handleCardClick,isExpanded:f,expandCard:_,postKey:b},I,S):x?c.a.createElement(W,{post:t,title:C,isDiscover:v},S):c.a.createElement($,{post:t,title:C,isDiscover:v,isExpanded:f,expandCard:_,site:n,postKey:b},Object(ce.b)(t)&&n&&c.a.createElement(ie.a,{post:t,site:n}),I,S);const N=a?a.feed_URL:t.site_URL,D=k||E?d.noop:this.handleCardClick;return c.a.createElement(j.a,{className:w,onClick:D},!E&&R,i&&N&&c.a.createElement(re.a,{siteUrl:N,followSource:u,railcar:t.railcar}),T,this.props.children)}}n()(ge,"propTypes",{post:r.a.object.isRequired,site:r.a.object,feed:r.a.object,isSelected:r.a.bool,onClick:r.a.func,onCommentClick:r.a.func,showPrimaryFollowButton:r.a.bool,discoverPost:r.a.object,discoverSite:r.a.object,showSiteName:r.a.bool,followSource:r.a.string,isDiscoverStream:r.a.bool,postKey:r.a.object,compact:r.a.bool}),n()(ge,"defaultProps",{onClick:d.noop,onCommentClick:d.noop,isSelected:!1,showSiteName:!0});t.a=Object(l.b)((e,t)=>({isExpanded:je(e,t.postKey)}),{expandCard:be.a})(ge)},"./client/blocks/reader-post-card/style.scss":function(e,t,s){},"./client/blocks/reader-post-options-menu/index.jsx":function(e,t,s){"use strict";var o=s("./node_modules/@babel/runtime/helpers/defineProperty.js"),n=s.n(o),a=s("./node_modules/prop-types/index.js"),r=s.n(a),i=s("./node_modules/react/index.js"),c=s.n(i),l=s("./node_modules/lodash/lodash.js"),d=s("./node_modules/page/page.js"),p=s.n(d),m=s("./node_modules/classnames/index.js"),u=s.n(m),h=s("./node_modules/react-redux/es/index.js"),b=s("./packages/i18n-calypso/dist/esm/index.js"),f=s("./client/components/ellipsis-menu/index.jsx"),j=s("./client/components/popover/menu-item.jsx"),g=s("./client/state/reader/site-blocks/actions.js"),_=s("./client/state/posts/utils.js"),y=s("./client/reader/follow-button/index.jsx"),E=s("./client/reader/discover/helper.js"),k=s("./client/reader/stats.js"),x=s("./client/state/reader/feeds/selectors.js"),O=s("./client/state/reader/sites/selectors.js"),v=s("./client/components/data/query-reader-feed/index.jsx"),C=s("./client/components/data/query-reader-site/index.jsx"),w=s("./client/components/data/query-reader-teams/index.jsx"),I=s("./client/reader/lib/teams/index.js"),S=s("./client/state/selectors/get-reader-teams.js"),R=s("./client/state/selectors/get-blog-stickers.js"),T=s("./client/components/data/query-blog-stickers/index.jsx"),N=s("./client/state/sites/blog-stickers/actions.js");class P extends c.a.Component{constructor(){super(...arguments),n()(this,"toggleSticker",()=>{(this.props.hasSticker?this.props.removeBlogSticker:this.props.addBlogSticker)(this.props.blogId,this.props.blogStickerName)})}render(){const e=this.props,t=e.hasSticker,s=e.blogStickerName,o=e.children,n=u()("reader-post-options-menu__blog-sticker-menu-item",{"has-sticker":t});return c.a.createElement(j.a,{icon:"flag",key:s,className:n,onClick:this.toggleSticker},o)}}n()(P,"propTypes",{blogId:r.a.number,blogStickerName:r.a.string,hasSticker:r.a.bool});var D=Object(h.b)(null,{addBlogSticker:N.a,removeBlogSticker:N.d})(P);class L extends c.a.Component{render(){const e=this.props,t=e.blogId,s=e.stickers;return c.a.createElement("div",{className:"reader-post-options-menu__blog-stickers"},c.a.createElement(T.a,{blogId:t}),Object(l.map)(["dont-recommend","broken-in-reader","a8c-test-blog"],e=>c.a.createElement(D,{key:e,blogId:t,blogStickerName:e,hasSticker:Object(l.includes)(s,e)},e)))}}n()(L,"propTypes",{blogId:r.a.number.isRequired});var U=Object(h.b)((e,t)=>{let s=t.blogId;return{stickers:Object(R.a)(e,s)}})(L),A=s("./client/blocks/conversation-follow-button/index.jsx"),F=s("./client/blocks/conversation-follow-button/helper.js"),q=s("./client/reader/follow-sources.jsx");s("./client/blocks/reader-post-options-menu/style.scss");class M extends c.a.Component{constructor(){super(...arguments),n()(this,"blockSite",()=>{k.recordAction("blocked_blog"),k.recordGaEvent("Clicked Block Site"),k.recordTrackForPost("calypso_reader_block_site",this.props.post),this.props.blockSite(this.props.post.site_ID),this.props.onBlock()}),n()(this,"reportPost",()=>{this.props.post&&this.props.post.URL&&(k.recordAction("report_post"),k.recordGaEvent("Clicked Report Post","post_options"),k.recordTrackForPost("calypso_reader_post_reported",this.props.post),window.open("https://wordpress.com/abuse/?report_url="+encodeURIComponent(this.props.post.URL),"_blank"))}),n()(this,"reportSite",()=>{this.props.site&&this.props.site.URL&&(k.recordAction("report_site"),k.recordGaEvent("Clicked Report Site","post_options"),k.recordTrackForPost("calypso_reader_site_reported",this.props.site),window.open("https://wordpress.com/abuse/?report_url="+encodeURIComponent(this.props.site.URL),"_blank"))}),n()(this,"getFollowUrl",()=>this.props.feed?this.props.feed.feed_URL:this.props.post.feed_URL||this.props.post.site_URL),n()(this,"onMenuToggle",e=>{k.recordAction(e?"open_post_options_menu":"close_post_options_menu"),k.recordGaEvent(e?"Open Post Options Menu":"Close Post Options Menu"),k.recordTrackForPost("calypso_reader_post_options_menu_"+(e?"opened":"closed"),this.props.post)}),n()(this,"editPost",()=>{const e=this.props,t=e.post,s=e.site;let o="//wordpress.com/post/"+t.site_ID+"/"+t.ID+"/";s&&s.slug&&(o=_.e(t,s)),k.recordAction("edit_post"),k.recordGaEvent("Clicked Edit Post","post_options"),k.recordTrackForPost("calypso_reader_edit_post_clicked",this.props.post),setTimeout(function(){0===o.indexOf("//")?window.location.href=o:p()(o)},100)}),n()(this,"visitPost",()=>{const e=this.props.post;e&&e.URL&&(k.recordAction("visit_post"),k.recordGaEvent("Clicked Visit Post","post_options"),k.recordTrackForPost("calypso_reader_visit_post_clicked",e),window.open(e.URL,"_blank"))})}render(){const e=this.props,t=e.post,s=e.site,o=e.feed,n=e.teams,a=e.translate,r=e.position;if(!t)return null;const i=t.ID,l=t.site_ID,d=_.I("edit_post",t),p=E.j(t),m=this.getFollowUrl(),h=Object(I.a)(n),b=this.props.showConversationFollow&&Object(F.a)(t);let g=!1;!t.site_ID||t.is_external&&!t.is_jetpack||d||p||(g=!0);const k=u()("reader-post-options-menu",this.props.className);return c.a.createElement("span",{className:k},!o&&t&&t.feed_ID&&c.a.createElement(v.a,{feedId:+t.feed_ID}),!s&&t&&!t.is_external&&t.site_ID&&c.a.createElement(C.a,{siteId:+t.site_ID}),!n&&c.a.createElement(w.a,null),c.a.createElement(f.a,{className:"reader-post-options-menu__ellipsis-menu",popoverClassName:"reader-post-options-menu__popover",onToggle:this.onMenuToggle,position:r},h&&s&&c.a.createElement(U,{blogId:+s.ID}),this.props.showFollow&&c.a.createElement(y.a,{tagName:j.a,siteUrl:m,followLabel:b?a("Follow Site"):null,followingLabel:b?a("Following Site"):null}),b&&c.a.createElement(A.a,{tagName:j.a,siteId:l,postId:i,post:t,followSource:q.h}),this.props.showVisitPost&&t.URL&&c.a.createElement(j.a,{onClick:this.visitPost,icon:"external"},a("Visit Post")),this.props.showEditPost&&d&&c.a.createElement(j.a,{onClick:this.editPost,icon:"pencil"},a("Edit Post")),(this.props.showFollow||d||t.URL)&&(g||p)&&c.a.createElement("hr",{className:"reader-post-options-menu__hr"}),g&&c.a.createElement(j.a,{onClick:this.blockSite},a("Block Site")),(this.props.showReportPost&&g||p)&&c.a.createElement(j.a,{onClick:this.reportPost},a("Report this Post")),this.props.showReportSite&&s&&g&&c.a.createElement(j.a,{onClick:this.reportSite},a("Report this Site"))))}}n()(M,"propTypes",{post:r.a.object,feed:r.a.object,onBlock:r.a.func,showFollow:r.a.bool,showVisitPost:r.a.bool,showEditPost:r.a.bool,showConversationFollow:r.a.bool,showReportPost:r.a.bool,showReportSite:r.a.bool,position:r.a.string}),n()(M,"defaultProps",{onBlock:l.noop,position:"top left",showFollow:!0,showVisitPost:!0,showEditPost:!0,showConversationFollow:!0,showReportPost:!0,showReportSite:!1});t.a=Object(h.b)((e,t)=>{let s=t.post,o=(s=void 0===s?{}:s).feed_ID,n=s.is_external,a=s.site_ID;const r=n?null:a;return Object.assign({teams:Object(S.a)(e)},o>0&&{feed:Object(x.a)(e,o)},r>0&&{site:Object(O.a)(e,r)})},{blockSite:g.a})(Object(b.localize)(M))},"./client/blocks/reader-post-options-menu/style.scss":function(e,t,s){},"./client/blocks/reader-share/index.jsx":function(e,t,s){"use strict";var o=s("./node_modules/@babel/runtime/helpers/defineProperty.js"),n=s.n(o),a=s("./node_modules/react/index.js"),r=s.n(a),i=s("./node_modules/react-redux/es/index.js"),c=s("./node_modules/url/url.js"),l=s.n(c),d=s("./node_modules/lodash/lodash.js"),p=s("./client/config/index.js"),m=s("./node_modules/classnames/index.js"),u=s.n(m),h=s("./node_modules/prop-types/index.js"),b=s.n(h),f=s("./node_modules/qs/lib/index.js"),j=s("./node_modules/page/page.js"),g=s.n(j),_=s("./packages/i18n-calypso/dist/esm/index.js"),y=s("./node_modules/@babel/runtime/helpers/extends.js"),E=s.n(y),k=s("./client/reader/components/reader-popover/index.jsx"),x=s("./client/components/popover/menu.jsx");var O=e=>{const t=Object(d.omit)(e,"popoverComponent");return r.a.createElement(x.a,E()({className:"reader-popover__menu",popoverComponent:k.a},t),e.children)},v=s("./client/components/popover/menu-item.jsx"),C=s("./client/components/gridicon/index.jsx"),w=s("./client/components/social-logo/index.jsx"),I=s("./client/reader/stats.js"),S=s("./client/sections-helper.js"),R=s("./client/components/site-selector/index.jsx"),T=s("./client/state/selectors/get-primary-site-id.js");s("./client/blocks/reader-share/style.scss");function N(){Object(S.c)("post-editor")}const P={twitter(e){const t={scheme:"https",hostname:"twitter.com",pathname:"/intent/tweet",query:{text:e.title,url:e.URL,via:"wordpressdotcom"}},s=l.a.format(t);window.open(s,"twitter","width=550,height=420,resizeable,scrollbars")},facebook(e){const t={scheme:"https",hostname:"www.facebook.com",pathname:"/sharer.php",query:{u:e.URL,app_id:Object(p.a)("facebook_api_key")}},s=l.a.format(t);window.open(s,"facebook","width=626,height=436,resizeable,scrollbars")}};class D extends r.a.Component{constructor(e){super(e),n()(this,"state",{showingMenu:!1}),n()(this,"deferMenuChange",e=>{this.closeHandle&&clearTimeout(this.closeHandle),this.closeHandle=Object(d.defer)(()=>{this.closeHandle=null,this.setState({showingMenu:e})})}),n()(this,"toggle",e=>{e.preventDefault(),this.state.showingMenu||(I.recordAction("open_share"),I.recordGaEvent("Opened Share"),I.recordTrack("calypso_reader_share_opened",{has_sites:this.props.hasSites})),this.deferMenuChange(!this.state.showingMenu)}),n()(this,"closeMenu",()=>{this.mounted&&this.deferMenuChange(!1)}),n()(this,"pickSiteToShareTo",e=>(I.recordAction("share_wordpress"),I.recordGaEvent("Clicked on Share to WordPress"),I.recordTrack("calypso_reader_share_to_site"),g()("/post/".concat(e,"?")+function(e){const t={};return e.content_embeds&&e.content_embeds.length&&(t.embed=e.content_embeds[0].embedUrl||e.content_embeds[0].src),e.canonical_image&&e.canonical_image.uri&&(t.image=e.canonical_image.uri),t.title="".concat(e.title," â€” ").concat(e.site_name),t.text=e.excerpt,t.url=e.URL,Object(f.stringify)(t)}(this.props.post)),!0)),n()(this,"closeExternalShareMenu",e=>{this.closeMenu();const t=P[e];t&&(I.recordAction("share_"+e),I.recordGaEvent("Clicked on Share to "+e),I.recordTrack("calypso_reader_share_action_picked",{action:e}),t(this.props.post))}),this.mounted=!1,this.shareButton=r.a.createRef()}componentDidMount(){this.mounted=!0}componentWillUnmount(){this.closeHandle&&(clearTimeout(this.closeHandle),this.closeHandle=null),this.mounted=!1}render(){const e=this.props.translate,t=u()({"reader-share__button":!0,"ignore-click":!0,"is-active":this.state.showingMenu});return r.a.createElement(this.props.tagName,{className:"reader-share",onClick:this.toggle,onTouchStart:N,onMouseEnter:N},[r.a.createElement("span",{key:"button",ref:this.shareButton,className:t},r.a.createElement(C.a,{icon:"share",size:this.props.iconSize}),r.a.createElement("span",{className:"reader-share__button-label"},e("Share",{comment:"Share the post"}))),this.state.showingMenu&&r.a.createElement(O,{key:"menu",context:this.shareButton.current,isVisible:this.state.showingMenu,onClose:this.closeExternalShareMenu,position:this.props.position,className:"popover reader-share__popover",popoverTitle:e("Share on")},r.a.createElement(v.a,{action:"facebook",className:"reader-share__popover-item",title:e("Share on Facebook"),focusOnHover:!1},r.a.createElement(w.a,{icon:"facebook"}),r.a.createElement("span",null,"Facebook")),r.a.createElement(v.a,{action:"twitter",className:"reader-share__popover-item",title:e("Share on Twitter"),focusOnHover:!1},r.a.createElement(w.a,{icon:"twitter"}),r.a.createElement("span",null,"Twitter")),this.props.hasSites&&r.a.createElement(R.a,{className:"reader-share__site-selector",onSiteSelect:this.pickSiteToShareTo,groups:!0}))])}}n()(D,"propTypes",{iconSize:b.a.number}),n()(D,"defaultProps",{position:"bottom",tagName:"li",iconSize:24});t.a=Object(i.b)(e=>({hasSites:!!Object(T.a)(e)}))(Object(_.localize)(D))},"./client/blocks/reader-share/style.scss":function(e,t,s){},"./client/blocks/reader-site-stream-link/index.jsx":function(e,t,s){"use strict";var o=s("./node_modules/@babel/runtime/helpers/extends.js"),n=s.n(o),a=s("./node_modules/@babel/runtime/helpers/defineProperty.js"),r=s.n(a),i=s("./node_modules/react/index.js"),c=s.n(i),l=s("./node_modules/prop-types/index.js"),d=s.n(l),p=s("./node_modules/lodash/lodash.js"),m=s("./client/reader/route/index.js"),u=s("./client/reader/stats.js"),h=s("./client/components/emojify/index.jsx");class b extends c.a.Component{constructor(){super(...arguments),r()(this,"recordClick",()=>{Object(u.recordAction)("visit_blog_feed"),Object(u.recordGaEvent)("Clicked Feed Link"),this.props.post&&Object(u.recordTrackForPost)("calypso_reader_feed_link_clicked",this.props.post)})}render(){if(!this.props.feedId&&!this.props.siteId)return c.a.createElement("span",null,c.a.createElement(h.a,null,this.props.children));const e=Object(m.f)(this.props.feedId,this.props.siteId);return c.a.createElement("a",n()({},Object(p.omit)(this.props,["feedId","siteId","post"]),{href:e,onClick:this.recordClick}),c.a.createElement(h.a,null,this.props.children))}}r()(b,"propTypes",{feedId:d.a.number,siteId:d.a.number,post:d.a.object}),t.a=b},"./client/blocks/reader-visit-link/index.jsx":function(e,t,s){"use strict";var o=s("./node_modules/@babel/runtime/helpers/defineProperty.js"),n=s.n(o),a=s("./node_modules/prop-types/index.js"),r=s.n(a),i=s("./node_modules/react/index.js"),c=s.n(i),l=s("./node_modules/lodash/lodash.js"),d=s("./client/components/external-link/index.jsx");s("./client/blocks/reader-visit-link/style.scss");class p extends c.a.Component{render(){return c.a.createElement(d.a,{className:"reader-visit-link",href:this.props.href,target:"_blank",icon:!0,showIconFirst:!0,iconSize:this.props.iconSize,iconClassName:"reader-visit-link__icon",onClick:this.props.onClick},c.a.createElement("span",{className:"reader-visit-link__label"},this.props.children))}}n()(p,"propTypes",{href:r.a.string,iconSize:r.a.number,onClick:r.a.func}),n()(p,"defaultProps",{iconSize:24,onClick:l.noop}),t.a=p},"./client/blocks/reader-visit-link/style.scss":function(e,t,s){},"./client/blocks/user-mentions/add.jsx":function(e,t,s){"use strict";var o=s("./node_modules/@babel/runtime/helpers/extends.js"),n=s.n(o),a=s("./node_modules/@babel/runtime/helpers/defineProperty.js"),r=s.n(a),i=s("./node_modules/react/index.js"),c=s.n(i),l=s("./node_modules/textarea-caret/index.js"),d=s.n(l),p=s("./node_modules/lodash/lodash.js"),m=s("./client/blocks/user-mentions/suggestion-list.jsx");const u=9,h=13,b=27,f=32,j=38,g=40;t.a=(e=>{var t,s;return s=t=class extends c.a.Component{constructor(e){var t;super(e),t=this,r()(this,"matchingSuggestions",[]),r()(this,"state",{showPopover:!1,popoverContext:null,popoverPosition:null,query:""}),r()(this,"handleKeyDown",e=>{if(!this.state.showPopover)return;const t=this.getSelectedSuggestionIndex();if(Object(p.includes)([h,u],e.keyCode))return e.preventDefault(),!1;if(!Object(p.includes)([j,g],e.keyCode)||-1===t)return;let s;e.preventDefault(),e.keyCode===g?s=(t+1)%this.matchingSuggestions.length:(s=t-1)<0&&(s=this.matchingSuggestions.length-1),this.setState({selectedSuggestionId:this.matchingSuggestions[s].ID})}),r()(this,"handleKeyUp",e=>{if(Object(p.includes)([g,j],e.keyCode))return;if(Object(p.includes)([f,b],e.keyCode))return this.hidePopover();if(Object(p.includes)([h,u],e.keyCode)){if(!this.state.showPopover||0===this.matchingSuggestions.length)return;e.preventDefault();const t=this.getSuggestion();return t&&this.insertSuggestion(t),this.hidePopover()}const t=this.getQueryText();this.setState({showPopover:null!==t,selectedSuggestionId:null,query:t})}),r()(this,"insertSuggestion",e=>{let t=e.user_login;if(!t)return;const s=this.textInput.current,o=s.value.slice(0,s.selectionEnd).lastIndexOf("@"),n=s.value.slice(0,o),a=s.value.slice(s.selectionEnd,s.value.length+1);let r=n+"@"+t;t!==a&&(r+=a),s.value=r,s.focus(),s.selectionStart=o+r.length}),r()(this,"updatePosition",function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t.state,s=arguments.length>1?arguments[1]:void 0;s||(s=t.getPosition(e)),t.setState({popoverPosition:s})}),r()(this,"throttledUpdatePosition",Object(p.throttle)(this.updatePosition,100)),r()(this,"hidePopover",()=>this.setState({showPopover:!1})),this.textInput=c.a.createRef()}componentDidMount(){"undefined"!=typeof window&&window.addEventListener("resize",this.throttledUpdatePosition)}componentWillUpdate(e,t){if(this.state.showPopover||!t.showPopover){if(t.showPopover){const e=this.state.popoverPosition&&this.state.popoverPosition.top,s=this.state.popoverPosition&&this.state.popoverPosition.left;if(e&&s){const o=this.getPosition(),n=o.top,a=o.left,r=e<n&&s>a;(e>n&&e<a||r)&&this.updatePosition(t,{top:n,left:a})}}}else this.updatePosition(t)}componentWillUnmount(){"undefined"!=typeof window&&window.removeEventListener("resize",this.throttledUpdatePosition)}getQueryText(){const e=this.textInput.current,t=e.value.slice(0,e.selectionEnd).lastIndexOf("@"),s=e.value.slice(t,e.value.length+1),o=new RegExp("(?:^|\\s)@([A-Za-z0-9_+-]*)$","gi").exec(s);return o&&o.length>1?o[1]:null}getPosition(){const e=this.textInput.current,t=e.getBoundingClientRect(),s=this.getQueryText();let o,n=e.selectionEnd;s&&(n=e.selectionEnd-s.length);const a=window.getComputedStyle(e).getPropertyValue("line-height");a&&(o=+a.replace("px","")+4);const r=d()(e,n),i=window.pageXOffset||document.documentElement.scrollLeft,c=window.pageYOffset||document.documentElement.scrollTop,l={left:t.left+r.left+i,top:t.top+r.top+c+o},p=window.innerWidth-l.left;return p<150&&(l.left=l.left-(150-p)),l}getSuggestion(){const e=this.getSelectedSuggestionIndex();return e>-1?this.matchingSuggestions[e]:null}getSelectedSuggestionIndex(){return this.state.selectedSuggestionId?Object(p.findIndex)(this.matchingSuggestions,e=>{return e.ID===this.state.selectedSuggestionId}):0}getMatchingSuggestions(e,t){if(t){t=Object(p.escapeRegExp)(t);const s=new RegExp("^".concat(t,"|\\s").concat(t),"ig");e=e.filter(e=>{let t=e.user_login,o=e.display_name;return s.test("".concat(t," ").concat(o))})}return e.slice(0,10)}render(){const t=this.props.suggestions,s=this.state,o=s.query,a=s.showPopover;this.matchingSuggestions=this.getMatchingSuggestions(t,o);const r=this.state.selectedSuggestionId||Object(p.get)(Object(p.head)(this.matchingSuggestions),"ID"),l=Object(p.pick)(this.state.popoverPosition,["top","left"]);return c.a.createElement(i.Fragment,null,c.a.createElement(e,n()({},this.props,{onKeyUp:this.handleKeyUp,onKeyDown:this.handleKeyDown,ref:this.textInput})),a&&this.matchingSuggestions.length>0&&c.a.createElement(m.a,{suggestions:this.matchingSuggestions,selectedSuggestionId:r,popoverContext:this.textInput.current,popoverPosition:l,onClick:this.insertSuggestion,onClose:this.hidePopover}))}},r()(t,"displayName","withUserMentions( ".concat(e.displayName||e.name," )")),r()(t,"propTypes",{}),s})},"./client/blocks/user-mentions/suggestion-list.jsx":function(e,t,s){"use strict";var o=s("./node_modules/prop-types/index.js"),n=s.n(o),a=s("./node_modules/react/index.js"),r=s.n(a),i=s("./node_modules/lodash/lodash.js"),c=s("./client/components/popover/menu.jsx"),l=s("./client/components/popover/menu-item.jsx");const d=e=>{let t=e.avatarUrl,s=e.fullName,o=e.query;const n=(e,t)=>{const s={username:"(^".concat(o,")(\\w*)\\s*"),fullName:"(^.*?)(\\b".concat(o,")(.*)")},n=new RegExp(s[t],"ig").exec(e);return n?n.map((e,t)=>0===t?"":o.toLowerCase()===e.toLowerCase()?r.a.createElement("mark",{className:"user-mentions__highlight",key:t},e):e):[e]},a=n(e.username,"username"),i=n(s,"fullName");return a.unshift("@"),r.a.createElement("div",null,r.a.createElement("img",{className:"user-mentions__avatar",src:t,alt:""}),r.a.createElement("span",{className:"user-mentions__username"},a),r.a.createElement("small",{className:"user-mentions__fullname"},i))};d.propTypes={avatarUrl:n.a.string,fullName:n.a.string,query:n.a.string,username:n.a.string},d.defaultProps={avatarUrl:"",fullName:"",query:"",username:""};var p=d;const m=e=>{let t=e.onClick,s=e.onClose,o=e.popoverContext,n=e.popoverPosition,a=e.query,d=e.selectedSuggestionId,m=e.suggestions;return r.a.createElement(c.a,{className:"user-mentions__suggestions",context:o,isVisible:!0,autoPosition:!1,position:"bottom right",onClose:s,customPosition:n},m.map(e=>r.a.createElement(l.a,{className:"user-mentions__suggestion",key:e.ID,isSelected:e.ID===d,onClick:Object(i.bind)(t,null,e)},r.a.createElement(p,{avatarUrl:e.image_URL,username:e.user_login,fullName:e.display_name,query:a}))))};m.propTypes={onClick:n.a.func,onClose:n.a.func,query:n.a.string,popoverContext:n.a.object,popoverPosition:n.a.shape({top:n.a.number,left:n.a.number,positionClass:n.a.oneOf(["top","right","bottom","left"])}),selectedSuggestionId:n.a.number,suggestions:n.a.array},m.defaultProps={onClick:()=>{},onClose:()=>{},query:"",popoverContext:{},popoverPosition:null,selectedSuggestionId:0,suggestions:[]};t.a=m},"./client/components/data/query-blog-stickers/index.jsx":function(e,t,s){"use strict";var o=s("./node_modules/@babel/runtime/helpers/defineProperty.js"),n=s.n(o),a=s("./node_modules/prop-types/index.js"),r=s.n(a),i=s("./node_modules/react/index.js"),c=s("./node_modules/react-redux/es/index.js"),l=s("./client/state/selectors/get-blog-stickers.js"),d=s("./client/state/sites/blog-stickers/actions.js");class p extends i.Component{componentDidMount(){this.props.stickersLoaded||this.props.listBlogStickers(this.props.blogId)}componentDidUpdate(e){e.blogId===this.props.blogId||this.props.stickersLoaded||this.props.listBlogStickers(this.props.blogId)}render(){return null}}n()(p,"propTypes",{blogId:r.a.number.isRequired,stickersLoaded:r.a.bool.isRequired}),t.a=Object(c.b)((e,t)=>{let s=t.blogId;return{stickersLoaded:!!Object(l.a)(e,s)}},{listBlogStickers:d.b})(p)},"./client/components/data/query-reader-feed/index.jsx":function(e,t,s){"use strict";var o=s("./node_modules/prop-types/index.js"),n=s.n(o),a=s("./node_modules/react/index.js"),r=s("./node_modules/react-redux/es/index.js"),i=s("./node_modules/redux/es/redux.js"),c=s("./client/state/reader/feeds/selectors.js"),l=s("./client/state/reader/feeds/actions.js");class d extends a.Component{componentWillMount(){this.props.shouldFeedBeFetched&&this.props.requestFeed(this.props.feedId)}componentWillReceiveProps(e){e.shouldFeedBeFetched&&this.props.feedId!==e.feedId&&e.requestFeed(e.feedId)}render(){return null}}d.propTypes={feedId:n.a.number,shouldFeedBeFetched:n.a.bool,requestFeed:n.a.func},d.defaultProps={requestFeed:()=>{}},t.a=Object(r.b)((e,t)=>{const s=t.feedId;return{shouldFeedBeFetched:Object(c.c)(e,s)}},e=>Object(i.b)({requestFeed:l.c},e))(d)},"./client/components/data/query-reader-teams/index.jsx":function(e,t,s){"use strict";var o=s("./node_modules/prop-types/index.js"),n=s.n(o),a=s("./node_modules/react/index.js"),r=s("./node_modules/react-redux/es/index.js"),i=s("./client/state/data-layer/wpcom-http/utils.js"),c=s("./client/state/data-layer/wpcom-http/actions.js"),l=s("./client/state/data-layer/handler-registry.js");Object(l.b)("state/data-layer/wpcom/read/teams/index.js",{READER_TEAMS_REQUEST:[Object(i.a)({fetch:e=>Object(c.a)({method:"GET",path:"/read/teams",apiVersion:"1.2"},e),onSuccess:(e,t)=>({type:"READER_TEAMS_RECEIVE",payload:t}),onError:e=>({type:"READER_TEAMS_RECEIVE",payload:e,error:!0})})]});class d extends a.Component{componentWillMount(){this.props.requestTeams()}render(){return null}}d.propTypes={request:n.a.func};t.a=Object(r.b)(null,{requestTeams:function(){return{type:"READER_TEAMS_REQUEST"}}})(d)},"./client/components/data/query-users-suggestions/index.jsx":function(e,t,s){"use strict";var o=s("./node_modules/@babel/runtime/helpers/defineProperty.js"),n=s.n(o),a=s("./node_modules/prop-types/index.js"),r=s.n(a),i=s("./node_modules/react/index.js"),c=s("./node_modules/react-redux/es/index.js"),l=s("./client/state/users/suggestions/selectors.js"),d=s("./client/lib/wp/browser.js");class p extends i.Component{componentWillMount(){this.request(this.props)}componentWillReceiveProps(e){this.props.siteId!==e.siteId&&this.request(e)}request(e){!e.isRequesting&&e.siteId&&e.requestUserSuggestions(e.siteId)}render(){return null}}n()(p,"propTypes",{siteId:r.a.number,isRequesting:r.a.bool,requestUserSuggestions:r.a.func}),n()(p,"defaultProps",{requestUserSuggestions:()=>{},isRequesting:!1});t.a=Object(c.b)((e,t)=>({isRequesting:Object(l.b)(e,t.siteId)}),{requestUserSuggestions:function(e){return t=>(t({type:"USER_SUGGESTIONS_REQUEST",siteId:e}),d.a.users().suggest({site_id:e}).then(s=>{t(function(e,t){return{type:"USER_SUGGESTIONS_RECEIVE",suggestions:t,siteId:e}}(e,s.suggestions)),t({type:"USER_SUGGESTIONS_REQUEST_SUCCESS",siteId:e,data:s})}).catch(s=>t({type:"USER_SUGGESTIONS_REQUEST_FAILURE",siteId:e,error:s})))}})(p)},"./client/components/gravatar-caterpillar/index.jsx":function(e,t,s){"use strict";var o=s("./node_modules/@babel/runtime/helpers/defineProperty.js"),n=s.n(o),a=s("./node_modules/react/index.js"),r=s.n(a),i=s("./node_modules/prop-types/index.js"),c=s.n(i),l=s("./node_modules/lodash/lodash.js"),d=s("./client/components/gravatar/index.jsx");s("./client/components/gravatar-caterpillar/style.scss");class p extends r.a.Component{render(){const e=this.props,t=e.users,s=e.onClick,o=e.maxGravatarsToDisplay;if(Object(l.size)(t)<1)return null;const n=o/2,a=Object(l.takeRight)(Object(l.filter)(Object(l.uniqBy)(t,"avatar_URL"),"avatar_URL"),o),i=Object(l.size)(a);return r.a.createElement("div",{className:"gravatar-caterpillar",onClick:s,"aria-hidden":"true"},Object(l.map)(a,(e,t)=>{let s="gravatar-caterpillar__gravatar";return i>n&&t<i-n&&(s+=" is-hidden-on-small-screens"),r.a.createElement(d.a,{className:s,key:e.email,user:e,size:32})}))}}n()(p,"propTypes",{onClick:c.a.func}),p.defaultProps={onClick:l.noop,maxGravatarsToDisplay:10},t.a=p},"./client/components/gravatar-caterpillar/style.scss":function(e,t,s){},"./client/components/time-since/index.jsx":function(e,t,s){"use strict";s.d(t,"a",function(){return m});var o=s("./node_modules/@babel/runtime/helpers/defineProperty.js"),n=s.n(o),a=s("./node_modules/react/index.js"),r=s.n(a),i=s("./node_modules/moment/moment.js"),c=s.n(i),l=s("./client/lib/human-date/index.js"),d=s("./client/lib/interval/index.js"),p=s("./client/lib/react-smart-set-state/index.js");class m extends a.PureComponent{constructor(){super(...arguments),n()(this,"smartSetState",p.a),n()(this,"update",e=>{const t=this.props.dateFormat;e=e||this.props.date,this.smartSetState({humanDate:Object(l.a)(e,t),fullDate:c()(e).format("llll")})})}componentWillMount(){this.update()}componentWillReceiveProps(e){this.update(e.date)}render(){return r.a.createElement("time",{className:this.props.className,dateTime:this.props.date,title:this.state.fullDate},r.a.createElement(d.e,{period:d.d,onTick:this.update}),this.state.humanDate)}}},"./client/lib/human-date/index.js":function(e,t,s){"use strict";s.d(t,"a",function(){return r});var o=s("./packages/i18n-calypso/dist/esm/index.js"),n=s.n(o);const a=6e4;function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ll";const s=n.a.moment();e=n.a.moment(e);let o=s.diff(e);if(o<0&&(o=0),o<a)return n.a.translate("just now");if(o<60*a){const e=Math.ceil(o/a);return n.a.translate("%(minutes)dm ago",{args:{minutes:e},comment:"example for a resulting string: 2m ago"})}if(o<60*a*24){const t=s.diff(e,"hours");return n.a.translate("%(hours)dh ago",{args:{hours:t},comment:"example for a resulting string: 5h ago"})}if(o<60*a*24*7){const t=s.diff(e,"days");return n.a.translate("%(days)dd ago",{args:{days:t},comment:"example for a resulting string: 4d ago"})}return e.format(t)}},"./client/lib/react-smart-set-state/index.js":function(e,t,s){"use strict";function o(e){return!!Object.keys(e).some(function(t){return!(this.state&&this.state.hasOwnProperty(t))||this.state[t]!==e[t]},this)&&(this.setState(e),!0)}s.d(t,"a",function(){return o})},"./client/lib/string/index.js":function(e,t,s){"use strict";function o(e,t){return e===t||!(!e||!t)&&(e=e.replace(/[\s'.\-_"]/g,""),t=t.replace(/[\s'.\-_"]/g,""),e.toLowerCase()===t.toLowerCase())}s.d(t,"a",function(){return o})},"./client/lib/with-dimensions/index.jsx":function(e,t,s){"use strict";var o=s("./node_modules/@babel/runtime/helpers/extends.js"),n=s.n(o),a=s("./node_modules/@babel/runtime/helpers/defineProperty.js"),r=s.n(a),i=s("./node_modules/react/index.js"),c=s.n(i),l=s("./node_modules/prop-types/index.js"),d=s.n(l),p=s("./node_modules/lodash/lodash.js"),m=s("./client/lib/after-layout-flush/index.js");t.a=(e=>{var t,s;return s=t=class extends c.a.Component{constructor(){var e;super(...arguments),e=this,r()(this,"state",{width:0,height:0}),r()(this,"handleResize",Object(m.a)(function(){const t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.props).domTarget||e.setRef||e.divRef;if(t){const s=t.getClientRects()[0];if(!s)return;const o=s.width,n=s.height,a=t.scrollWidth>t.clientWidth+4,r=t.scrollHeight>t.clientHeight+4;e.setState({width:o,height:n,overflowX:a,overflowY:r})}})),r()(this,"handleMount",e=>{this.divRef=e,this.handleResize()}),r()(this,"setWithDimensionsRef",e=>{this.setRef=e,this.handleResize()})}componentDidMount(){this.resizeEventListener=window.addEventListener("resize",Object(p.debounce)(this.handleResize,50)),this.handleResize()}componentWillReceiveProps(e){this.handleResize(e)}componentWillUnmount(){window.removeEventListener("resize",this.resizeEventListener)}render(){return c.a.createElement("div",{ref:this.handleMount},c.a.createElement(e,n()({},this.props,{width:this.state.width,height:this.state.height,overflowX:this.state.overflowX,overflowY:this.state.overflowY,setWithDimensionsRef:this.setWithDimensionsRef})))}},r()(t,"displayName","WithDimensions( ".concat(e.displayName||e.name," )")),r()(t,"propTypes",{domTarget:d.a.object}),s})},"./client/reader/components/reader-popover/index.jsx":function(e,t,s){"use strict";var o=s("./node_modules/@babel/runtime/helpers/extends.js"),n=s.n(o),a=s("./node_modules/react/index.js"),r=s.n(a),i=s("./node_modules/classnames/index.js"),c=s.n(i),l=s("./node_modules/lodash/lodash.js"),d=s("./client/components/popover/index.jsx");s("./client/reader/components/reader-popover/style.scss");t.a=(e=>{const t=c()("reader-popover",e.className),s=Object(l.omit)(e,"className");return r.a.createElement(d.a,n()({className:t},s),r.a.createElement("div",{className:"reader-popover__wrapper"},e.popoverTitle&&r.a.createElement("h3",{className:"reader-popover__header"},e.popoverTitle),e.children))})},"./client/reader/components/reader-popover/style.scss":function(e,t,s){},"./client/reader/discover/stats.js":function(e,t,s){"use strict";s.d(t,"b",function(){return n}),s.d(t,"a",function(){return a});var o=s("./client/reader/stats.js");function n(e){Object(o.recordGaEvent)("Clicked Discover Card Site Link"),Object(o.recordAction)("discover_card_site_clicked"),Object(o.recordTrack)("calypso_reader_site_on_discover_card_clicked",{site_url:e})}function a(e,t){Object(o.recordAction)("discover_card_following_clicked"),e?(Object(o.recordGaEvent)("Clicked Follow Discover Site"),Object(o.recordAction)("discover_card_site_followed"),Object(o.recordTrack)("calypso_reader_discover_site_followed",{site_url:t})):(Object(o.recordGaEvent)("Clicked Unfollow Discover Site"),Object(o.recordAction)("discover_card_site_unfollowed"),Object(o.recordTrack)("calypso_reader_discover_site_unfollowed",{site_url:t}))}},"./client/reader/follow-button/index.jsx":function(e,t,s){"use strict";var o=s("./node_modules/@babel/runtime/helpers/extends.js"),n=s.n(o),a=s("./node_modules/prop-types/index.js"),r=s.n(a),i=s("./node_modules/react/index.js"),c=s.n(i),l=s("./node_modules/@babel/runtime/helpers/defineProperty.js"),d=s.n(l),p=s("./node_modules/lodash/lodash.js"),m=s("./node_modules/react-redux/es/index.js"),u=s("./client/blocks/follow-button/button.jsx"),h=s("./client/state/selectors/is-following.js"),b=s("./client/state/reader/follows/actions.js");class f extends i.Component{constructor(){super(...arguments),d()(this,"handleFollowToggle",e=>{if(e){const e=Object(p.omitBy)({feed_ID:this.props.feedId,blog_ID:this.props.siteId},p.isUndefined);this.props.follow(this.props.siteUrl,e)}else this.props.unfollow(this.props.siteUrl);this.props.onFollowToggle(e)})}render(){return c.a.createElement(u.a,{following:this.props.following,onFollowToggle:this.handleFollowToggle,iconSize:this.props.iconSize,tagName:this.props.tagName,disabled:this.props.disabled,followLabel:this.props.followLabel,followingLabel:this.props.followingLabel,className:this.props.className})}}d()(f,"propTypes",{siteUrl:r.a.string.isRequired,iconSize:r.a.number,onFollowToggle:r.a.func,followLabel:r.a.string,followingLabel:r.a.string,feedId:r.a.number,siteId:r.a.number}),d()(f,"defaultProps",{onFollowToggle:p.noop});var j=Object(m.b)((e,t)=>({following:Object(h.a)(e,{feedUrl:t.siteUrl})}),{follow:b.a,unfollow:b.i})(f),g=s("./client/reader/stats.js");function _(e){const t=e.onFollowToggle,s=e.railcar,o=e.followSource,a=e.isButtonOnly,r=e.siteUrl;function i(e){e?Object(g.recordFollow)(r,s,{follow_source:o}):Object(g.recordUnfollow)(r,s,{follow_source:o}),t&&t(e)}return a?c.a.createElement(u.a,n()({},e,{onFollowToggle:i})):c.a.createElement(j,n()({},e,{onFollowToggle:i}))}_.propTypes={onFollowToggle:r.a.func,railcar:r.a.object,followSource:r.a.string};t.a=_},"./client/reader/follow-sources.jsx":function(e,t,s){"use strict";s.d(t,"c",function(){return o}),s.d(t,"b",function(){return n}),s.d(t,"j",function(){return a}),s.d(t,"k",function(){return r}),s.d(t,"l",function(){return i}),s.d(t,"i",function(){return c}),s.d(t,"f",function(){return l}),s.d(t,"e",function(){return d}),s.d(t,"d",function(){return p}),s.d(t,"g",function(){return m}),s.d(t,"h",function(){return u}),s.d(t,"m",function(){return h}),s.d(t,"a",function(){return b});const o="in-stream-recommendation",n="empty-search-rec",a="search-results",r="search-results-sites",i="search-results-url-input",c="reader-subscriptions",l="reader-following-manage-url-input",d="reader-following-manage-search-result",p="reader-following-manage-recommendation",m="reader-full-post",u="reader-post-options-menu",h="reader-tag-page",b="reader-discover-post"},"./client/reader/get-helpers.js":function(e,t,s){"use strict";var o=s("./node_modules/url/url.js"),n=s.n(o),a=s("./packages/i18n-calypso/dist/esm/index.js"),r=s("./node_modules/lodash/lodash.js"),i=s("./client/lib/formatting/index.js");const c=new Set(["Just another WordPress.com site","Just another WordPress site","This WordPress.com site is the bee's knees","This WordPress site is the bee's knees","A topnotch WordPress.com site","A topnotch WordPress site"]);s.d(t,"e",function(){return l}),s.d(t,"a",function(){return d}),s.d(t,"d",function(){return p}),s.d(t,"c",function(){return m}),s.d(t,"b",function(){return u});const l=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.feed,s=e.site,o=e.post;const n=!!s&&(s.URL||s.domain),a=!!t&&(t.URL||t.feed_URL),r=!!o&&o.site_URL;if(n||a||r)return n||a||r},d=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.feed,s=e.site,o=e.post;const n=!!s&&s.feed_URL,a=!!t&&(t.feed_URL||t.URL),r=!!o&&o.feed_URL;return n||a||r},p=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.feed,s=e.site,o=e.post,r=null;const c=s&&s.name===Object(a.translate)("Site Title")||t&&t.name===Object(a.translate)("Site Title");if(!c&&s&&s.title)r=s.title;else if(!c&&t&&(t.name||t.title))r=t.name||t.title;else if(!c&&o&&o.site_name)r=o.site_name;else if(s&&s.is_error&&t&&t.is_error&&!o)r=Object(a.translate)("Error fetching feed");else if(s&&s.domain)r=s.domain;else{const e=l({feed:t,site:s,post:o});r=e?n.a.parse(e).hostname:null}return Object(i.b)(r)},m=e=>{let t=e.site,s=e.feed;const o=t&&t.description||s&&s.description;return(e=>c.has(e))(o)?null:o},u=e=>{const t=e&&e.owner,s=t&&(t.name||Object(r.trim)("".concat(t.first_name||""," ").concat(t.last_name||"")));return Object(i.b)(s)}},"./client/reader/lib/author-name-blacklist/index.js":function(e,t,s){"use strict";s.d(t,"a",function(){return a});var o=s("./node_modules/lodash/lodash.js");const n=["admin"],a=e=>!!e&&Object(o.includes)(n,e.toLowerCase())},"./client/reader/lib/teams/index.js":function(e,t,s){"use strict";s.d(t,"a",function(){return n});var o=s("./node_modules/lodash/lodash.js");const n=e=>!!Object(o.find)(e,["slug","a8c"])},"./client/reader/like-button/index.jsx":function(e,t,s){"use strict";var o=s("./node_modules/@babel/runtime/helpers/extends.js"),n=s.n(o),a=s("./node_modules/@babel/runtime/helpers/defineProperty.js"),r=s.n(a),i=s("./node_modules/react/index.js"),c=s.n(i),l=s("./node_modules/react-redux/es/index.js"),d=s("./client/lib/redux-bridge/index.js"),p=s("./node_modules/prop-types/index.js"),m=s.n(p),u=s("./node_modules/lodash/lodash.js"),h=s("./client/state/posts/likes/actions.js"),b=s("./client/blocks/like-button/button.jsx");function f(e,t,s){return Object(u.get)(e.posts.likes.items,[t,s,"found"],0)}var j=s("./client/state/selectors/is-liked-post.js"),g=s("./client/components/data/query-post-likes/index.jsx");class _ extends i.Component{constructor(){super(...arguments),r()(this,"handleLikeToggle",e=>{(e?this.props.like:this.props.unlike)(this.props.siteId,this.props.postId,{source:this.props.likeSource}),this.props.onLikeToggle(e)})}render(){const e=Object(u.omit)(this.props,["siteId","postId","likeCount","iLike","like","unlike"]);return c.a.createElement(i.Fragment,null,c.a.createElement(g.a,{siteId:this.props.siteId,postId:this.props.postId}),c.a.createElement(b.a,n()({},e,{likeCount:this.props.likeCount,liked:this.props.iLike,animateLike:!0,onLikeToggle:this.handleLikeToggle})))}}r()(_,"propTypes",{siteId:m.a.number.isRequired,postId:m.a.number.isRequired,showZeroCount:m.a.bool,tagName:m.a.string,onLikeToggle:m.a.func,found:m.a.number,iLike:m.a.bool,likeSource:m.a.string}),r()(_,"defaultProps",{onLikeToggle:u.noop});var y=Object(l.b)((e,t)=>{let s=t.siteId,o=t.postId;return{likeCount:f(e,s,o),iLike:Object(j.a)(e,s,o)}},{like:h.b,unlike:h.f})(_),E=s("./client/blocks/post-likes/popover.jsx"),k=s("./client/state/reader/posts/actions.js"),x=s("./client/reader/stats.js"),O=s("./client/state/reader/posts/selectors.js"),v=s("./client/config/index.js");s("./client/reader/like-button/style.scss");t.a=Object(l.b)((e,t)=>{let s=t.siteId,o=t.postId;return{likeCount:f(e,s,o),iLike:Object(j.a)(e,s,o)}},{markPostSeen:k.b})(class extends c.a.Component{constructor(e){super(e),r()(this,"recordLikeToggle",e=>{const t=this.props.post||Object(O.b)(Object(d.c)(),{blogId:this.props.siteId,postId:this.props.postId});Object(x.recordAction)(e?"liked_post":"unliked_post"),Object(x.recordGaEvent)(e?"Clicked Like Post":"Clicked Unlike Post"),Object(x.recordTrackForPost)(e?"calypso_reader_article_liked":"calypso_reader_article_unliked",t,{context:this.props.fullPost?"full-post":"card"}),!e||this.props.fullPost||t._seen||this.props.markPostSeen(t,this.props.site)}),r()(this,"setLikesPopoverContext",e=>{this.setState({likesPopoverContext:e})}),r()(this,"maybeShowLikesPopover",()=>{Object(v.c)("reader/likes-hover")&&(clearTimeout(this.hidePopoverTimeout),this.setState({showLikesPopover:!0}))}),r()(this,"maybeHideLikesPopover",()=>{Object(v.c)("reader/likes-hover")&&(this.hidePopoverTimeout=setTimeout(()=>{this.setState({showLikesPopover:!1})},200))}),this.hidePopoverTimeout=null,this.state={showLikesPopover:!1,likesPopoverContext:null}}componentWillUnmount(){clearTimeout(this.hidePopoverTimeout)}render(){const e=this.props,t=e.siteId,s=e.postId,o=e.likeCount,a=e.iLike,r=this.state,l=r.showLikesPopover,d=r.likesPopoverContext,p=o>0&&!a||o>1&&a;return c.a.createElement(i.Fragment,null,c.a.createElement(g.a,{siteId:t,postId:s}),c.a.createElement(y,n()({},this.props,{ref:this.setLikesPopoverContext,onMouseEnter:this.maybeShowLikesPopover,onMouseLeave:this.maybeHideLikesPopover,onLikeToggle:this.recordLikeToggle,likeSource:"reader"})),l&&t&&s&&p&&c.a.createElement(E.a,{className:"reader-likes-popover",onMouseEnter:this.maybeShowLikesPopover,onMouseLeave:this.maybeHideLikesPopover,siteId:t,postId:s,showDisplayNames:!0,context:d}))}})},"./client/reader/like-button/style.scss":function(e,t,s){},"./client/reader/like-helper.jsx":function(e,t,s){"use strict";s.d(t,"a",function(){return n});var o=s("./client/reader/discover/helper.js");function n(e){let t=!1;return Object(o.j)(e)?Object(o.l)(e)&&!Object(o.k)(e)&&(t=!0):e&&e.site_ID&&!e.is_external&&(t=!0),t}},"./client/state/data-layer/wpcom/read/feed/index.js":function(e,t,s){"use strict";var o=s("./node_modules/@babel/runtime/helpers/objectSpread.js"),n=s.n(o),a=s("./node_modules/lodash/lodash.js"),r=s("./client/state/reader/feed-searches/actions.js"),i=s("./client/state/data-layer/wpcom-http/actions.js"),c=s("./client/state/data-layer/wpcom-http/utils.js"),l=s("./client/state/notices/actions.js"),d=s("./packages/i18n-calypso/dist/esm/index.js"),p=s("./client/state/reader/feed-searches/query-key.js"),m=s("./client/state/reader/feeds/actions.js"),u=s("./client/state/data-layer/wpcom-http/pipeline/retry-on-failure/policies.js"),h=s("./client/state/data-layer/handler-registry.js");Object(h.b)("state/data-layer/wpcom/read/feed/index.js",{READER_FEED_SEARCH_REQUEST:[Object(c.a)({fetch:function(e){if(!e.payload||!e.payload.query)return;return Object(i.a)({path:"/read/feed",method:"GET",apiVersion:"1.1",query:{q:e.payload.query,offset:e.payload.offset,exclude_followed:e.payload.excludeFollowed,sort:e.payload.sort}},e)},onSuccess:function(e,t){const s=t.feeds,o=t.total;return Object(r.c)(Object(p.a)(e.payload),s,o)},onError:function(e){const t=Object(d.translate)("Could not get results for query: %(query)s",{args:{query:Object(a.truncate)(e.payload.query,{length:50})}});return Object(l.b)(t)},fromApi:function(e){return{feeds:Object(a.map)(e.feeds,e=>n()({},e,{feed_URL:e.subscribe_URL})),total:e.total>200?200:e.total}}})],READER_FEED_REQUEST:[Object(c.a)({fetch:function(e){return Object(i.a)({apiVersion:"1.1",method:"GET",path:"/read/feed/".concat(encodeURIComponent(e.payload.ID)),retryPolicy:Object(u.b)()},e)},onSuccess:function(e,t){return Object(m.b)(t)},onError:function(e,t){return Object(m.a)(e.payload.ID,t)}})]})},"./client/state/reader/feed-searches/actions.js":function(e,t,s){"use strict";s.d(t,"a",function(){return o}),s.d(t,"b",function(){return n}),s.d(t,"d",function(){return a}),s.d(t,"c",function(){return r});s("./client/state/data-layer/wpcom/read/feed/index.js");const o="last_updated",n="relevance",a=e=>{let t=e.query,s=e.offset,o=void 0===s?0:s,a=e.excludeFollowed,r=void 0===a||a,i=e.sort,c=void 0===i?n:i;return{type:"READER_FEED_SEARCH_REQUEST",payload:{query:t.substring(0,500),offset:o,excludeFollowed:r,sort:c}}},r=(e,t,s)=>({type:"READER_FEED_SEARCH_RECEIVE",payload:{feeds:t,total:s},queryKey:e})},"./client/state/reader/feed-searches/query-key.js":function(e,t,s){"use strict";function o(e){const t=e.excludeFollowed?"X":"A";return"".concat(e.query,"-").concat(t,"-").concat(e.sort)}s.d(t,"a",function(){return o})},"./client/state/reader/feeds/actions.js":function(e,t,s){"use strict";s.d(t,"c",function(){return o}),s.d(t,"b",function(){return n}),s.d(t,"a",function(){return a});s("./node_modules/lodash/lodash.js"),s("./client/state/data-layer/wpcom/read/feed/index.js");function o(e){return{type:"READER_FEED_REQUEST",payload:{ID:e}}}function n(e){return{type:"READER_FEED_REQUEST_SUCCESS",payload:e}}function a(e,t){return{type:"READER_FEED_REQUEST_FAILURE",payload:{feed_ID:e},error:t}}},"./client/state/reader/feeds/selectors.js":function(e,t,s){"use strict";s.d(t,"c",function(){return a}),s.d(t,"a",function(){return r}),s.d(t,"b",function(){return i});var o=s("./node_modules/lodash/lodash.js");const n=144e7;function a(e,t){const s=!e.reader.feeds.queuedRequests[t],o=!r(e,t);return s&&(o||function(e,t){const s=e.reader.feeds.lastFetched[t];if(!s)return!0;return s<=Date.now()-n}(e,t))}function r(e,t){return e.reader.feeds.items[t]}function i(e,t){return Object(o.find)(e.reader.feeds.items,{feed_URL:t})}},"./client/state/reader/follows/actions.js":function(e,t,s){"use strict";var o=s("./node_modules/debug/src/browser.js"),n=s.n(o),a=s("./packages/i18n-calypso/dist/esm/index.js"),r=s("./node_modules/lodash/lodash.js"),i=s("./client/state/data-layer/wpcom-http/actions.js"),c=s("./client/state/data-layer/wpcom-http/utils.js"),l=s("./client/state/notices/actions.js");function d(e){const t=typeof e;if("string"===t&&/^\d+$/.test(e)){const t=Number(e);return 0===t?void 0:t}if("number"===t){if(0===e||isNaN(e)||!isFinite(e)||e!==Math.floor(e))return;return e}}const p=e=>{return e&&e.subscriptions&&Object(r.isArray)(e.subscriptions)},m=e=>e&&Object(r.omitBy)({ID:Number(e.ID),URL:e.URL,feed_URL:e.URL,blog_ID:d(e.blog_ID),feed_ID:d(e.feed_ID),date_subscribed:Date.parse(e.date_subscribed),delivery_methods:e.delivery_methods,is_owner:e.is_owner},r.isUndefined);var u=s("./client/state/data-layer/handler-registry.js");const h=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200;return{type:"READER_FOLLOWS_SYNC_PAGE",payload:{page:e,meta:arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",number:t}}};let b=!1,f=null;const j=()=>b;function g(){return b=!1,Object(l.b)(Object(a.translate)("Sorry, we had a problem fetching your Reader subscriptions."))}const _=Object(c.a)({fetch:function(e){const t=e.payload,s=t.page,o=t.number,n=t.meta;return Object(i.a)({method:"GET",path:"/read/following/mine",apiVersion:"1.2",query:{page:s,number:o,meta:n}},e)},onSuccess:(e,t)=>e=>{if(!p(t))return void e(g());const s=t.page,o=t.number,n=(e=>p(e)?Object(r.map)(e.subscriptions,m):[])(t);let a=null;(1===s||o>0)&&(a=t.total_subscriptions),e(U({follows:n,totalCount:a})),Object(r.forEach)(n,e=>f.add(e.feed_URL)),o>0&&s<=10&&j()?e(h(s+1)):(e(F(Array.from(f))),f=null,b=!1)},onError:g});Object(u.b)("state/data-layer/wpcom/read/following/mine/index.js",{READER_FOLLOWS_SYNC_START:[function(e){j()||(b=!0,f=new Set,e.dispatch(h(1)))}],READER_FOLLOWS_SYNC_PAGE:[_],READER_FOLLOW:[function(e,t){f&&f.add(t.payload.feedUrl)}]});var y=s("./client/config/index.js"),E=s("./client/state/reader/feeds/selectors.js"),k=s("./client/state/reader/sites/selectors.js"),x=s("./client/reader/get-helpers.js"),O=s("./client/state/data-layer/utils.js");function v(e,t){const s=[Object(l.b)(Object(a.translate)("Sorry, there was a problem following %(url)s. Please try again.",{args:{url:e.payload.feedUrl}}),{duration:5e3})];return t&&t.info&&s.push(L(e.payload.feedUrl,t.info)),s.push(Object(O.a)(D(e.payload.feedUrl))),s}function C(e){return[Object(l.b)(Object(a.translate)("Sorry, we had a problem unsubscribing. Please try again.")),Object(O.a)(B(e.payload.blogId))]}function w(e){return[Object(l.b)(Object(a.translate)("Sorry, we had a problem subscribing. Please try again.")),Object(O.a)(W(e.payload.blogId))]}function I(e){return[Object(l.b)(Object(a.translate)("Sorry, we had a problem unsubscribing. Please try again.")),Object(O.a)(q(e.payload.blogId))]}function S(e){return Object(r.includes)(["instantly","daily","weekly"],e)?{delivery_frequency:e}:{}}function R(e){return[Object(l.b)(Object(a.translate)("Sorry, we had a problem subscribing. Please try again.")),Object(O.a)(M(e.payload.blogId))]}Object(u.b)("state/data-layer/wpcom/read/following/mine/delete/index.js",{READER_UNFOLLOW:[Object(c.a)({fetch:e=>Object(i.a)({method:"POST",path:"/read/following/mine/delete",apiVersion:"1.1",body:{url:e.payload.feedUrl,source:Object(y.a)("readerFollowingSource")},onSuccess:e,onFailure:e}),onSuccess:e=>Object(O.a)(e),onError:e=>(t,s)=>{const o=e.payload.feedUrl,n=Object(k.b)(s(),o),r=Object(E.b)(s(),o),i=Object(x.d)({feed:r,site:n})||o;t(Object(l.b)(Object(a.translate)("Sorry, there was a problem unfollowing %(siteTitle)s. Please try again.",{args:{siteTitle:i}}),{duration:5e3})),t(Object(O.a)(P(e.payload.feedUrl)))},fromApi:e=>{if(!e)throw new Error("Invalid API response: missing data");if(e.subscribed)throw new Error("Did not unfollow");return e.subscribed}})]}),Object(u.b)("state/data-layer/wpcom/read/following/mine/new/index.js",{READER_FOLLOW:[Object(c.a)({fetch:function(e){const t=Object(r.get)(e,"payload.feedUrl");return Object(i.a)({method:"POST",path:"/read/following/mine/new",apiVersion:"1.1",body:{url:t,source:Object(y.a)("readerFollowingSource")}},e)},onSuccess:function(e,t){if(t&&t.subscribed){const s=m(t.subscription);return Object(O.a)(P(e.payload.feedUrl,s))}return v(e,t)},onError:v})]}),Object(u.b)("state/data-layer/wpcom/read/site/comment-email-subscriptions/delete/index.js",{READER_UNSUBSCRIBE_TO_NEW_COMMENT_EMAIL:[Object(c.a)({fetch:function(e){return Object(i.a)({method:"POST",path:"/read/site/".concat(e.payload.blogId,"/comment_email_subscriptions/delete"),apiVersion:"1.2",body:{}},e)},onSuccess:function(e,t){if(t&&t.subscribed)return C(e)},onError:C})]}),Object(u.b)("state/data-layer/wpcom/read/site/comment-email-subscriptions/new/index.js",{READER_SUBSCRIBE_TO_NEW_COMMENT_EMAIL:[Object(c.a)({fetch:function(e){return Object(i.a)({method:"POST",path:"/read/site/".concat(e.payload.blogId,"/comment_email_subscriptions/new"),body:{},apiVersion:"1.2"},e)},onSuccess:function(e,t){if(!t||!t.subscribed)return w(e)},onError:w})]}),Object(u.b)("state/data-layer/wpcom/read/site/post-email-subscriptions/delete/index.js",{READER_UNSUBSCRIBE_TO_NEW_POST_EMAIL:[Object(c.a)({fetch:function(e){return Object(i.a)({method:"POST",path:"/read/site/".concat(e.payload.blogId,"/post_email_subscriptions/delete"),apiVersion:"1.2",body:{},onSuccess:e,onFailure:e})},onSuccess:function(e,t){if(t&&t.subscribed)return I(e)},onError:I})]}),Object(u.b)("state/data-layer/wpcom/read/site/post-email-subscriptions/new/index.js",{READER_SUBSCRIBE_TO_NEW_POST_EMAIL:[Object(c.a)({fetch:function(e){return Object(i.a)({method:"POST",path:"/read/site/".concat(e.payload.blogId,"/post_email_subscriptions/new"),body:S(Object(r.get)(e,["payload","deliveryFrequency"])),apiVersion:"1.2",onSuccess:e,onFailure:e})},onSuccess:function(e,t){return t&&t.subscribed?Object(O.a)(z(e.payload.blogId,Object(r.get)(t,["subscription","delivery_frequency"]))):R(e)},onError:R})]});var T=(e,t)=>Object(r.find)(e.reader.follows.items,e=>e.blog_ID==t);function N(e){let t=e.payload.blogId,s=e.meta.previousState;return[Object(l.b)(Object(a.translate)("Sorry, we had a problem updating that subscription. Please try again.")),Object(O.a)(z(t,s))]}Object(u.b)("state/data-layer/wpcom/read/site/post-email-subscriptions/update/index.js",{READER_UPDATE_NEW_POST_EMAIL_SUBSCRIPTION:[Object(c.a)({fetch:function(e){return(t,s)=>{const o=Object(r.merge)({},e,{meta:{previousState:Object(r.get)(T(s(),e.payload.blogId),["delivery_methods","email","post_delivery_frequency"])}});t(Object(i.a)({method:"POST",path:"/read/site/".concat(e.payload.blogId,"/post_email_subscriptions/update"),apiVersion:"1.2",body:S(Object(r.get)(e,["payload","deliveryFrequency"]))},o))}},onSuccess:function(e,t){if(!t||!t.success)return N(e)},onError:N})]}),Object(u.b)("state/data-layer/wpcom/read/sites/notification-subscriptions/delete/index.js",{READER_UNSUBSCRIBE_TO_NEW_POST_NOTIFICATIONS:[Object(c.a)({fetch:function(e){return Object(i.a)({method:"POST",apiNamespace:"wpcom/v2",path:"/read/sites/".concat(e.payload.blogId,"/notification-subscriptions/delete"),body:{}},e)},onSuccess:r.noop,onError:function(e){return[Object(l.b)(Object(a.translate)("Sorry, we had a problem unsubscribing you from notifications. Please try again.")),Object(O.a)(V(e.payload.blogId))]},fromApi:function(e){if(!e||!1!==e.subscribed)throw new Error("Unsubscription from new post notifications failed with response: ".concat(JSON.stringify(e)));return e}})]}),Object(u.b)("state/data-layer/wpcom/read/sites/notification-subscriptions/new/index.js",{READER_SUBSCRIBE_TO_NEW_POST_NOTIFICATIONS:[Object(c.a)({fetch:function(e){return Object(i.a)({method:"POST",apiNamespace:"wpcom/v2",path:"/read/sites/".concat(e.payload.blogId,"/notification-subscriptions/new"),body:{}},e)},onSuccess:r.noop,onError:function(e){return[Object(l.b)(Object(a.translate)("Sorry, we had a problem subscribing you to notifications. Please try again.")),Object(O.a)(G(e.payload.blogId))]},fromApi:function(e){if(!e||!e.subscribed)throw new Error("Subscription to new post notifications failed with response: ".concat(JSON.stringify(e)));return e}})]}),s.d(t,"a",function(){return P}),s.d(t,"i",function(){return D}),s.d(t,"c",function(){return L}),s.d(t,"b",function(){return U}),s.d(t,"d",function(){return A}),s.d(t,"h",function(){return F}),s.d(t,"f",function(){return q}),s.d(t,"k",function(){return M}),s.d(t,"m",function(){return z}),s.d(t,"e",function(){return B}),s.d(t,"j",function(){return W}),s.d(t,"g",function(){return V}),s.d(t,"l",function(){return G});n()("calypso:redux:reader-follows");function P(e,t){const s={type:"READER_FOLLOW",payload:{feedUrl:e}};return t&&(s.payload.follow=t),s}function D(e){return{type:"READER_UNFOLLOW",payload:{feedUrl:e}}}function L(e,t){return{type:"READER_FOLLOW_ERROR",payload:{feedUrl:e,error:t}}}function U(e){return{type:"READER_FOLLOWS_RECEIVE",payload:{follows:e.follows,totalCount:e.totalCount}}}function A(){return{type:"READER_FOLLOWS_SYNC_START"}}function F(e){return{type:"READER_FOLLOWS_SYNC_COMPLETE",payload:e}}function q(e){return{type:"READER_SUBSCRIBE_TO_NEW_POST_EMAIL",payload:{blogId:e}}}function M(e){return{type:"READER_UNSUBSCRIBE_TO_NEW_POST_EMAIL",payload:{blogId:e}}}function z(e,t){return{type:"READER_UPDATE_NEW_POST_EMAIL_SUBSCRIPTION",payload:{blogId:e,deliveryFrequency:t}}}function B(e){return{type:"READER_SUBSCRIBE_TO_NEW_COMMENT_EMAIL",payload:{blogId:e}}}function W(e){return{type:"READER_UNSUBSCRIBE_TO_NEW_COMMENT_EMAIL",payload:{blogId:e}}}function V(e){return{type:"READER_SUBSCRIBE_TO_NEW_POST_NOTIFICATIONS",payload:{blogId:e}}}function G(e){return{type:"READER_UNSUBSCRIBE_TO_NEW_POST_NOTIFICATIONS",payload:{blogId:e}}}},"./client/state/reader/site-blocks/actions.js":function(e,t,s){"use strict";var o=s("./packages/i18n-calypso/dist/esm/index.js"),n=s("./client/state/data-layer/wpcom-http/actions.js"),a=s("./client/state/data-layer/wpcom-http/utils.js"),r=s("./client/state/notices/actions.js"),i=s("./client/state/data-layer/utils.js"),c=s("./client/state/data-layer/handler-registry.js");Object(c.b)("state/data-layer/wpcom/me/block/sites/delete/index.js",{READER_SITE_UNBLOCK:[Object(a.a)({fetch:function(e){return Object(n.a)({method:"POST",apiVersion:"1.1",path:"/me/block/sites/".concat(e.payload.siteId,"/delete"),body:{}},e)},onSuccess:function(){return Object(r.d)(Object(o.translate)("The site has been successfully unblocked."),{duration:5e3})},onError:e=>{let t=e.payload.siteId;return e=>{e(Object(r.b)(Object(o.translate)("Sorry, there was a problem unblocking that site."))),e(Object(i.a)(l(t)))}},fromApi:function(e){if(!e.success)throw new Error("Site unblock was unsuccessful",e);return e}})]});Object(c.b)("state/data-layer/wpcom/me/block/sites/new/index.js",{READER_SITE_BLOCK:[Object(a.a)({fetch:function(e){return Object(n.a)({method:"POST",apiVersion:"1.1",path:"/me/block/sites/".concat(e.payload.siteId,"/new"),body:{}},e)},onSuccess:function(){return Object(r.f)(Object(o.translate)("The site has been successfully blocked."),{duration:5e3})},onError:e=>{let t=e.payload.siteId;return e=>{e(Object(r.b)(Object(o.translate)("Sorry, there was a problem blocking that site."))),e(Object(i.a)(d(t)))}},fromApi:function(e){if(!e.success)throw new Error("Site block was unsuccessful",e);return e}})]});function l(e){return{type:"READER_SITE_BLOCK",payload:{siteId:e}}}function d(e){return{type:"READER_SITE_UNBLOCK",payload:{siteId:e}}}function p(){return{type:"READER_SITE_BLOCKS_REQUEST",payload:{page:(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).page}}}Object(c.b)("state/data-layer/wpcom/me/blocks/sites/index.js",{READER_SITE_BLOCKS_REQUEST:[Object(a.a)({fetch:e=>Object(n.a)({apiNamespace:"wpcom/v2",method:"GET",path:"/me/blocks/sites",query:{page:e.payload&&e.payload.page||1,per_page:e.payload&&e.perPage||20}},e),onSuccess:(e,t)=>({type:"READER_SITE_BLOCKS_RECEIVE",payload:t}),onError:e=>({type:"READER_SITE_BLOCKS_RECEIVE",payload:e,error:!0})})]}),s.d(t,"a",function(){return l}),s.d(t,"c",function(){return d}),s.d(t,"b",function(){return p})},"./client/state/selectors/get-active-reply-comment-id.js":function(e,t,s){"use strict";s.d(t,"a",function(){return a});var o=s("./node_modules/lodash/lodash.js"),n=s("./client/state/comments/utils.js");function a(e){let t=e.state,s=e.siteId,a=e.postId;return Object(o.get)(t.comments.activeReplies,Object(n.e)(s,a),null)}},"./client/state/selectors/get-blog-stickers.js":function(e,t,s){"use strict";s.d(t,"a",function(){return n});var o=s("./node_modules/lodash/lodash.js");function n(e,t){return Object(o.get)(e.sites.blogStickers.items,t,null)}},"./client/state/selectors/get-reader-aliased-follow-feed-url.js":function(e,t,s){"use strict";s.d(t,"a",function(){return r});var o=s("./node_modules/lodash/lodash.js"),n=s("./client/state/reader/follows/utils.js");const a=["rss","rss.xml","feed","feed/atom","atom.xml","atom"];function r(e,t){const s=Object(n.a)(t);if(e.reader.follows.items[s])return s;const r=Object(o.find)(e.reader.follows.items,(e,t)=>Object(o.includes)(e.alias_feed_URLs,s)||Object(o.some)(a,e=>"".concat(s,"/").concat(e)===t));return r?r.feed_URL:t}},"./client/state/selectors/get-reader-teams.js":function(e,t,s){"use strict";function o(e){return e.reader.teams.items}s.d(t,"a",function(){return o})},"./client/state/selectors/is-following.js":function(e,t,s){"use strict";s.d(t,"a",function(){return r});var o=s("./node_modules/lodash/lodash.js"),n=s("./client/state/reader/follows/utils.js"),a=s("./client/state/selectors/get-reader-aliased-follow-feed-url.js");function r(e,t){let s,r=t.feedUrl,i=t.feedId,c=t.blogId;if(r){const t=Object(a.a)(e,r);s=e.reader.follows.items[Object(n.a)(t)]}else i?s=Object(o.find)(e.reader.follows.items,{feed_ID:i}):c&&(s=Object(o.find)(e.reader.follows.items,{blog_ID:c}));return!!s&&s.is_following}},"./client/state/selectors/is-liked-post.js":function(e,t,s){"use strict";s.d(t,"a",function(){return n});var o=s("./node_modules/lodash/lodash.js");function n(e,t,s){return Object(o.get)(e.posts.likes.items,[t,s,"iLike"],!1)}},"./client/state/sites/blog-stickers/actions.js":function(e,t,s){"use strict";var o=s("./packages/i18n-calypso/dist/esm/index.js"),n=s("./node_modules/lodash/lodash.js"),a=s("./client/state/data-layer/wpcom-http/actions.js"),r=s("./client/state/data-layer/wpcom-http/utils.js"),i=s("./client/state/notices/actions.js"),c=s("./client/state/data-layer/handler-registry.js");const l=()=>Object(i.b)(Object(o.translate)("Sorry, we had a problem retrieving blog stickers. Please try again."));Object(c.b)("state/data-layer/wpcom/sites/blog-stickers/index.js",{SITES_BLOG_STICKER_LIST:[Object(r.a)({fetch:e=>Object(a.a)({method:"GET",path:"/sites/".concat(e.payload.blogId,"/blog-stickers"),body:{},apiVersion:"1.1"},e),onSuccess:(e,t)=>t&&Object(n.isArray)(t)?f(e.payload.blogId,t):l(),onError:l})]});var d=s("./node_modules/react/index.js"),p=s.n(d),m=s("./client/state/data-layer/utils.js");Object(c.b)("state/data-layer/wpcom/sites/blog-stickers/add/index.js",{SITES_BLOG_STICKER_ADD:[Object(r.a)({fetch:e=>Object(a.a)({method:"POST",path:"/sites/".concat(e.payload.blogId,"/blog-stickers/add/").concat(e.payload.stickerName),body:{},apiVersion:"1.1"},e),onSuccess:e=>Object(i.f)(Object(o.translate)("The sticker {{i}}%s{{/i}} has been successfully added.",{args:e.payload.stickerName,components:{i:p.a.createElement("i",null)}}),{duration:5e3}),onError:e=>[Object(i.b)(Object(o.translate)("Sorry, we had a problem adding that sticker. Please try again.")),Object(m.a)(h(e.payload.blogId,e.payload.stickerName))],fromApi:function(e){if(!e.success)throw new Error("Adding blog sticker was unsuccessful",e);return e}})]});function u(e,t){return{type:"SITES_BLOG_STICKER_ADD",payload:{blogId:e,stickerName:t}}}function h(e,t){return{type:"SITES_BLOG_STICKER_REMOVE",payload:{blogId:e,stickerName:t}}}function b(e){return{type:"SITES_BLOG_STICKER_LIST",payload:{blogId:e}}}function f(e,t){return{type:"SITES_BLOG_STICKER_LIST_RECEIVE",payload:{blogId:e,stickers:t}}}Object(c.b)("state/data-layer/wpcom/sites/blog-stickers/remove/index.js",{SITES_BLOG_STICKER_REMOVE:[Object(r.a)({fetch:e=>Object(a.a)({method:"POST",path:"/sites/".concat(e.payload.blogId,"/blog-stickers/remove/").concat(e.payload.stickerName),body:{},apiVersion:"1.1"},e),onSuccess:e=>Object(i.d)(Object(o.translate)("The sticker {{i}}%s{{/i}} has been removed.",{args:e.payload.stickerName,components:{i:p.a.createElement("i",null)}}),{duration:5e3}),onError:e=>[Object(i.b)(Object(o.translate)("Sorry, we had a problem removing that sticker. Please try again.")),Object(m.a)(u(e.payload.blogId,e.payload.stickerName))],fromApi:e=>{if(!e.success)throw new Error("Blog sticker removal was unsuccessful on the server");return e}})]}),s.d(t,"a",function(){return u}),s.d(t,"d",function(){return h}),s.d(t,"b",function(){return b}),s.d(t,"c",function(){return f})},"./client/state/ui/reader/card-expansions/actions.js":function(e,t,s){"use strict";s.d(t,"a",function(){return i}),s.d(t,"b",function(){return c});var o=s("./client/state/reader/posts/actions.js"),n=s("./client/lib/redux-bridge/index.js"),a=s("./client/state/reader/posts/display-types.js"),r=s("./client/reader/stats.js");const i=e=>{let t=e.postKey,s=e.post,i=e.site;return s.display_type&a.a.PHOTO_ONLY?r.recordTrackForPost("calypso_reader_photo_expanded",s):s.display_type&a.a.FEATURED_VIDEO&&r.recordTrackForPost("calypso_reader_video_expanded",s),r.recordTrackForPost("calypso_reader_article_opened",s),Object(n.b)(Object(o.b)(s,i)),{type:"READER_EXPAND_CARD",payload:{postKey:t}}},c=()=>({type:"READER_RESET_CARD_EXPANSIONS"})},"./client/state/users/suggestions/selectors.js":function(e,t,s){"use strict";s.d(t,"b",function(){return n}),s.d(t,"a",function(){return a});var o=s("./node_modules/lodash/lodash.js");function n(e,t){return Object(o.get)(e.users.suggestions.requesting,[t],!1)}function a(e,t){return Object(o.get)(e.users.suggestions.items,[t],[])}}}]);