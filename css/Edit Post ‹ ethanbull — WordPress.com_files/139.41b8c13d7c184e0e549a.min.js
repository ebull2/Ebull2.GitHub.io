(window.webpackJsonp=window.webpackJsonp||[]).push([[139],{"./client/components/token-field/index.jsx":function(e,t,s){"use strict";var n=s("./node_modules/@babel/runtime/helpers/objectSpread.js"),o=s.n(n),i=s("./node_modules/@babel/runtime/helpers/defineProperty.js"),a=s.n(i),r=s("./node_modules/react/index.js"),l=s.n(r),u=s("./node_modules/prop-types/index.js"),c=s.n(u),d=s("./node_modules/lodash/lodash.js"),p=s("./node_modules/classnames/index.js"),h=s.n(p),g=s("./node_modules/debug/src/browser.js"),m=s.n(g),f=s("./node_modules/dom-scroll-into-view/lib/index.js"),_=s.n(f);class k extends l.a.PureComponent{constructor(){super(...arguments),a()(this,"_computeSuggestionMatch",e=>{let t,s=this.props.displayTransform(this.props.match||"").toLocaleLowerCase();return 0===s.length?null:(t=(e=this.props.displayTransform(e)).toLocaleLowerCase().indexOf(s),{suggestionBeforeMatch:e.substring(0,t),suggestionMatch:e.substring(t,t+s.length),suggestionAfterMatch:e.substring(t+s.length)})}),a()(this,"_renderSuggestions",()=>Object(d.map)(this.props.suggestions,function(e,t){let s=this._computeSuggestionMatch(e),n=h()("token-field__suggestion",{"is-selected":t===this.props.selectedIndex});return l.a.createElement("li",{className:n,key:e,onMouseDown:this._handleMouseDown,onClick:this._handleClick(e),onMouseEnter:this._handleHover(e)},s?l.a.createElement("span",null,s.suggestionBeforeMatch,l.a.createElement("strong",{className:"token-field__suggestion-match"},s.suggestionMatch),s.suggestionAfterMatch):this.props.displayTransform(e))}.bind(this))),a()(this,"_handleHover",e=>(function(){this._scrollingIntoView||this.props.onHover(e)}).bind(this)),a()(this,"_handleClick",e=>(function(){this.props.onSelect(e)}).bind(this)),a()(this,"_handleMouseDown",e=>{e.preventDefault()})}componentDidUpdate(e){let t;e.isExpanded&&this.props.isExpanded&&this.props.selectedIndex>-1&&this.props.scrollIntoView&&(this._scrollingIntoView=!0,t=this.refs.list,_()(t.children[this.props.selectedIndex],t,{onlyScrollIfNeeded:!0}),setTimeout(function(){this._scrollingIntoView=!1}.bind(this),100))}render(){const e=h()("token-field__suggestions-list",{"is-expanded":this.props.isExpanded&&this.props.suggestions.length>0});return l.a.createElement("ul",{ref:"list",className:e,tabIndex:"-1"},this._renderSuggestions())}}a()(k,"propTypes",{isExpanded:c.a.bool,match:c.a.string,displayTransform:c.a.func.isRequired,onSelect:c.a.func,suggestions:c.a.array,selectedIndex:c.a.number}),a()(k,"defaultProps",{isExpanded:!1,match:"",onHover:function(){},onSelect:function(){},suggestions:Object.freeze([])});var b=k,v=s("./client/components/gridicon/index.jsx"),T=s("./client/components/tooltip/index.jsx");class x extends l.a.PureComponent{constructor(){super(...arguments),a()(this,"_onClickRemove",()=>{this.props.onClickRemove({value:this.props.value})})}render(){const e=this.props,t=e.value,s=e.status,n=e.isBorderless,o=e.tooltip,i=e.displayTransform,a=h()("token-field__token",{"is-error":"error"===s,"is-success":"success"===s,"is-validating":"validating"===s,"is-borderless":n,"is-disabled":this.props.disabled});return l.a.createElement("span",{className:a,tabIndex:"-1",onMouseEnter:this.props.onMouseEnter,onMouseLeave:this.props.onMouseLeave},l.a.createElement("span",{className:"token-field__token-text"},i(t)),l.a.createElement(v.a,{icon:"cross-small",size:24,className:"token-field__remove-token",onClick:this.props.disabled?null:this._onClickRemove}),o&&l.a.createElement(T.a,{showOnMobile:!0,context:this,status:s,isVisible:!0,position:"bottom"},o))}}a()(x,"displayName","Token"),a()(x,"propTypes",{value:c.a.string.isRequired,displayTransform:c.a.func.isRequired,onClickRemove:c.a.func,status:c.a.oneOf(["error","success","validating"]),isBorderless:c.a.bool,tooltip:c.a.string,disabled:c.a.bool}),a()(x,"defaultProps",{onClickRemove:()=>{},isBorderless:!1,disabled:!1});var S=s("./node_modules/@babel/runtime/helpers/extends.js"),I=s.n(S);class y extends l.a.PureComponent{constructor(){super(...arguments),a()(this,"setTextInput",e=>{this.textInput=e}),a()(this,"onChange",e=>{this.props.onChange({value:e.target.value})})}componentDidUpdate(){this.props.hasFocus&&this.textInput.focus()}render(){const e=this.props,t=e.placeholder,s=e.value,n=(0===s.length&&t&&t.length||s.length)+1;return l.a.createElement("input",I()({className:"token-field__input",onChange:this.onChange,ref:this.setTextInput,size:n,type:"text"},Object(d.omit)(this.props,["hasFocus","onChange"])))}}a()(y,"propTypes",{disabled:c.a.bool,hasFocus:c.a.bool,onChange:c.a.func,onBlur:c.a.func,placeholder:c.a.string,value:c.a.string}),a()(y,"defaultProps",{disabled:!1,hasFocus:!1,onChange:d.noop,onBlur:d.noop,placeholder:"",value:""});var w=y;s("./client/components/token-field/style.scss");const C=m()("calypso:token-field");class j extends r.PureComponent{constructor(){super(...arguments),a()(this,"state",this.constructor.initialState),a()(this,"_renderTokensAndInput",()=>{const e=Object(d.map)(this.props.value,this._renderToken);return e.splice(this._getIndexOfInput(),0,this._renderInput()),e}),a()(this,"_renderToken",e=>{const t=this._getTokenValue(e),s=e.status?e.status:void 0;return l.a.createElement(x,{key:"token-"+t,value:t,status:s,tooltip:e.tooltip,displayTransform:this.props.displayTransform,onClickRemove:this._onTokenClickRemove,isBorderless:e.isBorderless||this.props.isBorderless,onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave,disabled:"error"!==s&&this.props.disabled})}),a()(this,"_renderInput",()=>{const e=this.props,t=e.autoCapitalize,s=e.autoComplete,n=e.autoCorrect,i=e.id,a=e.maxLength,r=e.placeholder,u=e.spellCheck,c=e.value;let d={autoCapitalize:t,autoComplete:s,autoCorrect:n,disabled:this.props.disabled,hasFocus:this.state.tokenInputHasFocus,id:i,key:"input",onBlur:this._onBlur,spellCheck:u,value:this.state.incompleteTokenValue};return 0===c.length&&r&&(d.placeholder=r),a&&c.length>=a||(d=o()({},d,{onChange:this._onInputChange})),l.a.createElement(w,d)}),a()(this,"setTokensAndInput",e=>{this.tokensAndInput=e}),a()(this,"_onFocus",e=>{this.setState({isActive:!0,tokenInputHasFocus:!0}),"function"==typeof this.props.onFocus&&this.props.onFocus(e)}),a()(this,"_onBlur",()=>{this._inputHasValidValue()?(C("_onBlur adding current token"),this.setState({isActive:!1},this._addCurrentToken)):(C("_onBlur not adding current token"),this.setState(this.constructor.initialState))}),a()(this,"_onTokenClickRemove",e=>{this._deleteToken(e.value)}),a()(this,"_onSuggestionHovered",e=>{const t=this._getMatchingSuggestions().indexOf(e);t>=0&&this.setState({selectedSuggestionIndex:t,selectedSuggestionScroll:!1})}),a()(this,"_onSuggestionSelected",e=>{C("_onSuggestionSelected",e),this._addNewToken(e)}),a()(this,"_onInputChange",e=>{const t=e.value,s=this.props.tokenizeOnSpace?/[ ,\t]+/:/[,\t]+/,n=t.split(s);n.length>1&&this._addNewTokens(n.slice(0,-1)),this.setState({incompleteTokenValue:Object(d.last)(n)||"",selectedSuggestionIndex:-1,selectedSuggestionScroll:!1})}),a()(this,"_onContainerTouched",e=>{e.target===this.tokensAndInput&&this.state.isActive&&e.preventDefault()}),a()(this,"_onKeyDown",e=>{let t=!1;switch(e.keyCode){case 8:t=this._handleDeleteKey(this._deleteTokenBeforeInput);break;case 9:case 13:t=this._addCurrentToken();break;case 37:t=this._handleLeftArrowKey();break;case 38:t=this._handleUpArrowKey();break;case 39:t=this._handleRightArrowKey();break;case 40:t=this._handleDownArrowKey();break;case 46:t=this._handleDeleteKey(this._deleteTokenAfterInput);break;case 32:this.props.tokenizeOnSpace&&(t=this._addCurrentToken())}t&&e.preventDefault()}),a()(this,"_onKeyPress",e=>{let t=!1;switch(e.charCode){case 44:t=this._handleCommaKey()}t&&e.preventDefault()}),a()(this,"_handleDeleteKey",e=>{let t=!1;return this.state.tokenInputHasFocus&&this._isInputEmpty()&&(e(),t=!0),t}),a()(this,"_getMatchingSuggestions",()=>{let e=this.props.suggestions,t=this.props.saveTransform(this.state.incompleteTokenValue),s=[],n=[];return 0===t.length?e=Object(d.difference)(e,this.props.value):(t=t.toLocaleLowerCase(),Object(d.each)(e,function(e){const o=e.toLocaleLowerCase().indexOf(t);-1===this.props.value.indexOf(e)&&(0===o?s.push(e):o>0&&n.push(e))}.bind(this)),e=s.concat(n)),Object(d.take)(e,this.props.maxSuggestions)}),a()(this,"_getSelectedSuggestion",()=>{if(-1!==this.state.selectedSuggestionIndex)return this._getMatchingSuggestions()[this.state.selectedSuggestionIndex]}),a()(this,"_addCurrentToken",()=>{let e=!1,t=this._getSelectedSuggestion();return t?(this._addNewToken(t),e=!0):this._inputHasValidValue()&&(this._addNewToken(this.state.incompleteTokenValue),e=!0),e}),a()(this,"_handleLeftArrowKey",()=>{let e=!1;return this._isInputEmpty()&&(this._moveInputBeforePreviousToken(),e=!0),e}),a()(this,"_handleRightArrowKey",()=>{let e=!1;return this._isInputEmpty()&&(this._moveInputAfterNextToken(),e=!0),e}),a()(this,"_handleUpArrowKey",()=>(this.setState({selectedSuggestionIndex:Math.max((this.state.selectedSuggestionIndex||0)-1,0),selectedSuggestionScroll:!0}),!0)),a()(this,"_handleDownArrowKey",()=>(this.setState({selectedSuggestionIndex:Math.min(this.state.selectedSuggestionIndex+1||0,this._getMatchingSuggestions().length-1),selectedSuggestionScroll:!0}),!0)),a()(this,"_handleCommaKey",()=>{return this._inputHasValidValue()&&this._addNewToken(this.state.incompleteTokenValue),!0}),a()(this,"_isInputEmpty",()=>0===this.state.incompleteTokenValue.length),a()(this,"_inputHasValidValue",()=>this.props.saveTransform(this.state.incompleteTokenValue).length>0),a()(this,"_deleteTokenBeforeInput",()=>{const e=this._getIndexOfInput()-1;e>-1&&this._deleteToken(this.props.value[e])}),a()(this,"_deleteTokenAfterInput",()=>{const e=this._getIndexOfInput();e<this.props.value.length&&(this._deleteToken(this.props.value[e]),this._moveInputToIndex(e))}),a()(this,"_deleteToken",e=>{const t=this.props.value.filter(t=>this._getTokenValue(t)!==this._getTokenValue(e));this.props.onChange(t)}),a()(this,"_moveInputToIndex",e=>{this.setState({inputOffsetFromEnd:this.props.value.length-Math.max(e,-1)-1})}),a()(this,"_moveInputBeforePreviousToken",()=>{this.setState({inputOffsetFromEnd:Math.min(this.state.inputOffsetFromEnd+1,this.props.value.length)})}),a()(this,"_moveInputAfterNextToken",()=>{this.setState({inputOffsetFromEnd:Math.max(this.state.inputOffsetFromEnd-1,0)})}),a()(this,"_addNewTokens",e=>{const t=Object(d.uniq)(e.map(this.props.saveTransform).filter(Boolean).filter(e=>!this._valueContainsToken(e)));if(C("_addNewTokens: tokensToAdd",t),t.length>0){const e=Object(d.clone)(this.props.value);e.splice.apply(e,[this._getIndexOfInput(),0].concat(t)),C("_addNewTokens: onChange",e),this.props.onChange(e)}}),a()(this,"_addNewToken",e=>{this._addNewTokens([e]),this.setState({incompleteTokenValue:"",selectedSuggestionIndex:-1,selectedSuggestionScroll:!1}),this.state.isActive&&(C("_addNewToken focusing input"),this.setState({tokenInputHasFocus:!0}))}),a()(this,"_valueContainsToken",e=>Object(d.some)(this.props.value,t=>this._getTokenValue(e)===this._getTokenValue(t))),a()(this,"_getTokenValue",e=>"object"==typeof e?e.value:e),a()(this,"_getIndexOfInput",()=>this.props.value.length-this.state.inputOffsetFromEnd)}componentWillReceiveProps(e){e.disabled&&this.state.isActive&&this.setState({isActive:!1,incompleteTokenValue:""})}render(){let e={ref:"main",className:h()("token-field",{"is-active":this.state.isActive,"is-disabled":this.props.disabled}),tabIndex:"-1"};return this.props.disabled||(e=Object.assign({},e,{onKeyDown:this._onKeyDown,onKeyPress:this._onKeyPress,onFocus:this._onFocus})),l.a.createElement("div",e,l.a.createElement("div",{ref:this.setTokensAndInput,className:"token-field__input-container",tabIndex:"-1",onMouseDown:this._onContainerTouched,onTouchStart:this._onContainerTouched},this._renderTokensAndInput()),l.a.createElement(b,{match:this.props.saveTransform(this.state.incompleteTokenValue),displayTransform:this.props.displayTransform,suggestions:this._getMatchingSuggestions(),selectedIndex:this.state.selectedSuggestionIndex,scrollIntoView:this.state.selectedSuggestionScroll,isExpanded:this.props.isExpanded||this.state.isActive,onHover:this._onSuggestionHovered,onSelect:this._onSuggestionSelected}))}}a()(j,"propTypes",{suggestions:c.a.array,maxSuggestions:c.a.number,displayTransform:c.a.func,saveTransform:c.a.func,onChange:c.a.func,isBorderless:c.a.bool,maxLength:c.a.number,onFocus:c.a.func,disabled:c.a.bool,tokenizeOnSpace:c.a.bool,placeholder:c.a.string,id:c.a.string,isExpanded:c.a.bool,value:function(e){const t=e.value;if(!Array.isArray(t))return new Error("Value prop is expected to be an array.");Object(d.forEach)(t,e=>{if("object"==typeof e&&!("value"in e))return new Error("When using object for value prop, each object is expected to have a 'value' property.")})}}),a()(j,"defaultProps",{suggestions:Object.freeze([]),maxSuggestions:100,value:Object.freeze([]),placeholder:"",displayTransform:d.identity,saveTransform:function(e){return e.trim()},onChange:function(){},isBorderless:!1,disabled:!1,tokenizeOnSpace:!1,isExpanded:!1}),a()(j,"initialState",{incompleteTokenValue:"",inputOffsetFromEnd:0,isActive:!1,selectedSuggestionIndex:-1,selectedSuggestionScroll:!1,tokenInputHasFocus:!1});t.a=j},"./client/components/token-field/style.scss":function(e,t,s){},"./client/components/tooltip/index.jsx":function(e,t,s){"use strict";var n=s("./node_modules/react/index.js"),o=s.n(n),i=s("./node_modules/prop-types/index.js"),a=s.n(i),r=s("./node_modules/classnames/index.js"),l=s.n(r),u=s("./client/components/popover/index.jsx"),c=s("./client/lib/viewport/react.js");function d(e){const t=Object(c.a)();if(!e.showOnMobile&&t)return null;const s=l()("popover","tooltip","is-".concat(e.status),"is-".concat(e.position),e.className);return o.a.createElement(u.a,{autoPosition:e.autoPosition,className:s,rootClassName:e.rootClassName,context:e.context,id:e.id,isVisible:e.isVisible,position:e.position,showDelay:e.showDelay},e.children)}d.propTypes={autoPosition:a.a.bool,className:a.a.string,id:a.a.string,isVisible:a.a.bool,position:a.a.string,rootClassName:a.a.string,status:a.a.string,showDelay:a.a.number,showOnMobile:a.a.bool},d.defaultProps={showDelay:100,position:"top",showOnMobile:!1},t.a=d},"./client/lib/viewport/react.js":function(e,t,s){"use strict";s.d(t,"a",function(){return p}),s.d(t,"c",function(){return h}),s.d(t,"b",function(){return g});var n=s("./node_modules/@babel/runtime/helpers/extends.js"),o=s.n(n),i=s("./node_modules/@babel/runtime/helpers/slicedToArray.js"),a=s.n(i),r=s("./node_modules/react/index.js"),l=s.n(r),u=s("./node_modules/@wordpress/compose/build-module/index.js"),c=s("./client/lib/viewport/index.js");function d(e){const t=Object(r.useState)(()=>({isActive:Object(c.f)(e),breakpoint:e})),s=a()(t,2),n=s[0],o=s[1];return Object(r.useEffect)(()=>{return Object(c.g)(e,function(t){o(s=>s.isActive===t&&s.breakpoint===e?s:{isActive:t,breakpoint:e})})},[e]),e===n.breakpoint?n.isActive:Object(c.f)(e)}function p(){return d(c.b)}const h=Object(u.a)(e=>Object(r.forwardRef)((t,s)=>{const n=d(c.b);return l.a.createElement(e,o()({},t,{isBreakpointActive:n,ref:s}))}),"WithMobileBreakpoint"),g=Object(u.a)(e=>Object(r.forwardRef)((t,s)=>{const n=d(c.a);return l.a.createElement(e,o()({},t,{isBreakpointActive:n,ref:s}))}),"WithDesktopBreakpoint")}}]);