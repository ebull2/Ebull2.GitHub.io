(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{"./client/blocks/plan-storage/bar.jsx":function(e,t,s){"use strict";var i=s("./node_modules/@babel/runtime/helpers/defineProperty.js"),o=s.n(i),n=s("./node_modules/prop-types/index.js"),r=s.n(n),a=s("./node_modules/react/index.js"),l=s.n(a),c=s("./packages/i18n-calypso/dist/esm/index.js"),d=s("./node_modules/classnames/index.js"),p=s.n(d),u=s("./node_modules/filesize/lib/filesize.js"),h=s.n(u),m=s("./client/components/progress-bar/index.jsx"),g=s("./client/lib/plans/index.js"),b=s("./client/lib/plans/constants.js");const f=80,j=60;class y extends a.Component{render(){const e=this.props,t=e.className,s=e.mediaStorage,i=e.sitePlanSlug,o=e.siteSlug,n=e.translate;if(Object(g.z)(i,b.Jb))return null;if(!s||-1===s.max_storage_bytes)return null;const r=Math.min(Math.round(s.storage_used_bytes/s.max_storage_bytes*1e3)/10,100),a=p()(t,"plan-storage__bar",{"is-alert":r>f,"is-warn":r>j&&r<=f}),c=h()(s.max_storage_bytes);return l.a.createElement("div",{className:a},l.a.createElement(m.a,{value:r,total:100,compact:!0}),l.a.createElement("span",{className:"plan-storage__storage-label"},n("%(percent)f%% of %(max)s used",{args:{percent:r,max:c}})),l.a.createElement("a",{className:"plan-storage__storage-link",href:"/plans/".concat(o)},n("Upgrade")),this.props.children)}}o()(y,"propTypes",{className:r.a.string,mediaStorage:r.a.object,siteSlug:r.a.string.isRequired,sitePlanSlug:r.a.string.isRequired}),o()(y,"defaultProps",{siteSlug:""}),t.a=Object(c.localize)(y)},"./client/blocks/plan-storage/index.jsx":function(e,t,s){"use strict";var i=s("./node_modules/@babel/runtime/helpers/defineProperty.js"),o=s.n(i),n=s("./node_modules/classnames/index.js"),r=s.n(n),a=s("./node_modules/prop-types/index.js"),l=s.n(a),c=s("./node_modules/react/index.js"),d=s.n(c),p=s("./node_modules/react-redux/es/index.js"),u=s("./client/components/data/query-media-storage/index.jsx"),h=s("./client/state/sites/media-storage/selectors.js"),m=s("./client/state/sites/selectors.js"),g=s("./client/lib/plans/index.js"),b=s("./client/lib/plans/constants.js"),f=s("./client/blocks/plan-storage/bar.jsx");s("./client/blocks/plan-storage/style.scss");class j extends c.Component{render(){const e=this.props,t=e.className,s=e.jetpackSite,i=e.siteId,o=e.sitePlanSlug,n=e.siteSlug;return s||!o?null:Object(g.z)(o,b.Jb)?null:d.a.createElement("div",{className:r()(t,"plan-storage")},d.a.createElement(u.a,{siteId:i}),d.a.createElement(f.a,{siteSlug:n,sitePlanSlug:o,mediaStorage:this.props.mediaStorage},this.props.children))}}o()(j,"propTypes",{className:l.a.string,mediaStorage:l.a.object,siteId:l.a.number,sitePlanSlug:l.a.string,siteSlug:l.a.string}),t.a=Object(p.b)((e,t)=>{const s=t.siteId;return{mediaStorage:Object(h.a)(e,s),jetpackSite:Object(m.J)(e,s),sitePlanSlug:Object(m.t)(e,s),siteSlug:Object(m.v)(e,s)}})(j)},"./client/blocks/plan-storage/style.scss":function(e,t,s){},"./client/blocks/video-editor/index.jsx":function(e,t,s){"use strict";var i=s("./node_modules/@babel/runtime/helpers/defineProperty.js"),o=s.n(i),n=s("./node_modules/prop-types/index.js"),r=s.n(n),a=s("./node_modules/react/index.js"),l=s.n(a),c=s("./node_modules/react-redux/es/index.js"),d=s("./node_modules/lodash/lodash.js"),p=s("./packages/i18n-calypso/dist/esm/index.js"),u=s("./node_modules/classnames/index.js"),h=s.n(u),m=s("./client/components/progress-bar/index.jsx"),g=s("./client/components/notice/index.jsx"),b=s("./client/post-editor/media-modal/detail/detail-preview-video.jsx"),f=s("./client/components/button/index.jsx"),j=s("./client/components/file-picker/index.jsx");class y extends a.Component{constructor(){super(...arguments),o()(this,"uploadImage",e=>{const t=e[0];t&&this.props.onUploadImage(t)})}render(){const e=this.props,t=e.children,s=e.isPosterUpdating,i=e.onClick;return l.a.createElement("form",{className:"video-editor__upload-form"},l.a.createElement(j.a,{accept:"image/*",onPick:this.uploadImage},l.a.createElement(f.a,{className:"video-editor__controls-button",disabled:s,onClick:i},t)))}}o()(y,"propTypes",{isPosterUpdating:r.a.bool,onClick:r.a.func,onUploadImage:r.a.func}),o()(y,"defaultProps",{isPosterUpdating:!1,onClick:d.noop,onUploadImage:d.noop});var x=y;const v=e=>{let t=e.isPosterUpdating,s=e.isVideoLoading,i=e.onCancel,o=e.onSelectFrame,n=e.onUploadImage,r=e.onUploadImageClick,a=e.translate;return l.a.createElement("div",{className:"video-editor__controls"},i&&l.a.createElement(f.a,{className:"video-editor__controls-button",disabled:t,onClick:i},a("Cancel")),l.a.createElement(x,{isPosterUpdating:t,onClick:r,onUploadImage:n},a("Upload Image")),l.a.createElement(f.a,{className:"video-editor__controls-button",disabled:s||t,onClick:o,primary:!0},a("Select Frame")))};v.propTypes={isPosterUpdating:r.a.bool,isVideoLoading:r.a.bool,onCancel:r.a.func,onSelectFrame:r.a.func,onUploadImage:r.a.func,onUploadImageClick:r.a.func},v.defaultProps={isPosterUpdating:!1,isVideoLoading:!0,onSelectFrame:d.noop,onUploadImage:d.noop,onUploadImageClick:d.noop};var E=Object(p.localize)(v),_=s("./client/state/data-layer/wpcom-http/actions.js"),I=s("./client/state/data-layer/wpcom-http/utils.js"),S=s("./client/state/data-layer/handler-registry.js");const O=Object(I.a)({fetch:e=>{if(!("file"in e.params||"atTime"in e.params))return;const t=e.params,s=t.atTime,i=t.file,o=Object.assign({apiVersion:"1.1",method:"POST",path:"/videos/".concat(e.videoId,"/poster")},i&&{formData:[["poster",i]]},void 0!==s&&{body:{at_time:s}});return Object(_.a)(o,e)},onSuccess:(e,t)=>{let s=t.poster;return C(s)},onError:()=>P(),onProgress:(e,t)=>{const s="loaded"in t&&"total"in t?Math.min(Math.round(t.loaded/(Number.EPSILON+t.total)*100),100):0;return w(s)}});Object(S.b)("state/data-layer/wpcom/videos/poster/index.js",{VIDEO_EDITOR_UPDATE_POSTER:[O]});const C=e=>({type:"VIDEO_EDITOR_SET_POSTER_URL",posterUrl:e}),P=()=>({type:"VIDEO_EDITOR_SHOW_ERROR"}),w=e=>({type:"VIDEO_EDITOR_SHOW_UPLOAD_PROGRESS",percentage:e});function R(e){return e.ui.editor.videoEditor.uploadProgress}function k(e){return e.ui.editor.videoEditor.url}function N(e){return e.ui.editor.videoEditor.showError}class T extends a.Component{constructor(){super(...arguments),o()(this,"state",{error:!1,isLoading:!0,isSelectingFrame:!1,pauseVideo:!1}),o()(this,"selectFrame",()=>{this.state.isLoading?this.setState({error:!0}):this.setState({error:!1,isSelectingFrame:!0,pauseVideo:!0})}),o()(this,"updatePoster",e=>{if(!this.state.isSelectingFrame)return;const t=this.props.media,s=Object(d.get)(t,"videopress_guid",null);s&&this.props.updatePoster(s,{atTime:e})}),o()(this,"setError",()=>{this.setState({error:!0})}),o()(this,"setIsLoading",()=>{this.setState({isLoading:!1})}),o()(this,"pauseVideo",()=>{this.setState({error:!1,isSelectingFrame:!1,pauseVideo:!0})}),o()(this,"uploadImage",e=>{if(!e)return;const t=this.props.media,s=Object(d.get)(t,"videopress_guid",null);s&&this.props.updatePoster(s,{file:e})})}componentWillReceiveProps(e){!e.shouldShowError||this.props.shouldShowError?this.props.posterUrl!==e.posterUrl&&this.props.onUpdatePoster(this.getVideoEditorProps(e.posterUrl)):this.setState({error:!0,pauseVideo:!1})}getVideoEditorProps(e){const t=this.props.media,s={posterUrl:e};return t&&t.ID&&(s.ID=t.ID),s}renderError(){const e=this.props,t=e.onCancel,s=e.translate;return l.a.createElement(g.b,{status:"is-error",showDismiss:!0,text:s("We are unable to edit this video."),isCompact:!1,onDismissClick:t})}render(){const e=this.props,t=e.className,s=e.media,i=e.onCancel,o=e.uploadProgress,n=e.translate,r=this.state,a=r.error,c=r.isLoading,d=r.isSelectingFrame,p=r.pauseVideo,u=h()("video-editor",t);return l.a.createElement("div",{className:u},a&&this.renderError(),l.a.createElement("figure",null,l.a.createElement("div",{className:"video-editor__content"},l.a.createElement("div",{className:"video-editor__preview-wrapper"},l.a.createElement(b.a,{className:"video-editor__preview",isPlaying:!p,item:s,onPause:this.updatePoster,onScriptLoadError:this.setError,onVideoLoaded:this.setIsLoading})),o&&!a&&!d&&l.a.createElement(m.a,{className:"video-editor__progress-bar",isPulsing:!0,total:100,value:o}),l.a.createElement("span",{className:"video-editor__text"},n("Select a frame to use as the thumbnail image or upload your own.")),l.a.createElement(E,{isPosterUpdating:o&&!a,isVideoLoading:c,onCancel:i,onSelectFrame:this.selectFrame,onUploadImage:this.uploadImage,onUploadImageClick:this.pauseVideo}))))}}o()(T,"propTypes",{className:r.a.string,media:r.a.object.isRequired,onCancel:r.a.func,onUpdatePoster:r.a.func,posterUrl:r.a.string,shouldShowError:r.a.bool,uploadProgress:r.a.number}),o()(T,"defaultProps",{onCancel:d.noop,onUpdatePoster:d.noop});t.a=Object(c.b)(e=>({posterUrl:k(e),shouldShowError:N(e),uploadProgress:R(e)}),{updatePoster:(e,t)=>({type:"VIDEO_EDITOR_UPDATE_POSTER",videoId:e,params:t})})(Object(p.localize)(T))},"./client/components/clipboard-button-input/index.jsx":function(e,t,s){"use strict";var i=s("./node_modules/@babel/runtime/helpers/extends.js"),o=s.n(i),n=s("./node_modules/@babel/runtime/helpers/slicedToArray.js"),r=s.n(n),a=s("./node_modules/@babel/runtime/helpers/objectWithoutProperties.js"),l=s.n(a),c=s("./node_modules/react/index.js"),d=s.n(c),p=s("./node_modules/prop-types/index.js"),u=s.n(p),h=s("./node_modules/classnames/index.js"),m=s.n(h),g=s("./packages/i18n-calypso/dist/esm/index.js"),b=s("./node_modules/react-redux/es/index.js"),f=s("./client/lib/url/index.js"),j=s("./client/components/forms/clipboard-button/index.jsx"),y=s("./client/components/forms/form-text-input/index.jsx"),x=s("./client/state/analytics/actions.js");s("./client/components/clipboard-button-input/style.scss");function v(e){let t=e.value,s=void 0===t?"":t,i=e.className,n=e.disabled,a=e.hideHttp,c=e.dispatch,p=l()(e,["value","className","disabled","hideHttp","dispatch"]);const u=Object(g.useTranslate)(),h=d.a.useState(!1),b=r()(h,2),v=b[0],E=b[1];d.a.useEffect(()=>{if(v){const e=setTimeout(()=>E(!1),4e3);return()=>clearTimeout(e)}},[v]);return d.a.createElement("span",{className:m()("clipboard-button-input",i)},d.a.createElement(y.a,o()({},p,{disabled:n,value:a?Object(f.m)(s):s,type:"text",selectOnFocus:!0,readOnly:!0})),d.a.createElement(j.a,{text:s,onCopy:()=>{E(!0),c(Object(x.i)("calypso_editor_clipboard_url_button_click"))},disabled:n,compact:!0},v?u("Copied!"):u("Copy",{context:"verb"})))}v.propTypes={value:u.a.string,disabled:u.a.bool,className:u.a.string,hideHttp:u.a.bool},t.a=Object(b.b)()(v)},"./client/components/clipboard-button-input/style.scss":function(e,t,s){},"./client/components/data/query-keyring-services/index.jsx":function(e,t,s){"use strict";var i=s("./node_modules/prop-types/index.js"),o=s.n(i),n=s("./node_modules/react/index.js"),r=s("./node_modules/react-redux/es/index.js"),a=s("./client/state/sharing/services/selectors.js"),l=s("./client/state/sharing/services/actions.js");class c extends n.Component{componentWillMount(){this.props.isRequesting||this.props.requestKeyringServices()}render(){return null}}c.propTypes={isRequesting:o.a.bool,requestKeyringServices:o.a.func},t.a=Object(r.b)(e=>({isRequesting:Object(a.c)(e)}),{requestKeyringServices:l.a})(c)},"./client/components/data/query-media-storage/index.jsx":function(e,t,s){"use strict";var i=s("./node_modules/prop-types/index.js"),o=s.n(i),n=s("./node_modules/react/index.js"),r=s("./node_modules/react-redux/es/index.js"),a=s("./node_modules/redux/es/redux.js"),l=s("./client/state/sites/media-storage/selectors.js"),c=s("./client/lib/wp/browser.js");function d(e){return t=>(t({type:"SITE_MEDIA_STORAGE_REQUEST",siteId:e}),c.a.undocumented().site(e).mediaStorage().then(s=>{t(function(e,t){return{type:"SITE_MEDIA_STORAGE_RECEIVE",mediaStorage:e,siteId:t}}(s,e)),t({type:"SITE_MEDIA_STORAGE_REQUEST_SUCCESS",siteId:e})}).catch(s=>{t({type:"SITE_MEDIA_STORAGE_REQUEST_FAILURE",siteId:e,error:s})}))}var p=s("./client/lib/media/store.js");class u extends n.Component{constructor(e){super(e),this.requestStorage=this.requestStorage.bind(this)}requestStorage(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props;!e.requestingMediaStorage&&e.siteId&&e.requestMediaStorage(e.siteId)}componentWillMount(){this.requestStorage(),p.a.on("fetch-media-limits",this.requestStorage)}componentWillUnmount(){p.a.off("fetch-media-limits",this.requestStorage)}componentWillReceiveProps(e){!e.requestingMediaStorage&&e.siteId&&this.props.siteId!==e.siteId&&this.requestStorage(e)}render(){return null}}u.propTypes={siteId:o.a.number,requestingMediaStorage:o.a.bool,requestMediaStorage:o.a.func},u.defaultProps={requestMediaStorage:()=>{}};t.a=Object(r.b)((e,t)=>({requestingMediaStorage:Object(l.b)(e,t.siteId)}),e=>Object(a.b)({requestMediaStorage:d},e))(u)},"./client/components/forms/clipboard-button/index.jsx":function(e,t,s){"use strict";var i=s("./node_modules/@babel/runtime/helpers/extends.js"),o=s.n(i),n=s("./node_modules/@babel/runtime/helpers/objectWithoutProperties.js"),r=s.n(n),a=s("./node_modules/react/index.js"),l=s.n(a),c=s("./node_modules/prop-types/index.js"),d=s.n(c),p=s("./node_modules/react-dom/index.js"),u=s.n(p),h=s("./node_modules/clipboard/dist/clipboard.js"),m=s.n(h),g=s("./node_modules/lodash/lodash.js"),b=s("./node_modules/classnames/index.js"),f=s.n(b),j=s("./client/components/button/index.jsx");function y(e){let t=e.className,s=e.text,i=e.onCopy,n=void 0===i?g.noop:i,a=r()(e,["className","text","onCopy"]);const c=l.a.useRef(),d=l.a.useRef(),p=l.a.useRef();return l.a.useEffect(()=>{d.current=(()=>s),p.current=n},[s,n]),l.a.useEffect(()=>{const e=u.a.findDOMNode(c.current),t=new m.a(e,{text:()=>d.current()});return t.on("success",()=>p.current()),()=>t.destroy()},[]),l.a.createElement(j.a,o()({},a,{ref:c,className:f()("clipboard-button",t)}))}y.propTypes={className:d.a.string,text:d.a.string,onCopy:d.a.func},t.a=y},"./client/components/forms/range/index.jsx":function(e,t,s){"use strict";var i=s("./node_modules/@babel/runtime/helpers/extends.js"),o=s.n(i),n=s("./node_modules/@babel/runtime/helpers/defineProperty.js"),r=s.n(n),a=s("./node_modules/react/index.js"),l=s.n(a),c=s("./node_modules/prop-types/index.js"),d=s.n(c),p=s("./node_modules/lodash/lodash.js"),u=s("./node_modules/classnames/index.js"),h=s.n(u);class m extends l.a.Component{constructor(){super(...arguments),r()(this,"shouldNormalizeChange",()=>{const e=window.navigator.userAgent;return-1!==e.indexOf("MSIE")||-1!==e.indexOf("Trident/")}),r()(this,"onChange",e=>{this.props.onChange(e)})}componentDidMount(){this.shouldNormalizeChange()&&this.refs.range.addEventListener("change",this.onChange)}componentWillUnmount(){this.refs.range.removeEventListener("change",this.onChange)}render(){const e=h()(this.props.className,"form-range");return l.a.createElement("input",o()({ref:"range",type:"range",className:e},Object(p.omit)(this.props,"className")))}}r()(m,"displayName","FormRange"),r()(m,"propTypes",{onChange:d.a.func}),r()(m,"defaultProps",{onChange:p.noop}),s.d(t,"a",function(){return g});class g extends l.a.Component{constructor(){super(...arguments),r()(this,"state",{id:Object(p.uniqueId)("range")}),r()(this,"getMinContentElement",()=>{if(this.props.minContent)return l.a.createElement("span",{className:"range__content is-min"},this.props.minContent)}),r()(this,"getMaxContentElement",()=>{if(this.props.maxContent)return l.a.createElement("span",{className:"range__content is-max"},this.props.maxContent)}),r()(this,"getValueLabelElement",()=>{let e,t;if(this.props.showValueLabel)return e=100*(this.props.value-this.props.min)/(this.props.max-this.props.min),t=Math.floor((50-e)/50*13),l.a.createElement("span",{className:"range__label",style:{left:(e||0)+"%",marginLeft:t}},l.a.createElement("output",{className:"range__label-inner",htmlFor:this.state.id,value:this.props.value},this.props.value))})}render(){const e=h()(this.props.className,"range",{"has-min-content":!!this.props.minContent,"has-max-content":!!this.props.maxContent});return l.a.createElement("div",{className:e},this.getMinContentElement(),l.a.createElement(m,o()({id:this.state.id,className:"range__input"},Object(p.omit)(this.props,"minContent","maxContent","showValueLabel","className"))),this.getMaxContentElement(),this.getValueLabelElement())}}r()(g,"displayName","Range"),r()(g,"propTypes",{minContent:d.a.oneOfType([d.a.element,d.a.string]),maxContent:d.a.oneOfType([d.a.element,d.a.string]),min:d.a.oneOfType([d.a.string,d.a.number]),max:d.a.oneOfType([d.a.string,d.a.number]),value:d.a.oneOfType([d.a.string,d.a.number]),showValueLabel:d.a.bool}),r()(g,"defaultProps",{min:0,max:10,value:0,showValueLabel:!1})},"./client/components/image-preloader/index.jsx":function(e,t,s){"use strict";s.d(t,"a",function(){return h});var i=s("./node_modules/@babel/runtime/helpers/extends.js"),o=s.n(i),n=s("./node_modules/@babel/runtime/helpers/defineProperty.js"),r=s.n(n),a=s("./node_modules/prop-types/index.js"),l=s.n(a),c=s("./node_modules/react/index.js"),d=s.n(c),p=s("./node_modules/lodash/lodash.js");const u={PENDING:"PENDING",LOADING:"LOADING",LOADED:"LOADED",FAILED:"FAILED"};class h extends d.a.Component{constructor(){super(...arguments),r()(this,"state",{status:u.PENDING}),r()(this,"createLoader",e=>{const t=(e||this.props).src;this.destroyLoader(),this.setState({status:u.LOADING}),t&&(this.image=new Image,this.image.src=t,this.image.onload=this.onLoadComplete,this.image.onerror=this.onLoadComplete)}),r()(this,"destroyLoader",()=>{this.image&&(this.image.onload=p.noop,this.image.onerror=p.noop,delete this.image)}),r()(this,"onLoadComplete",e=>{if(this.destroyLoader(),"load"!==e.type)return this.setState({status:u.FAILED},()=>{this.props.onError&&this.props.onError(e)});this.setState({status:u.LOADED},()=>{this.props.onLoad&&this.props.onLoad(e)})})}componentWillMount(){this.createLoader()}componentWillReceiveProps(e){e.src!==this.props.src&&this.createLoader(e)}componentWillUnmount(){this.destroyLoader()}render(){let e,t;switch(this.state.status){case u.LOADING:e=this.props.placeholder;break;case u.LOADED:t=Object(p.omit)(this.props,Object.keys(this.constructor.propTypes)),e=d.a.createElement("img",o()({src:this.props.src},t));break;case u.FAILED:e=this.props.children}return d.a.createElement("div",{className:"image-preloader"},e)}}r()(h,"propTypes",{src:l.a.string,placeholder:l.a.element.isRequired,onLoad:l.a.func,onError:l.a.func})},"./client/components/infinite-list/index.jsx":function(e,t,s){"use strict";var i=s("./node_modules/@babel/runtime/helpers/defineProperty.js"),o=s.n(i),n=s("./node_modules/debug/src/browser.js"),r=s.n(n),a=s("./node_modules/lodash/lodash.js"),l=s("./node_modules/page/page.js"),c=s.n(l),d=s("./node_modules/prop-types/index.js"),p=s.n(d),u=s("./node_modules/react/index.js"),h=s.n(u),m=s("./node_modules/react-dom/index.js"),g=s.n(m),b=s("./client/lib/detect-history-navigation/index.js");const f=r()("calypso:infinite-list:scroll-store"),j={leading:!1},y=new Map,x=new Map;var v={getPositions(e){const t=y.get(e);return f("getting positions:",e,t),t},storePositions:Object(a.throttle)(function(e,t){f("storing positions:",e,t),y.set(e,t)},1e3,j),getScrollTop(e){const t=x.get(e);return f("getting scrollTop:",e,t),t},storeScrollTop:Object(a.throttle)(function(e,t){f("storing scrollTop:",e,t),x.set(e,t)},1e3,j)};const E=r()("calypso:infinite-list:helper");var _=class{constructor(e){this.boundsForRef=e,this.itemHeights={},this.contextHeight=null,this.topHideLevelHard=null,this.topHideLevelSoft=null,this.bottomHideLevelHard=null,this.bottomHideLevelSoft=null,this.bottomHideLevelUltraSoft=null,this.props=null,this.scrollPosition=null,this.containerTop=null,this.topPlaceholderHeight=null,this.bottomPlaceholderHeight=null,this.containerBottom=null,this.stateUpdated=null,this.firstRenderedIndex=null,this.lastRenderedIndex=null}storedItemHeight(e){let t=this.props.guessedItemHeight;return e in this.itemHeights&&(t=this.itemHeights[e]),t}forEachInRow(e,t,s){if("function"!=typeof t)return;s&&(t=t.bind(s));const i=e-e%this.props.itemsPerRow,o=Math.min(i+this.props.itemsPerRow,this.props.items.length)-1;for(let e=i;e<=o;e++)t(this.props.items[e],e)}storeRowItemHeights(e,t){this.forEachInRow(t,function(t){const s=this.props.getItemRef(t),i=this.boundsForRef(s);let o;o=i?"bottom"===e?this.containerBottom-this.bottomPlaceholderHeight-i.top:i.bottom-(this.containerTop+this.topPlaceholderHeight):this.props.guessedItemHeight,this.itemHeights[s]=o},this)}deleteRowItemHeights(e){this.forEachInRow(e,e=>{const t=this.props.getItemRef(e);delete this.itemHeights[t]},this)}getRowHeight(e){let t=0;return this.forEachInRow(e,e=>{const s=this.props.getItemRef(e),i=this.storedItemHeight(s);t=Math.max(t,i)},this),t}updateContextHeight(e){this.contextHeight!==e&&(this.contextHeight=e,this.topHideLevelHard=Math.min(-1*e,-5*this.props.guessedItemHeight),this.topHideLevelSoft=Math.min(-2*e,-10*this.props.guessedItemHeight),this.bottomHideLevelHard=e+Math.max(e,5*this.props.guessedItemHeight),this.bottomHideLevelSoft=e+Math.max(2*e,10*this.props.guessedItemHeight),this.bottomHideLevelUltraSoft=e+Math.max(3*e,15*this.props.guessedItemHeight))}initialLastRenderedIndex(){return Math.min(this.props.items.length-1,Math.floor(this.bottomHideLevelSoft/this.props.guessedItemHeight)-1)}updatePlaceholderDimensions(){const e=this.boundsForRef("topPlaceholder"),t=this.boundsForRef("bottomPlaceholder");this.topPlaceholderHeight=e.height,this.containerTop=e.top,this.bottomPlaceholderHeight=t.height,this.containerBottom=t.bottom}scrollChecks(e){this.reset(e),this.adjustLastRenderedIndex(),this.shouldHideItemsAbove()?this.hideItemsAbove():this.shouldShowItemsAbove()&&this.showItemsAbove(),this.shouldHideItemsBelow()?this.hideItemsBelow():this.shouldShowItemsBelow()&&this.showItemsBelow(),this.shouldLoadNextPage()&&this.loadNextPage()}reset(e){this.stateUpdated=!1,this.firstRenderedIndex=e.firstRenderedIndex,this.lastRenderedIndex=e.lastRenderedIndex}adjustLastRenderedIndex(){const e=this.initialLastRenderedIndex(),t=this.lastRenderedIndex||0,s=this.firstRenderedIndex||0,i=this.props.items.length;let o=t;0===i&&(o=-1),t>=i&&(o=Math.min(s+e,i-1)),-1===o&&i>0&&0===s&&(o=e),o!==this.lastRenderedIndex&&(this.stateUpdated=!0,this.lastRenderedIndex=o)}shouldHideItemsAbove(){return this.containerTop+this.topPlaceholderHeight<this.topHideLevelSoft}hideItemsAbove(){let e,t;for(;this.firstRenderedIndex<this.props.items.length;){if(this.storeRowItemHeights("top",this.firstRenderedIndex),e=this.getRowHeight(this.firstRenderedIndex),(t=this.containerTop+this.topPlaceholderHeight+e)>this.topHideLevelHard){this.deleteRowItemHeights(this.firstRenderedIndex);break}this.topPlaceholderHeight+=e,this.firstRenderedIndex+=this.props.itemsPerRow,this.stateUpdated=!0,E("hiding top item",e,this.topPlaceholderHeight)}}shouldShowItemsAbove(){return this.containerTop+this.topPlaceholderHeight>this.topHideLevelHard}showItemsAbove(){let e,t;for(;this.firstRenderedIndex>0&&(e=this.getRowHeight(this.firstRenderedIndex-this.props.itemsPerRow),!((t=this.containerTop+this.topPlaceholderHeight-e)<this.topHideLevelSoft));)this.deleteRowItemHeights(this.firstRenderedIndex-this.props.itemsPerRow),this.firstRenderedIndex-=this.props.itemsPerRow,this.firstRenderedIndex=Math.max(0,this.firstRenderedIndex),this.firstRenderedIndex<=0?this.topPlaceholderHeight=0:this.topPlaceholderHeight=Math.max(0,this.topPlaceholderHeight-e),this.stateUpdated=!0,E("showing top item",e,this.topPlaceholderHeight)}shouldHideItemsBelow(){return this.containerBottom-this.bottomPlaceholderHeight>this.bottomHideLevelUltraSoft}hideItemsBelow(){let e,t;for(;this.lastRenderedIndex>=0;){if(this.storeRowItemHeights("bottom",this.lastRenderedIndex),t=this.getRowHeight(this.lastRenderedIndex),(e=this.containerBottom-this.bottomPlaceholderHeight-t)<this.bottomHideLevelHard){this.deleteRowItemHeights(this.lastRenderedIndex);break}this.bottomPlaceholderHeight+=t,this.lastRenderedIndex-=this.props.itemsPerRow,this.stateUpdated=!0,E("hiding bottom item",t,this.bottomPlaceholderHeight)}}shouldShowItemsBelow(){return this.containerBottom-this.bottomPlaceholderHeight<this.bottomHideLevelHard}showItemsBelow(){let e,t,s;for(;this.lastRenderedIndex<this.props.items.length-1&&(e=this.getRowHeight(this.lastRenderedIndex+this.props.itemsPerRow),!((t=(s=this.containerBottom-this.bottomPlaceholderHeight)+e)>this.bottomHideLevelSoft&&s>this.bottomHideLevelHard));)this.deleteRowItemHeights(this.lastRenderedIndex+this.props.itemsPerRow),this.bottomPlaceholderHeight-e<0?(this.containerBottom+=e-this.bottomPlaceholderHeight,this.bottomPlaceholderHeight=0):this.bottomPlaceholderHeight-=e,this.lastRenderedIndex+=this.props.itemsPerRow,this.lastRenderedIndex=Math.min(this.lastRenderedIndex,this.props.items.length-1),this.lastRenderedIndex>=this.props.items.length-1&&(this.bottomPlaceholderHeight=0),this.stateUpdated=!0,E("showing bottom item",e,this.bottomPlaceholderHeight)}shouldLoadNextPage(){return!this.props.fetchingNextPage&&!this.props.lastPage&&0===this.bottomPlaceholderHeight&&this.containerBottom<this.bottomHideLevelHard}loadNextPage(){if(this.queuedFetchNextPage)return;let e=this.triggeredByScroll;E("fetching next page",this.containerBottom,this.bottomPlaceholderHeight),this.scrollPosition>this.contextHeight&&(e=!0),this.queuedFetchNextPage=Promise.resolve().then(()=>{if(this.queuedFetchNextPage=null,this.props.fetchingNextPage||this.props.lastPage)return!1;this.props.fetchNextPage({triggeredByScroll:e})})}},I=s("./client/lib/scroll-to/index.js"),S=s("./client/lib/react-smart-set-state/index.js");s("./client/components/infinite-list/style.scss");s.d(t,"a",function(){return C});const O=r()("calypso:infinite-list");class C extends h.a.Component{constructor(){super(...arguments),o()(this,"lastScrollTop",-1),o()(this,"scrollRAFHandle",!1),o()(this,"scrollHelper",null),o()(this,"isScrolling",!1),o()(this,"_isMounted",!1),o()(this,"smartSetState",S.a),o()(this,"onScroll",()=>{this.isScrolling||this.scrollRAFHandle||this.getCurrentScrollTop()===this.lastScrollTop||(this.scrollRAFHandle=window.requestAnimationFrame(this.scrollChecks))}),o()(this,"scrollChecks",()=>{this._isMounted&&this.getCurrentScrollTop()!==this.lastScrollTop?this.updateScroll({triggeredByScroll:!0}):this.scrollRAFHandle=null}),o()(this,"boundsForRef",e=>e in this.refs?g.a.findDOMNode(this.refs[e]).getBoundingClientRect():null),o()(this,"_resetScroll",e=>{const t=this.state.scrollTop;this._contextLoaded()&&(O("history setting scroll position:",e),this._setContainerY(t),this._scrollContainer.removeEventListener("scroll",this._resetScroll),O("override scroll position from HTML5 history popstate:",t))})}componentWillMount(){const e=c.a.current;let t,s;b.a.loadedViaHistory()&&(t=v.getPositions(e),s=v.getScrollTop(e)),t&&s&&(O("overriding scrollTop:",s),t.scrollTop=s),this.scrollHelper=new _(this.boundsForRef),this.scrollHelper.props=this.props,this._contextLoaded()&&(this._scrollContainer=this.props.context||window,this.scrollHelper.updateContextHeight(this.getCurrentContextHeight())),this.isScrolling=!1,t?O("infinite-list positions loaded from store"):(O("infinite-list positions reset for new list"),t={firstRenderedIndex:0,topPlaceholderHeight:0,lastRenderedIndex:this.scrollHelper.initialLastRenderedIndex(),bottomPlaceholderHeight:0,scrollTop:0}),O("infinite list mounting",t),this.setState(t)}componentDidMount(){this._isMounted=!0,this._contextLoaded()&&this._setContainerY(this.state.scrollTop),b.a.loadedViaHistory()&&this._overrideHistoryScroll(),O("setting scrollTop:",this.state.scrollTop),this.updateScroll({triggeredByScroll:!1}),this._contextLoaded()&&this._scrollContainer.addEventListener("scroll",this.onScroll)}componentWillReceiveProps(e){this.scrollHelper.props=e,this.isScrolling||(this.cancelAnimationFrame(),this.updateScroll({triggeredByScroll:!1})),e.context!==this.props.context&&this._contextLoaded()&&this._scrollContainer.removeEventListener("scroll",this._resetScroll)}componentDidUpdate(e){this._contextLoaded()&&(this.props.context!==e.context&&(this._scrollContainer&&this._scrollContainer.removeEventListener("scroll",this.onScroll),this._scrollContainer=this.props.context||window,this._scrollContainer.addEventListener("scroll",this.onScroll),b.a.loadedViaHistory()&&this._overrideHistoryScroll()),this.isScrolling||(this.cancelAnimationFrame(),this.updateScroll({triggeredByScroll:!1})))}reset(){this.cancelAnimationFrame(),this.scrollHelper=new _(this.boundsForRef),this.scrollHelper.props=this.props,this._contextLoaded()&&(this._scrollContainer=this.props.context||window,this.scrollHelper.updateContextHeight(this.getCurrentContextHeight())),this.isScrolling=!1,this.setState({firstRenderedIndex:0,topPlaceholderHeight:0,lastRenderedIndex:this.scrollHelper.initialLastRenderedIndex(),bottomPlaceholderHeight:0,scrollTop:0})}componentWillUnmount(){this._scrollContainer.removeEventListener("scroll",this.onScroll),this._scrollContainer.removeEventListener("scroll",this._resetScroll),this.cancelAnimationFrame(),this._isMounted=!1}cancelAnimationFrame(){this.scrollRAFHandle&&(window.cancelAnimationFrame(this.scrollRAFHandle),this.scrollRAFHandle=null),this.lastScrollTop=-1}getCurrentContextHeight(){return(this.props.context||window.document.documentElement).clientHeight}getCurrentScrollTop(){return this.props.context?(O("getting scrollTop from context"),this.props.context.scrollTop):window.pageYOffset}scrollToTop(){this.cancelAnimationFrame(),this.isScrolling=!0,this.props.context&&this.props.context!==window?(this.props.context.scrollTop=0,this.updateScroll({triggeredByScroll:!1}),this.isScrolling=!1):Object(I.a)({x:0,y:0,duration:250,onComplete:()=>{this._isMounted&&this.updateScroll({triggeredByScroll:!1}),this.isScrolling=!1}})}updateScroll(e){const t=c.a.current;let s;this._contextLoaded()&&(this.lastScrollTop=this.getCurrentScrollTop(),v.storeScrollTop(t,this.lastScrollTop),this.scrollHelper.updateContextHeight(this.getCurrentContextHeight()),this.scrollHelper.scrollPosition=this.lastScrollTop,this.scrollHelper.triggeredByScroll=e.triggeredByScroll,this.scrollHelper.updatePlaceholderDimensions(),this.scrollHelper.scrollChecks(this.state),this.scrollHelper.stateUpdated&&(s={firstRenderedIndex:this.scrollHelper.firstRenderedIndex,topPlaceholderHeight:this.scrollHelper.topPlaceholderHeight,lastRenderedIndex:this.scrollHelper.lastRenderedIndex,bottomPlaceholderHeight:this.scrollHelper.bottomPlaceholderHeight,scrollTop:this.lastScrollTop},this.lastScrollTop=-1,O("new scroll positions",s,this.state),this.smartSetState(s),v.storePositions(t,s)),this.scrollRAFHandle=window.requestAnimationFrame(this.scrollChecks))}getVisibleItemIndexes(e){const t=g.a.findDOMNode(this),s=[],i=this.state.firstRenderedIndex,o=this.state.lastRenderedIndex,n=e&&e.offsetTop?e.offsetTop:0;let r,a,l,c,d=e&&e.offsetBottom?e.offsetBottom:0;if(d=d||0,o>-1)for(l=t.children,c=1;c<l.length-1;c++)a=t.children[c].getBoundingClientRect(),r=window.innerHeight||document.documentElement.clientHeight,(a.top<0&&Math.abs(a.top)<a.height-n||a.top>0&&a.top<r-d)&&s.push({index:i+c-1,bounds:a});return s}render(){const e=Object(a.omit)(this.props,Object.keys(this.constructor.propTypes));let t,s=this.state.lastRenderedIndex,i=[];for((-1===s||s>this.props.items.length-1)&&(O("resetting lastRenderedIndex, currently at %s, %d items",s,this.props.items.length),s=Math.min(this.state.firstRenderedIndex+this.scrollHelper.initialLastRenderedIndex(),this.props.items.length-1),O("reset lastRenderedIndex to %s",s)),O("rendering %d to %d",this.state.firstRenderedIndex,s),t=this.state.firstRenderedIndex;t<=s;t++)i.push(this.props.renderItem(this.props.items[t],t));return this.props.fetchingNextPage&&(i=i.concat(this.props.renderLoadingPlaceholders())),h.a.createElement("div",e,h.a.createElement("div",{ref:"topPlaceholder",className:"infinite-list__spacer",style:{height:this.state.topPlaceholderHeight}}),i,this.props.renderTrailingItems(),h.a.createElement("div",{ref:"bottomPlaceholder",className:"infinite-list__spacer",style:{height:this.state.bottomPlaceholderHeight}}))}_setContainerY(e){this.props.context&&this.props.context!==window?this.props.context.scrollTop=e:window.scrollTo(0,e)}_overrideHistoryScroll(){this._contextLoaded()&&this._scrollContainer.addEventListener("scroll",this._resetScroll)}_contextLoaded(){return this.props.context||!1===this.props.context||!("context"in this.props)}}o()(C,"propTypes",{items:p.a.array.isRequired,fetchingNextPage:p.a.bool.isRequired,lastPage:p.a.bool.isRequired,guessedItemHeight:p.a.number.isRequired,itemsPerRow:p.a.number,fetchNextPage:p.a.func.isRequired,getItemRef:p.a.func.isRequired,renderItem:p.a.func.isRequired,renderLoadingPlaceholders:p.a.func.isRequired,renderTrailingItems:p.a.func,context:p.a.oneOfType([p.a.object,p.a.bool])}),o()(C,"defaultProps",{itemsPerRow:1,renderTrailingItems:a.noop})},"./client/components/infinite-list/style.scss":function(e,t,s){},"./client/components/progress-bar/index.jsx":function(e,t,s){"use strict";s.d(t,"a",function(){return u});var i=s("./node_modules/@babel/runtime/helpers/defineProperty.js"),o=s.n(i),n=s("./node_modules/prop-types/index.js"),r=s.n(n),a=s("./node_modules/react/index.js"),l=s.n(a),c=s("./node_modules/classnames/index.js"),d=s.n(c),p=s("./client/components/screen-reader-text/index.js");s("./client/components/progress-bar/style.scss");class u extends a.PureComponent{constructor(){super(...arguments),o()(this,"state",{allTimeMax:this.props.value})}static getDerivedStateFromProps(e,t){return{allTimeMax:Math.max(t.allTimeMax,e.value)}}getCompletionPercentage(){const e=Math.ceil((this.props.canGoBackwards?this.props.value:this.state.allTimeMax)/this.props.total*100);return Math.min(e,100)}renderBar(){const e=this.props.title?l.a.createElement(p.a,null,this.props.title):null,t={width:this.getCompletionPercentage()+"%"};return this.props.color&&(t.backgroundColor=this.props.color),l.a.createElement("div",{className:"progress-bar__progress",style:t},e)}render(){const e=d()(this.props.className,"progress-bar",{"is-compact":this.props.compact,"is-pulsing":this.props.isPulsing});return l.a.createElement("div",{className:e},this.renderBar())}}o()(u,"defaultProps",{total:100,compact:!1,isPulsing:!1,canGoBackwards:!1}),o()(u,"propTypes",{value:r.a.number.isRequired,total:r.a.number,color:r.a.string,title:r.a.string,compact:r.a.bool,className:r.a.string,isPulsing:r.a.bool,canGoBackwards:r.a.bool})},"./client/components/progress-bar/style.scss":function(e,t,s){},"./client/components/sorted-grid/style.scss":function(e,t,s){},"./client/components/sticky-panel/index.jsx":function(e,t,s){"use strict";var i=s("./node_modules/@babel/runtime/helpers/objectSpread.js"),o=s.n(i),n=s("./node_modules/@babel/runtime/helpers/defineProperty.js"),r=s.n(n),a=s("./node_modules/lodash/lodash.js"),l=s("./node_modules/prop-types/index.js"),c=s.n(l),d=s("./node_modules/react-dom/index.js"),p=s.n(d),u=s("./node_modules/react/index.js"),h=s.n(u),m=s("./node_modules/classnames/index.js"),g=s.n(m),b=s("./client/lib/after-layout-flush/index.js"),f=s("./client/lib/viewport/index.js");s("./client/components/sticky-panel/style.scss");const j=200,y="undefined"!=typeof window&&"IntersectionObserver"in window,x={minLimit:c.a.oneOfType([c.a.bool,c.a.number])},v={minLimit:!1};function E(){return document.getElementById("header").getBoundingClientRect().height}function _(e){if(e.isSticky)return{top:E(),width:e.blockWidth}}function I(e,t){return{spacerHeight:t?p.a.findDOMNode(e).clientHeight:0,blockWidth:t?p.a.findDOMNode(e).clientWidth:0}}function S(e,t){const s=g()("sticky-panel",e.className,{"is-sticky":t.isSticky});return h.a.createElement("div",{className:s},h.a.createElement("div",{className:"sticky-panel__content",style:_(t)},e.children),h.a.createElement("div",{className:"sticky-panel__spacer",style:{height:t.spacerHeight}}))}function O(e){return!1!==e&&e>=window.innerWidth||Object(f.e)()}class C extends h.a.Component{constructor(){super(...arguments),r()(this,"state",{isSticky:!1,spacerHeight:0,blockWidth:0}),r()(this,"onIntersection",Object(b.a)(e=>{if(!e||!e[0])return;const t=e[0],s=t.intersectionRatio,i=t.rootBounds,o=t.boundingClientRect,n=s<1&&i.bottom>o.bottom;this.updateStickyState(n)})),r()(this,"throttleOnResize",Object(a.throttle)(()=>this.setState(e=>I(this,e.isSticky)),j))}componentDidMount(){window.addEventListener("resize",this.throttleOnResize),this.deferredMount=Object(a.defer)(()=>{this.observer=new IntersectionObserver(this.onIntersection,{threshold:[0,1],rootMargin:"-".concat(E(),"px 0px 0px 0px")}),this.observer.observe(p.a.findDOMNode(this))})}componentWillUnmount(){this.observer&&this.observer.disconnect(),this.onIntersection.cancel(),clearTimeout(this.deferredMount),window.removeEventListener("resize",this.throttleOnResize)}updateStickyState(e){if(O(this.props.minLimit))return this.setState({isSticky:!1});e!==this.state.isSticky&&this.setState(o()({isSticky:e},I(this,e)))}render(){return S(this.props,this.state)}}r()(C,"displayName","StickyPanel"),r()(C,"propTypes",x),r()(C,"defaultProps",v);class P extends h.a.Component{constructor(){super(...arguments),r()(this,"state",{isSticky:!1,spacerHeight:0,blockWidth:0}),r()(this,"onWindowScroll",Object(b.a)(()=>{const e=p.a.findDOMNode(this).getBoundingClientRect().top<E();this.updateStickyState(e)})),r()(this,"throttleOnResize",Object(a.throttle)(()=>this.setState(e=>(function(e,t){const s=I(e,t.isSticky);return t.spacerHeight!==s.spacerHeight||t.blockWidth!==s.blockWidth?s:null})(this,e)),j))}componentDidMount(){this.onWindowScroll(),window.addEventListener("scroll",this.onWindowScroll),window.addEventListener("resize",this.throttleOnResize)}componentWillUnmount(){window.removeEventListener("scroll",this.onWindowScroll),window.removeEventListener("resize",this.throttleOnResize),this.onWindowScroll.cancel()}updateStickyState(e){if(O(this.props.minLimit))return this.setState({isSticky:!1});e!==this.state.isSticky&&this.setState(o()({isSticky:e},I(this,e)))}render(){return S(this.props,this.state)}}r()(P,"displayName","StickyPanel"),r()(P,"propTypes",x),r()(P,"defaultProps",v),t.a=y?C:P},"./client/components/sticky-panel/style.scss":function(e,t,s){},"./client/components/tinymce/plugins/wpcom-track-paste/sources.js":function(e,t,s){"use strict";s.d(t,"a",function(){return i}),s.d(t,"b",function(){return o});const i="google_docs",o="unknown"},"./client/layout/guided-tours/tours/activity-log-jetpack-intro-tour/meta.js":function(e,t,s){"use strict";var i=s("./client/layout/guided-tours/utils.js"),o=s("./client/state/ui/guided-tours/contexts.js");t.a={name:"activityLogJetpackIntroTour",version:"20180808",path:"/activity-log/",when:Object(i.a)(o.i)}},"./client/layout/guided-tours/tours/activity-log-wpcom-intro-tour/meta.js":function(e,t,s){"use strict";var i=s("./client/layout/guided-tours/utils.js"),o=s("./client/state/ui/guided-tours/contexts.js");t.a={name:"activityLogWpcomIntroTour",version:"20180808",path:"/activity-log/",when:Object(i.a)(o.j)}},"./client/layout/guided-tours/tours/checklist-about-page-tour/meta.js":function(e,t,s){"use strict";t.a={name:"checklistAboutPage",version:"20171205",path:"/non-existent-route"}},"./client/layout/guided-tours/tours/checklist-contact-page-tour/meta.js":function(e,t,s){"use strict";t.a={name:"checklistContactPage",version:"20171205",path:"/non-existent-route"}},"./client/layout/guided-tours/tours/checklist-domain-register-tour/meta.js":function(e,t,s){"use strict";var i=s("./client/layout/guided-tours/utils.js");t.a={name:"checklistDomainRegister",version:"20180717",path:"/domains/add",when:i.b}},"./client/layout/guided-tours/tours/checklist-publish-post-tour/meta.js":function(e,t,s){"use strict";t.a={name:"checklistPublishPost",version:"20171205",path:"/non-existent-route"}},"./client/layout/guided-tours/tours/checklist-site-icon-tour/meta.js":function(e,t,s){"use strict";var i=s("./client/layout/guided-tours/utils.js");t.a={name:"checklistSiteIcon",version:"20171205",path:"/non-existent-route",when:i.b}},"./client/layout/guided-tours/tours/checklist-site-tagline-tour/meta.js":function(e,t,s){"use strict";var i=s("./client/layout/guided-tours/utils.js");t.a={name:"checklistSiteTagline",version:"20171205",path:"/non-existent-route",when:i.b}},"./client/layout/guided-tours/tours/checklist-site-title-tour/meta.js":function(e,t,s){"use strict";var i=s("./client/layout/guided-tours/utils.js");t.a={name:"checklistSiteTitle",version:"20171205",path:"/non-existent-route",when:i.b}},"./client/layout/guided-tours/tours/checklist-user-avatar-tour/meta.js":function(e,t,s){"use strict";var i=s("./client/layout/guided-tours/utils.js");t.a={name:"checklistUserAvatar",version:"20171205",path:"/non-existent-route",when:i.b}},"./client/layout/guided-tours/tours/editor-basics-tour/meta.js":function(e,t,s){"use strict";var i=s("./client/layout/guided-tours/utils.js"),o=s("./client/state/ui/guided-tours/contexts.js"),n=s("./client/lib/viewport/index.js"),r=s("./client/state/current-user/selectors.js");t.a={name:"editorBasicsTour",version:"20170503",path:["/post/","/page/"],when:Object(i.a)(n.d,o.f,r.m)}},"./client/layout/guided-tours/tours/gdocs-integration-tour/meta.js":function(e,t,s){"use strict";var i=s("./client/layout/guided-tours/utils.js"),o=s("./client/state/ui/guided-tours/contexts.js"),n=s("./client/state/current-user/selectors.js");t.a={name:"gdocsIntegrationTour",version:"20170227",path:"/post",when:Object(i.a)(n.m,o.c)}},"./client/layout/guided-tours/tours/jetpack-backups-rewind-tour/meta.js":function(e,t,s){"use strict";t.a={name:"jetpackBackupsRewind",version:"20190409"}},"./client/layout/guided-tours/tours/jetpack-basic-tour/meta.js":function(e,t,s){"use strict";var i=s("./client/layout/guided-tours/utils.js"),o=s("./client/state/ui/guided-tours/contexts.js");t.a={name:"jetpack",version:"20160601",path:"/",when:Object(i.a)(o.f,Object(o.e)("guided-tours/jetpack-basic"))}},"./client/layout/guided-tours/tours/jetpack-monitoring-tour/meta.js":function(e,t,s){"use strict";t.a={name:"jetpackMonitoring",version:"20180611"}},"./client/layout/guided-tours/tours/jetpack-plugin-updates-tour/meta.js":function(e,t,s){"use strict";t.a={name:"jetpackPluginUpdates",version:"20180611"}},"./client/layout/guided-tours/tours/jetpack-sign-in-tour/meta.js":function(e,t,s){"use strict";t.a={name:"jetpackSignIn",version:"20180704"}},"./client/layout/guided-tours/tours/main-tour/meta.js":function(e,t,s){"use strict";var i=s("./client/layout/guided-tours/utils.js"),o=s("./client/state/ui/guided-tours/contexts.js");t.a={name:"main",version:"20160601",path:"/",when:Object(i.a)(o.f,Object(o.e)("guided-tours/main"))}},"./client/layout/guided-tours/tours/media-basics-tour/meta.js":function(e,t,s){"use strict";var i=s("./client/layout/guided-tours/utils.js"),o=s("./client/state/ui/guided-tours/contexts.js"),n=s("./client/lib/viewport/index.js");t.a={name:"mediaBasicsTour",version:"20170321",path:"/media",when:Object(i.a)(n.d,o.f)}},"./client/layout/guided-tours/tours/plugins-basic-tour/meta.js":function(e,t,s){"use strict";var i=s("./client/layout/guided-tours/utils.js"),o=s("./client/state/ui/guided-tours/contexts.js"),n=s("./client/lib/viewport/index.js"),r=s("./client/state/ui/selectors.js"),a=s("./client/state/selectors/can-current-user.js"),l=s("./client/state/selectors/can-current-user-manage-plugins.js"),c=s("./client/state/selectors/is-site-automated-transfer.js");t.a={name:"pluginsBasicTour",version:"20180718",path:["/stats","/plugins"],when:Object(i.a)(e=>{const t=Object(r.e)(e);return t?Object(a.b)(e,t,"manage_options"):Object(l.a)(e)},e=>Object(c.a)(e,Object(r.e)(e)),n.d,Object(o.e)("calypsoify/plugins"))}},"./client/layout/guided-tours/tours/simple-payments-email-tour/meta.js":function(e,t,s){"use strict";var i=s("./client/layout/guided-tours/utils.js");t.a={name:"simplePaymentsEmailTour",version:"20180501",path:"/",when:i.b}},"./client/layout/guided-tours/tours/simple-payments-tour/meta.js":function(e,t,s){"use strict";var i=s("./client/layout/guided-tours/utils.js"),o=s("./client/state/ui/guided-tours/contexts.js"),n=s("./client/lib/viewport/index.js"),r=s("./client/state/current-user/selectors.js");t.a={name:"simplePaymentsTour",version:"20170816",path:"/post/",when:Object(i.a)(n.d,o.g,r.m)}},"./client/layout/guided-tours/tours/tutorial-site-preview-tour/meta.js":function(e,t,s){"use strict";var i=s("./client/layout/guided-tours/utils.js"),o=s("./client/state/ui/guided-tours/contexts.js");t.a={name:"tutorialSitePreview",version:"20170101",path:"/stats",when:Object(i.a)(Object(o.e)("guided-tours/tutorial-site-preview"),o.k,o.f)}},"./client/layout/guided-tours/utils.js":function(e,t,s){"use strict";var i=s("./node_modules/lodash/lodash.js");s.d(t,"a",function(){return i.overEvery}),s.d(t,"c",function(){return i.negate}),s.d(t,"b",function(){return i.noop})},"./client/lib/accept/index.js":function(e,t,s){"use strict";var i=s("./node_modules/react-dom/index.js"),o=s.n(i),n=s("./node_modules/react/index.js"),r=s.n(n),a=s("./node_modules/@babel/runtime/helpers/defineProperty.js"),l=s.n(a),c=s("./node_modules/prop-types/index.js"),d=s.n(c),p=s("./packages/i18n-calypso/dist/esm/index.js"),u=s("./node_modules/classnames/index.js"),h=s.n(u),m=s("./client/components/dialog/index.jsx");class g extends n.Component{constructor(){super(...arguments),l()(this,"state",{isVisible:!0}),l()(this,"onClose",e=>{this.setState({isVisible:!1}),this.props.onClose("accept"===e)}),l()(this,"getActionButtons",()=>{const e=this.props.options,t=e&&e.isScary,s=h()({"is-scary":t});return[{action:"cancel",label:this.props.cancelButtonText?this.props.cancelButtonText:this.props.translate("Cancel"),additionalClassNames:"is-cancel"},{action:"accept",label:this.props.confirmButtonText?this.props.confirmButtonText:this.props.translate("OK"),isPrimary:!0,additionalClassNames:s}]})}render(){return this.state.isVisible?r.a.createElement(m.a,{buttons:this.getActionButtons(),onClose:this.onClose,className:"accept-dialog",isVisible:!0},this.props.message):null}}l()(g,"displayName","AcceptDialog"),l()(g,"propTypes",{translate:d.a.func,message:d.a.node,onClose:d.a.func.isRequired,confirmButtonText:d.a.node,cancelButtonText:d.a.node,options:d.a.object});var b=Object(p.localize)(g);t.a=function(e,t,s,i,n){let a=document.createElement("div");document.body.appendChild(a),o.a.render(r.a.createElement(b,{message:e,onClose:function(e){a&&(o.a.unmountComponentAtNode(a),document.body.removeChild(a),a=null),t&&t(e)},confirmButtonText:s,cancelButtonText:i,options:n}),a)}},"./client/lib/build-url/index.js":function(e,t,s){"use strict";var i=s("./node_modules/lodash/lodash.js"),o=s("./node_modules/url/url.js"),n=s.n(o);t.a=function(e,t){let s=n.a.parse(e,!0);return t?s.query.s=t:delete s.query.s,s=Object(i.pick)(s,"pathname","hash","query"),n.a.format(s).replace(/\%20/g,"+")}},"./client/lib/popup-monitor/index.js":function(e,t,s){"use strict";var i=s("./client/lib/mixins/emitter/index.js");function o(){this.intervals={},this.monitorInterval=null,this.windowInstance=null,this.onMessage=(e=>{e.source===this.windowInstance&&this.emit("message",e.data)})}Object(i.a)(o.prototype),o.prototype.open=function(e,t,s){return t=t||Date.now(),this.windowInstance=window.open(e,t,s),this.startMonitoring(t,this.windowInstance),window.addEventListener("message",this.onMessage,!1),this},o.prototype.getScreenCenterSpecs=function(e,t){let s=void 0!==window.screenTop?window.screenTop:window.screenY,i=void 0!==window.screenLeft?window.screenLeft:window.screenX;return["width="+e,"height="+t,"top="+(s+window.innerHeight/2-t/2),"left="+(i+window.innerWidth/2-e/2)].join()},o.prototype.isOpen=function(e){let t=!1;try{t=this.intervals[e]&&this.intervals[e].closed}catch(e){}return!t},o.prototype.checkStatus=function(){for(const e in this.intervals)this.intervals.hasOwnProperty(e)&&!this.isOpen(e)&&(this.emit("close",e),delete this.intervals[e]);0===Object.keys(this.intervals).length&&(clearInterval(this.monitorInterval),delete this.monitorInterval,window.removeEventListener("message",this.onMessage))},o.prototype.startMonitoring=function(e,t){this.monitorInterval||(this.monitorInterval=setInterval(this.checkStatus.bind(this),100)),this.intervals[e]=t},t.a=o},"./client/lib/react-smart-set-state/index.js":function(e,t,s){"use strict";function i(e){return!!Object.keys(e).some(function(t){return!(this.state&&this.state.hasOwnProperty(t))||this.state[t]!==e[t]},this)&&(this.setState(e),!0)}s.d(t,"a",function(){return i})},"./client/lib/search-url/index.js":function(e,t,s){"use strict";s.d(t,"a",function(){return l});var i=s("./node_modules/page/page.js"),o=s.n(i),n=s("./client/lib/build-url/index.js"),r=s("./node_modules/debug/src/browser.js");const a=s.n(r)()("calypso:search-url");function l(e,t,s){if(s)return void s(e);const i=Object(n.a)(window.location.href,e);a("search posts for:",e),t&&e?(a("replacing URL: "+i),o.a.replace(i)):(a("setting URL: "+i),o.a.show(i))}},"./client/lib/sharing/index.js":function(e,t,s){"use strict";var i=s("./client/lib/popup-monitor/index.js");t.a=((e,t)=>{const s=new i.a;let o;s.open(e,null,"toolbar=0,location=0,status=0,menubar=0,"+s.getScreenCenterSpecs(780,700)),s.once("close",()=>{let e=null;o&&o.keyring_id&&(e=Number(o.keyring_id)),t(e)}),s.on("message",e=>o=e)})},"./client/my-sites/marketing/connections/service-action.jsx":function(e,t,s){"use strict";var i=s("./node_modules/prop-types/index.js"),o=s.n(i),n=s("./node_modules/react/index.js"),r=s.n(n),a=s("./node_modules/react-redux/es/index.js"),l=s("./node_modules/lodash/lodash.js"),c=s("./packages/i18n-calypso/dist/esm/index.js"),d=s("./client/state/ui/selectors.js"),p=s("./client/components/button/index.jsx"),u=s("./client/state/analytics/actions.js"),h=s("./client/state/sharing/publicize/selectors.js"),m=s("./client/state/selectors/get-current-route-parameterized.js");const g=e=>{let t,s=e.isConnecting,i=e.isDisconnecting,o=e.isRefreshing,n=e.onAction,a=e.removableConnections,l=e.service,c=e.status,d=e.translate,u=e.recordTracksEvent,h=e.path,m=!1;const g="unknown"===c||i||o||s,b=e=>{e.stopPropagation(),n()};return"unknown"===c?t=d("Loading",{context:"Sharing: Publicize status pending button label"}):i?t=d("Disconnecting",{context:"Sharing: Publicize disconnect pending button label"}):o?(t=d("Reconnecting",{context:"Sharing: Publicize reconnect pending button label"}),m=!0):s?t=d("Connecting",{context:"Sharing: Publicize connect pending button label"}):"connected"===c||"must-disconnect"===c?(t=a.length>1?d("Disconnect All",{context:"Sharing: Publicize disconnect button label"}):d("Disconnect",{context:"Sharing: Publicize disconnect button label"}),"must-disconnect"===c&&(m=!0)):"reconnect"===c?(t=d("Reconnect",{context:"Sharing: Publicize reconnect pending button label"}),m=!0):t=d("Connect",{context:"Sharing: Publicize connect pending button label"}),"google_plus"===l.ID&&1>a.length?(t=d("Unavailable",{context:"Sharing: Publicize connect unavailable button label"}),r.a.createElement(p.a,{compact:!0,disabled:!0},t)):"mailchimp"===l.ID&&"not-connected"===c?r.a.createElement("div",null,r.a.createElement(p.a,{className:"connections__signup",compact:!0,href:"https://public-api.wordpress.com/rest/v1.1/sharing/mailchimp/signup",onClick:()=>(u("calypso_connections_signup_button_click",{service:"mailchimp",path:h}),!0),target:"_blank",disabled:g},d("Sign up")),r.a.createElement(p.a,{scary:m,compact:!0,onClick:b,disabled:g},t)):r.a.createElement(p.a,{scary:m,compact:!0,onClick:b,disabled:g},t)};g.propTypes={isConnecting:o.a.bool,isDisconnecting:o.a.bool,isRefreshing:o.a.bool,onAction:o.a.func,removableConnections:o.a.arrayOf(o.a.object),service:o.a.object.isRequired,status:o.a.string,translate:o.a.func,recordTracksEvent:o.a.func},g.defaultProps={isConnecting:!1,isDisconnecting:!1,isRefreshing:!1,onAction:()=>{},removableConnections:[],status:"unknown",translate:l.identity},t.a=Object(a.b)((e,t)=>{let s=t.service;const i=Object(d.e)(e);return{removableConnections:Object(h.b)(e,s.ID),path:Object(m.a)(e,i)}},{recordTracksEvent:u.i})(Object(c.localize)(g))},"./client/my-sites/media-library/content.scss":function(e,t,s){},"./client/my-sites/media-library/drop-zone.jsx":function(e,t,s){"use strict";s.d(t,"a",function(){return m});var i=s("./node_modules/@babel/runtime/helpers/defineProperty.js"),o=s.n(i),n=s("./node_modules/prop-types/index.js"),r=s.n(n),a=s("./node_modules/react/index.js"),l=s.n(a),c=s("./node_modules/lodash/lodash.js"),d=s("./client/lib/analytics/index.js"),p=s("./client/components/drop-zone/index.jsx"),u=s("./client/lib/media/actions.js"),h=s("./client/lib/site/utils.js");class m extends l.a.Component{constructor(){super(...arguments),o()(this,"uploadFiles",e=>{this.props.site&&(u.a.clearValidationErrors(this.props.site.ID),u.a.add(this.props.site,e),this.props.onAddMedia(),this.props.trackStats&&d.default.mc.bumpStat("editor_upload_via","drop"))}),o()(this,"isValidTransfer",e=>!!e&&(!e.mozSourceNode&&(!e.types||-1!==Array.prototype.indexOf.call(e.types,"Files"))))}render(){return Object(h.g)("upload_files",this.props.site)?l.a.createElement(p.a,{fullScreen:this.props.fullScreen,onVerifyValidTransfer:this.isValidTransfer,onFilesDrop:this.uploadFiles}):null}}o()(m,"displayName","MediaLibraryDropZone"),o()(m,"propTypes",{site:r.a.object,fullScreen:r.a.bool,onAddMedia:r.a.func,trackStats:r.a.bool}),o()(m,"defaultProps",{fullScreen:!0,onAddMedia:c.noop,trackStats:!0})},"./client/my-sites/media-library/index.jsx":function(e,t,s){"use strict";var i=s("./node_modules/@babel/runtime/helpers/defineProperty.js"),o=s.n(i),n=s("./node_modules/react/index.js"),r=s.n(n),a=s("./node_modules/classnames/index.js"),l=s.n(a),c=s("./node_modules/lodash/lodash.js"),d=s("./node_modules/prop-types/index.js"),p=s.n(d),u=s("./node_modules/react-redux/es/index.js"),h=s("./node_modules/page/page.js"),m=s.n(h),g=s("./packages/i18n-calypso/dist/esm/index.js"),b=s("./client/lib/analytics/index.js"),f=s("./client/lib/analytics/track-component-view/index.jsx"),j=s("./client/components/notice/index.jsx"),y=s("./client/components/notice/notice-action.jsx"),x=s("./client/lib/media/actions.js"),v=s("./client/lib/media/list-store.js"),E=s("./client/lib/react-pass-to-children/index.js"),_={getMimeBaseTypeFromFilter:function(e){let t;switch(e){case"images":t="image/";break;case"audio":t="audio/";break;case"videos":t="video/";break;case"documents":t="application/";break;default:t=""}return t}};function I(e){return{media:v.a.getAll(e),mediaHasNextPage:v.a.hasNextPage(e),mediaFetchingNextPage:v.a.isFetchingNextPage(e)}}class S extends r.a.Component{constructor(){super(...arguments),o()(this,"state",I(this.props.siteId)),o()(this,"getQuery",e=>{const t={};return(e=e||this.props).search&&(t.search=e.search),e.filter&&!e.source&&("this-post"===e.filter?e.postId&&(t.post_ID=e.postId):t.mime_type=_.getMimeBaseTypeFromFilter(e.filter)),e.source&&(t.source=e.source,t.path="recent"),t}),o()(this,"fetchData",()=>{x.a.fetchNextPage(this.props.siteId)}),o()(this,"updateStateData",()=>{this.setState(I(this.props.siteId))})}componentWillMount(){x.a.setQuery(this.props.siteId,this.getQuery()),v.a.on("change",this.updateStateData),this.updateStateData()}componentWillUnmount(){v.a.off("change",this.updateStateData)}componentWillReceiveProps(e){const t=this.getQuery(e);this.props.siteId===e.siteId&&Object(c.isEqual)(t,this.getQuery())||(x.a.setQuery(e.siteId,t),this.setState(I(e.siteId)))}render(){return Object(E.a)(this,Object(c.assign)({},this.state,{mediaOnFetchNextPage:this.fetchData}))}}o()(S,"displayName","MediaListData"),o()(S,"propTypes",{siteId:p.a.number.isRequired,source:p.a.string,postId:p.a.number,filter:p.a.string,search:p.a.string});var O=s("./client/components/data/media-library-selected-data/index.jsx"),C=s("./client/lib/media/constants.js"),P=s("./client/state/sites/selectors.js"),w=s("./client/components/gridicon/index.jsx"),R=s("./client/components/popover/menu.jsx"),k=s("./client/components/popover/menu-item.jsx"),N=s("./client/components/forms/range/index.jsx"),T=s("./client/components/segmented-control/index.jsx"),D=s("./client/components/segmented-control/item.jsx"),M=s("./client/state/preferences/actions.js"),L=s("./client/state/preferences/selectors.js");const H=100,U=.32;class A extends n.Component{constructor(){super(...arguments),this.onScaleChange=this.onScaleChange.bind(this),this.savePreference=this.savePreference.bind(this),this.debouncedSavePreference=Object(c.debounce)(this.savePreference,1e3),this.setScaleToMobileGrid=this.setScale.bind(this,U),this.setScaleToMobileFull=this.setScale.bind(this,1),this.state={}}componentWillUnmount(){this.debouncedSavePreference.cancel()}savePreference(e){this.props.saveMediaScalePreference(e)}setScale(e){e!==this.props.scale&&(this.props.onChange(e),this.props.setMediaScalePreference(e),this.debouncedSavePreference(e))}onScaleChange(e){const t=parseInt(e.target.value,10),s=t*C.g.length/H,i=C.g[Math.floor(s)];this.setState({sliderPosition:t}),this.setScale(i)}getSliderPosition(){if(this.state.hasOwnProperty("sliderPosition"))return this.state.sliderPosition;const e=this.props.scale,t=C.g.indexOf(e);return-1===t?0:Math.floor(t*(H-1)/(C.g.length-1))}render(){const e=this.props,t=e.translate,s=e.scale;return r.a.createElement("div",{className:"media-library__scale"},r.a.createElement(T.a,{className:"media-library__scale-toggle",compact:!0},r.a.createElement(D.a,{selected:1!==s,onClick:this.setScaleToMobileGrid,title:t("Grid")},r.a.createElement(w.a,{icon:"grid",size:18})),r.a.createElement(D.a,{selected:1===s,onClick:this.setScaleToMobileFull,title:t("List")},r.a.createElement(w.a,{icon:"menu",size:18}))),r.a.createElement(N.a,{step:"1",min:"0",max:H-1,minContent:r.a.createElement(w.a,{icon:"image",size:12}),maxContent:r.a.createElement(w.a,{icon:"image",size:24}),value:this.getSliderPosition(),onChange:this.onScaleChange,className:"media-library__scale-range"}))}}o()(A,"propTypes",{mediaScale:p.a.number,onChange:p.a.func,setMediaScalePreference:p.a.func,saveMediaScalePreference:p.a.func}),o()(A,"defaultProps",{onChange:()=>{}});var F=Object(u.b)(e=>({scale:Object(L.b)(e,"mediaScale")}),{setMediaScalePreference:Object(c.partial)(M.c,"mediaScale"),saveMediaScalePreference:Object(c.partial)(M.b,"mediaScale")})(Object(g.localize)(A)),V=s("./client/my-sites/media-library/upload-button.jsx"),q=s("./client/components/forms/form-text-input/index.jsx"),B=s("./client/components/screen-reader-text/index.js");s("./client/my-sites/media-library/upload-url.scss");class z extends n.Component{constructor(){super(...arguments),o()(this,"state",{value:"",isError:!1}),o()(this,"upload",e=>{e.preventDefault();const t=!e.target.checkValidity();this.setState({isError:t}),!t&&this.props.site&&(x.a.clearValidationErrors(this.props.site.ID),x.a.add(this.props.site,this.state.value),this.setState({value:"",isError:!1}),this.props.onAddMedia(),this.props.onClose(),b.default.mc.bumpStat("editor_upload_via","url"))}),o()(this,"onChange",e=>{this.setState({isError:!1,value:e.target.value})}),o()(this,"onKeyDown",e=>{if("Escape"===e.key)return this.props.onClose(e);"Enter"===e.key&&this.upload(e)})}render(){const e=l()("media-library__upload-url",this.props.className),t=this.props,s=t.onClose,i=t.translate;return r.a.createElement("form",{className:e,onSubmit:this.upload,noValidate:!0},r.a.createElement(q.a,{type:"url",value:this.state.value,placeholder:"https://",onChange:this.onChange,onKeyDown:this.onKeyDown,isError:this.state.isError,autoFocus:!0,required:!0}),r.a.createElement("div",{className:"media-library__upload-url-button-group"},r.a.createElement("button",{type:"submit",className:"button is-primary"},i("Upload",{context:"verb"})),r.a.createElement("button",{type:"button",className:"media-library__upload-url-cancel",onClick:s},r.a.createElement(B.a,null,i("Cancel")),r.a.createElement(w.a,{icon:"cross"}))))}}o()(z,"propTypes",{className:p.a.string,site:p.a.object,onAddMedia:p.a.func,onClose:p.a.func}),o()(z,"defaultProps",{onAddMedia:c.noop,onClose:c.noop});var G=Object(g.localize)(z),W=s("./client/lib/site/utils.js"),Y=s("./node_modules/@babel/runtime/helpers/extends.js"),K=s.n(Y),Q=s("./client/lib/media/utils.js"),J=s("./client/state/current-user/selectors.js"),Z=s("./client/state/ui/media-modal/selectors.js"),X=s("./client/state/ui/editor/actions.js"),$=s("./client/state/ui/media-modal/constants.js"),ee=s("./client/state/analytics/actions.js"),te=s("./client/components/button/index.jsx");class se extends n.Component{getButtons(){const e=this.props,t=e.disabled,s=e.selectedItems,i=e.site,o=e.translate,n=e.user,r=e.view,a=e.onDelete,l=e.onViewDetails,d=[];$.a.LIST===r&&s.length&&d.push({key:"edit",text:o("Edit"),disabled:t,primary:!0,onClick:l});const p=s.length&&Object(c.every)(s,e=>Object(Q.a)(e,n,i));if($.a.GALLERY!==r&&p){const e=t||Object(c.some)(s,"transient");d.push({key:"delete",icon:"trash",className:"editor-media-modal__delete",disabled:e,onClick:e?c.noop:a})}return d}render(){return r.a.createElement("div",null,this.getButtons().map(e=>r.a.createElement(te.a,K()({className:l()("editor-media-modal__secondary-action",e.className),"data-e2e-button":e.key,compact:!0},Object(c.pick)(e,["key","disabled","onClick","primary"])),e.icon&&r.a.createElement(w.a,{icon:e.icon}),e.text&&e.text)))}}o()(se,"propTypes",{user:p.a.object,site:p.a.object,selectedItems:p.a.array,view:p.a.oneOf(Object(c.values)($.a)),disabled:p.a.bool,onDelete:p.a.func,onViewDetails:p.a.func}),o()(se,"defaultProps",{disabled:!1,onDelete:c.noop});var ie=Object(u.b)((e,t)=>({view:Object(Z.a)(e),user:Object(J.b)(e),siteSlug:t.site?Object(P.v)(e,t.site.ID):""}),{onViewDetails:Object(c.flow)(Object(ee.k)(Object(ee.a)("editor_media_actions","edit_button_dialog")),Object(ee.k)(Object(ee.g)("Media","Clicked Dialog Edit Button")),Object(c.partial)(X.l,$.a.DETAIL))},function(e,t,s){return Object.assign({},s,e,t,Object(c.pick)(s,["onViewDetails","view"]))})(Object(g.localize)(se)),oe=s("./client/components/card/index.jsx"),ne=s("./client/components/button-group/index.jsx"),re=s("./client/components/sticky-panel/index.jsx");class ae extends r.a.Component{constructor(){super(...arguments),o()(this,"state",{addingViaUrl:!1,isMoreOptionsVisible:!1}),o()(this,"setMoreOptionsContext",e=>{e&&this.setState({moreOptionsContext:e})}),o()(this,"toggleAddViaUrl",e=>{this.setState({addingViaUrl:e,isMoreOptionsVisible:!1})}),o()(this,"toggleMoreOptions",e=>{this.setState({isMoreOptionsVisible:e})}),o()(this,"renderUploadButtons",()=>{const e=this.props,t=e.site,s=e.filter,i=e.onAddMedia;if(Object(W.g)("upload_files",t))return r.a.createElement(ne.a,{className:"media-library__upload-buttons"},r.a.createElement(V.a,{site:t,filter:s,onAddMedia:i,className:"button is-compact"},r.a.createElement(w.a,{icon:"add-image"}),r.a.createElement("span",{className:"is-desktop"},this.props.translate("Add New",{context:"Media upload"}))),r.a.createElement(te.a,{compact:!0,ref:this.setMoreOptionsContext,onClick:this.toggleMoreOptions.bind(this,!this.state.isMoreOptionsVisible),className:"button media-library__upload-more","data-tip-target":"media-library-upload-more"},r.a.createElement(B.a,null,this.props.translate("More Options")),r.a.createElement(w.a,{icon:"chevron-down",size:20}),r.a.createElement(R.a,{context:this.state.moreOptionsContext,isVisible:this.state.isMoreOptionsVisible,onClose:this.toggleMoreOptions.bind(this,!1),position:"bottom right",className:"is-dialog-visible media-library__header-popover"},r.a.createElement(k.a,{onClick:this.toggleAddViaUrl.bind(this,!0)},this.props.translate("Add via URL",{context:"Media upload"})))))})}render(){const e=this.props,t=e.site,s=e.onAddMedia;if(this.state.addingViaUrl)return r.a.createElement(G,{site:t,onAddMedia:s,onClose:this.toggleAddViaUrl.bind(this,!1),className:"media-library__header"});const i=r.a.createElement(oe.a,{className:"media-library__header"},this.renderUploadButtons(),r.a.createElement(ie,{selectedItems:this.props.selectedItems,onViewDetails:this.props.onViewDetails,onDelete:this.props.onDeleteItem,site:this.props.site,view:"LIST"}),r.a.createElement(F,{onChange:this.props.onMediaScaleChange}));return this.props.sticky?r.a.createElement(re.a,{minLimit:660},i):i}}o()(ae,"displayName","MediaLibraryHeader"),o()(ae,"propTypes",{site:p.a.object,filter:p.a.string,sliderPositionCount:p.a.number,onMediaScaleChange:p.a.func,onAddMedia:p.a.func,sticky:p.a.bool}),o()(ae,"defaultProps",{onAddMedia:()=>{},sliderPositionCount:100,sticky:!1});var le=Object(g.localize)(ae);const ce=250;class de extends r.a.Component{constructor(e){super(e),o()(this,"onCopy",()=>{const e=this.props,t=e.site,s=e.selectedItems,i=e.source;(0,e.onSourceChange)("",()=>{x.a.addExternal(t,s,i)})}),this.handleClick=this.onClick.bind(this),this.handleMedia=this.onUpdateState.bind(this),this.handleFetchOn=this.onSetFetch.bind(this),this.handleFetchOff=Object(c.debounce)(this.onDisableFetch.bind(this),ce),this.state=this.getState()}onSetFetch(){this.handleFetchOff.cancel(),this.setState({fetching:!0})}onDisableFetch(){this.setState({fetching:!1})}componentDidMount(){v.a.on("change",this.handleMedia)}componentWillUnmount(){this.handleFetchOff.cancel(),v.a.off("change",this.handleMedia)}onUpdateState(){this.getState().fetching?this.handleFetchOn():this.handleFetchOff()}getState(){return{fetching:v.a.isFetchingNextPage(this.props.site.ID)}}onClick(){const e=this.props.site.ID;x.a.sourceChanged(e),x.a.fetchNextPage(e)}renderCopyButton(){const e=this.props,t=e.selectedItems,s=e.translate;return r.a.createElement(te.a,{compact:!0,disabled:0===t.length,onClick:this.onCopy,primary:!0},s("Copy to media library"))}renderPexelsAttribution(){const e=(0,this.props.translate)("Photos provided by {{a}}Pexels{{/a}}",{components:{a:r.a.createElement("a",{href:"https://www.pexels.com/",rel:"noopener noreferrer",target:"_blank"})}});return r.a.createElement("span",{className:"media-library__pexels-attribution"},e)}renderCard(){const e=this.props,t=e.onMediaScaleChange,s=e.translate,i=e.canCopy,o=e.hasRefreshButton,n=e.hasAttribution;return r.a.createElement(oe.a,{className:"media-library__header"},n&&this.renderPexelsAttribution(),o&&r.a.createElement(te.a,{compact:!0,disabled:this.state.fetching,onClick:this.handleClick},r.a.createElement(w.a,{icon:"refresh",size:24}),s("Refresh")),i&&this.renderCopyButton(),r.a.createElement(F,{onChange:t}))}render(){return this.props.visible?this.props.sticky?r.a.createElement(re.a,{minLimit:660},this.renderCard()):this.renderCard():null}}o()(de,"propTypes",{onMediaScaleChange:p.a.func,site:p.a.object.isRequired,visible:p.a.bool.isRequired,canCopy:p.a.bool,selectedItems:p.a.array,onSourceChange:p.a.func,sticky:p.a.bool,hasAttribution:p.a.bool,hasRefreshButton:p.a.bool});var pe=Object(g.localize)(de),ue=s("./node_modules/react-dom/index.js"),he=s.n(ue),me=s("./client/my-sites/media-library/list-item.jsx"),ge=s("./client/my-sites/no-results/index.jsx");class be extends r.a.Component{constructor(){super(...arguments),o()(this,"getLabel",()=>{let e;switch(this.props.filter){case"images":e=this.props.translate("No images match your search for {{searchTerm/}}.",{components:{searchTerm:r.a.createElement("em",null,this.props.search)},context:"Media no search results"});break;case"videos":e=this.props.translate("No videos match your search for {{searchTerm/}}.",{components:{searchTerm:r.a.createElement("em",null,this.props.search)},context:"Media no search results"});break;case"audio":e=this.props.translate("No audio files match your search for {{searchTerm/}}.",{components:{searchTerm:r.a.createElement("em",null,this.props.search)},context:"Media no search results"});break;case"documents":e=this.props.translate("No documents match your search for {{searchTerm/}}.",{components:{searchTerm:r.a.createElement("em",null,this.props.search)},context:"Media no search results"});break;default:e=this.props.translate("No media files match your search for {{searchTerm/}}.",{components:{searchTerm:r.a.createElement("em",null,this.props.search)},context:"Media no search results"})}return e})}render(){return r.a.createElement(ge.a,{text:this.getLabel(),image:"/calypso/images/pages/illustration-pages.svg"})}}o()(be,"displayName","MediaLibraryListNoResults"),o()(be,"propTypes",{filter:p.a.string,search:p.a.string}),o()(be,"defaultProps",{search:""});var fe=Object(g.localize)(be),je=s("./client/components/empty-content/index.jsx");class ye extends n.Component{getLabel(){const e=this.props,t=e.filter,s=e.source,i=e.translate;if("google_photos"===s)return i("You don't have any photos in your Google library.",{comment:"Media no results"});if("pexels"===s)return i("Use the search above to find free photos!",{comment:"Media no results"});switch(t){case"this-post":return i("There are no media items uploaded to this post.",{comment:"Media no results"});case"images":return i("You don't have any images.",{comment:"Media no results"});case"videos":return i("You don't have any videos.",{comment:"Media no results"});case"audio":return i("You don't have any audio files.",{comment:"Media no results"});case"documents":return i("You don't have any documents.",{comment:"Media no results"});default:return i("You don't have any media.",{comment:"Media no results"})}}render(){let e="",t="";return Object(W.g)("upload_files",this.props.site)&&!this.props.source?(e=this.props.translate("Would you like to upload something?"),t=r.a.createElement(V.a,{className:"button is-primary",site:this.props.site},this.props.translate("Upload Media"))):"google_photos"===this.props.source&&(e=this.props.translate("New photos may take a few minutes to appear.")),r.a.createElement(je.a,{title:this.getLabel(),line:e,action:t,illustration:"/calypso/images/media/illustration-media.svg",illustrationWidth:150})}}o()(ye,"propTypes",{site:p.a.object,filter:p.a.string,source:p.a.string});var xe=Object(g.localize)(ye),ve=s("./client/components/infinite-list/index.jsx");const Ee=e=>{let t=e.itemsCount,s=e.itemsPerRow,i=e.lastInRow,o=e.scale,n=e.text;const a=1%o/(s-1)*100||0,l={marginRight:"".concat(i?0:a,"%"),width:"".concat(o*t*100+a*(t-1),"%")};return r.a.createElement("div",{className:"sorted-grid__label",style:l},n)};Ee.propTypes={itemsCount:p.a.number,itemsPerRow:p.a.number,lastInRow:p.a.bool,scale:p.a.number.isRequired,text:p.a.string},Ee.defaultProps={text:""};var _e=Object(u.b)(e=>({scale:Object(L.b)(e,"mediaScale")}),null,null,{pure:!1})(Ee);s("./client/components/sorted-grid/style.scss");class Ie extends n.PureComponent{constructor(){super(...arguments),o()(this,"renderItem",e=>e.isGridLabel?this.renderLabels(e):this.props.renderItem(e))}getItems(){const e=[];for(let t=0;t<this.props.items.length;t+=this.props.itemsPerRow){const s=Object(c.slice)(this.props.items,t,t+this.props.itemsPerRow),i=Object(c.reduce)(Object(c.map)(s,this.props.getItemGroup),(e,t)=>(e[t]=Object(c.get)(e,t,0)+1,e),{});e.push({isGridLabel:!0,id:t,groups:i},...s)}return e}renderLabels(e){return r.a.createElement("div",{key:"header_".concat(e.id),className:"sorted-grid__header"},Object(c.map)(e.groups,(t,s)=>{return""!==this.props.getGroupLabel(s)&&r.a.createElement(_e,{key:"group_".concat(s),text:this.props.getGroupLabel(s),itemsCount:t,itemsPerRow:this.props.itemsPerRow,lastInRow:Object(c.last)(Object(c.keys)(e.groups))===s})}))}render(){const e=Object(c.omit)(this.props,"getGroupLabel","getItemGroup","items","renderItem");return r.a.createElement(ve.a,K()({items:this.getItems(),renderItem:this.renderItem},e))}}o()(Ie,"propTypes",{getGroupLabel:p.a.func.isRequired,getItemGroup:p.a.func.isRequired,items:p.a.array,itemsPerRow:p.a.number.isRequired});var Se=Ie,Oe=s("./client/lib/plans/constants.js"),Ce=s("./client/blocks/upgrade-nudge/index.jsx"),Pe=s("./client/lib/formatting/index.js");class we extends r.a.Component{constructor(){super(...arguments),o()(this,"getTitle",()=>{switch(this.props.filter){case"videos":return this.props.translate("Upload Videos",{textOnly:!0,context:"Media upload plan needed"});case"audio":return this.props.translate("Upload Audio",{textOnly:!0,context:"Media upload plan needed"});default:return this.props.translate("Upload Media",{textOnly:!0,context:"Media upload plan needed"})}}),o()(this,"getSummary",()=>{switch(this.props.filter){case"videos":return Object(Pe.d)(this.props.translate("To upload video files to your site, upgrade your plan.",{textOnly:!0,context:"Media upgrade promo"}),2);case"audio":return Object(Pe.d)(this.props.translate("To upload audio files to your site, upgrade your plan.",{textOnly:!0,context:"Media upgrade promo"}),2);default:return Object(Pe.d)(this.props.translate("To upload audio and video files to your site, upgrade your plan.",{textOnly:!0,context:"Media upgrade promo"}),2)}}),o()(this,"viewPlansPage",()=>{const e=this.props.site.slug,t=void 0===e?"":e;b.default.tracks.recordEvent("calypso_media_plans_button_click"),m()("/plans/".concat(t))})}render(){const e=r.a.createElement(te.a,{className:"button is-primary",onClick:this.viewPlansPage},this.props.translate("See Plans"));return r.a.createElement(je.a,{title:this.getTitle(),line:this.getSummary(),action:this.props.children||e,illustration:""})}}o()(we,"displayName","MediaLibraryListPlanPromo"),o()(we,"propTypes",{site:p.a.object,filter:p.a.string});var Re=Object(g.localize)(we);function ke(e,t){return t("audio"===e?"Upgrade to the Premium Plan and Enable Audio Uploads":"Upgrade to a Premium Plan and Enable VideoPress")}function Ne(e,t){return t("audio"===e?"By upgrading to the Premium plan you'll enable audio upload support on your site.":"By upgrading to a Premium Plan you'll enable VideoPress support on your site.")}const Te=e=>{let t=e.translate,s=e.filter,i=e.site;return r.a.createElement("div",{className:"media-library__videopress-nudge-container"},r.a.createElement(Re,{site:i,filter:s},r.a.createElement(Ce.a,{className:"media-library__videopress-nudge-regular",title:ke(s,t),message:Ne(s,t),feature:"audio"===s?Oe.r:Oe.Rb,event:"calypso_media_uploads_upgrade_nudge"})))};Te.propTypes={site:p.a.object,translate:p.a.func,filter:p.a.string},Te.defaultProps={translate:c.identity,filter:"video"};var De=Object(g.localize)(Te),Me=s("./client/state/selectors/is-rtl.js");class Le extends r.a.Component{constructor(){super(...arguments),o()(this,"state",{}),o()(this,"setListContext",e=>{e&&this.setState({listContext:he.a.findDOMNode(e)})}),o()(this,"getMediaItemHeight",()=>Math.round(this.props.containerWidth*this.props.mediaScale)+this.props.rowPadding),o()(this,"getItemsPerRow",()=>Math.floor(1/this.props.mediaScale)),o()(this,"getMediaItemStyle",e=>{const t=this.getItemsPerRow(),s=t===1/this.props.mediaScale,i=0==(e+1)%t,o={paddingBottom:this.props.rowPadding,fontSize:225*this.props.mediaScale};if(!s&&!i){const e=1%this.props.mediaScale/(t-1)*100+"%";this.props.isRtl?o.marginLeft=e:o.marginRight=e}return o}),o()(this,"toggleItem",(e,t)=>{let s;s=this.props.single?Object(c.filter)(this.props.mediaLibrarySelectedItems,{ID:e.ID}):Object(c.clone)(this.props.mediaLibrarySelectedItems);const i=-1===Object(c.findIndex)(s,{ID:e.ID}),o=Object(c.findIndex)(this.props.media,{ID:e.ID});let n=o,r=o;!this.props.single&&t&&(n=Math.min(n,this.state.lastSelectedMediaIndex),r=Math.max(r,this.state.lastSelectedMediaIndex));for(let e=n;e<=r;e++){const t=Object(c.findIndex)(s,{ID:this.props.media[e].ID});i&&-1===t?s.push(this.props.media[e]):i||-1===t||s.splice(t,1)}this.setState({lastSelectedMediaIndex:o}),this.props.site&&x.a.setLibrarySelectedItems(this.props.site.ID,s)}),o()(this,"getItemRef",e=>"item-"+e.ID),o()(this,"getGroupLabel",e=>{const t=new Date(e),s=new Date;return t.getFullYear()===s.getFullYear()?Object(g.moment)(e).format("MMM D"):Object(g.moment)(e).format("MMM D, YYYY")}),o()(this,"getItemGroup",e=>Object(c.min)([e.date.slice(0,10),Object(g.moment)(new Date).format("YYYY-MM-DD")])),o()(this,"renderItem",e=>{const t=Object(c.findIndex)(this.props.media,{ID:e.ID}),s=this.props.mediaLibrarySelectedItems,i=Object(c.findIndex)(s,{ID:e.ID}),o=this.getItemRef(e),n=!this.props.single&&-1!==i&&1===s.length&&"image"===Object(Q.g)(e);return r.a.createElement(me.a,{ref:o,key:o,style:this.getMediaItemStyle(t),media:e,scale:this.props.mediaScale,thumbnailType:this.props.thumbnailType,showGalleryHelp:n,selectedIndex:i,onToggle:this.toggleItem,onEditItem:this.props.onEditItem})}),o()(this,"renderLoadingPlaceholders",()=>{const e=this.getItemsPerRow(),t=(this.props.media||[]).length,s=e-t%e;return Array.apply(null,new Array(s)).map(function(e,s){return r.a.createElement(me.a,{key:"placeholder-"+s,style:this.getMediaItemStyle(t+s),scale:this.props.mediaScale})},this)})}sourceIsUngrouped(e){return-1!==["pexels"].indexOf(e)}render(){let e=this.getItemGroup,t=this.getGroupLabel;if(this.props.filterRequiresUpgrade)return r.a.createElement(De,{filter:this.props.filter,site:this.props.site});if(!this.props.mediaHasNextPage&&this.props.media&&0===this.props.media.length)return r.a.createElement(this.props.search?fe:xe,{site:this.props.site,filter:this.props.filter,search:this.props.search,source:this.props.source});const s=function(){this.props.mediaOnFetchNextPage()}.bind(this);return this.sourceIsUngrouped(this.props.source)&&(e=(()=>this.props.source),t=(()=>"")),r.a.createElement(Se,{ref:this.setListContext,getItemGroup:e,getGroupLabel:t,context:!!this.props.scrollable&&this.state.listContext,items:this.props.media||[],itemsPerRow:this.getItemsPerRow(),lastPage:!this.props.mediaHasNextPage,fetchingNextPage:this.props.mediaFetchingNextPage,guessedItemHeight:this.getMediaItemHeight(),fetchNextPage:s,getItemRef:this.getItemRef,renderItem:this.renderItem,renderLoadingPlaceholders:this.renderLoadingPlaceholders,className:"media-library__list"})}}o()(Le,"displayName","MediaLibraryList"),o()(Le,"propTypes",{site:p.a.object,media:p.a.arrayOf(p.a.object),mediaLibrarySelectedItems:p.a.arrayOf(p.a.object),filter:p.a.string,filterRequiresUpgrade:p.a.bool.isRequired,search:p.a.string,containerWidth:p.a.number,rowPadding:p.a.number,mediaScale:p.a.number.isRequired,thumbnailType:p.a.string,mediaHasNextPage:p.a.bool,mediaFetchingNextPage:p.a.bool,mediaOnFetchNextPage:p.a.func,single:p.a.bool,scrollable:p.a.bool,onEditItem:p.a.func}),o()(Le,"defaultProps",{mediaLibrarySelectedItems:Object.freeze([]),containerWidth:0,rowPadding:10,mediaHasNextPage:!1,mediaFetchingNextPage:!1,mediaOnFetchNextPage:c.noop,single:!1,scrollable:!1,onEditItem:c.noop});var He=Object(u.b)(e=>({mediaScale:Object(L.b)(e,"mediaScale"),isRtl:Object(Me.a)(e)}),null,null,{pure:!1})(Le),Ue=s("./client/state/sharing/services/selectors.js"),Ae=s("./client/components/data/query-keyring-services/index.jsx"),Fe=s("./client/components/data/query-publicize-connections/index.jsx"),Ve=s("./client/my-sites/marketing/connections/service-action.jsx"),qe=s("./client/state/sharing/keyring/actions.js"),Be=s("./client/state/sharing/keyring/selectors.js"),ze=s("./client/lib/sharing/index.js");const Ge="unknown",We="not-connected",Ye="reconnect",Ke="connected";class Qe extends n.Component{constructor(e){super(e),this.handleAction=this.onAction.bind(this),this.state={isConnecting:!1,isRefreshing:!1}}getConnectionStatus(e,t){return t?Ge:e?"broken"===e.status?Ye:Ke:We}onAction(){const e=this.props.service,t=this.getConnectionStatus(this.props.connectedService,this.state.isFetching);Ye===t?this.refresh(e):this.addConnection(e)}refresh(e){this.setState({isRefreshing:!0}),this.requestAccess(e.refresh_URL),this.trackEvent(e.ID,"Clicked Connect Button")}addConnection(e){this.setState({isConnecting:!0}),this.requestAccess(e.connect_URL),this.trackEvent(e.ID,"Clicked Reconnect Button")}requestAccess(e){Object(ze.a)(e,()=>{this.props.requestKeyringConnections()})}trackEvent(e,t){this.props.recordGoogleEvent("Sharing",t,e)}componentWillReceiveProps(e){!0===e.isFetching&&this.setState({isConnecting:!1,isRefreshing:!1})}render(){const e=this.getConnectionStatus(this.props.connectedService,this.props.isFetching),t=this.state,s=t.isConnecting,i=t.isRefreshing,o=this.props.service;return r.a.createElement(Ve.a,{status:e,service:o,onAction:this.handleAction,isConnecting:s,isRefreshing:i,isDisconnecting:!1})}}o()(Qe,"propTypes",{service:p.a.object.isRequired,isFetching:p.a.bool.isRequired,connectedService:p.a.object});var Je=Object(u.b)((e,t)=>{const s=((e,t)=>Object(Be.b)(e).filter(e=>e.service===t))(e,t.serviceName);return{isFetching:Object(Be.d)(e),connectedService:s.length>0?s[0]:null}},{requestKeyringConnections:qe.c,recordGoogleEvent:ee.g})(Qe);class Ze extends n.Component{render(){const e=this.props.service;return r.a.createElement("div",null,r.a.createElement(Fe.a,{selectedSite:!0}),r.a.createElement(Ae.a,null),e&&r.a.createElement(Je,{service:e}))}}o()(Ze,"propTypes",{serviceName:p.a.string.isRequired});var Xe=Object(u.b)((e,t)=>({service:Object(Ue.b)(e,t.serviceName)}))(Ze),$e=s("./client/state/ui/guided-tours/actions.js"),et=s("./client/state/ui/guided-tours/selectors/index.js"),tt=s("./client/state/notices/actions.js"),st=s("./client/lib/redux-bridge/index.js");s("./client/my-sites/media-library/content.scss");class it extends r.a.Component{constructor(){super(...arguments),o()(this,"retryList",()=>{x.a.sourceChanged(this.props.site.ID)}),o()(this,"goToSharing",e=>{e.preventDefault(),m()("/marketing/connections/".concat(this.props.site.slug))})}componentDidUpdate(e){this.props.shouldPauseGuidedTour!==e.shouldPauseGuidedTour&&this.props.toggleGuidedTour(this.props.shouldPauseGuidedTour),!this.hasGoogleExpired(e)&&this.hasGoogleExpired(this.props)&&this.props.googleConnection&&this.props.deleteKeyringConnection(this.props.googleConnection),!this.isGoogleConnectedAndVisible(e)&&this.isGoogleConnectedAndVisible(this.props)&&this.hasGoogleExpired(this.props)&&x.a.sourceChanged(this.props.site.ID)}isGoogleConnectedAndVisible(e){const t=e.googleConnection;return!("google_photos"!==e.source||!t||"ok"!==t.status)}hasGoogleExpired(e){const t=e.mediaValidationErrorTypes;return"google_photos"===e.source&&-1!==t.indexOf(C.i.SERVICE_AUTH_FAILED)}renderErrors(){const e=this.props,t=e.mediaValidationErrorTypes,s=e.site,i=e.translate;return Object(c.map)(Object(c.groupBy)(t),(e,t)=>{let o,n;const a={count:e.length,args:e.length};s&&(n=x.a.clearValidationErrorsByType.bind(null,s.ID,t));let l="is-error",c=void 0,d=void 0,p=!1;switch(t){case C.i.FILE_TYPE_NOT_IN_PLAN:l="is-warning",c="plan-media-storage-error-video",d="video-upload",o=i("%d file could not be uploaded because your site does not support video files. Upgrade to a premium plan for video support.","%d files could not be uploaded because your site does not support video files. Upgrade to a premium plan for video support.",a);break;case C.i.FILE_TYPE_UNSUPPORTED:o=i("%d file could not be uploaded because the file type is not supported.","%d files could not be uploaded because their file types are unsupported.",a);break;case C.i.UPLOAD_VIA_URL_404:o=i("%d file could not be uploaded because no image exists at the specified URL.","%d files could not be uploaded because no images exist at the specified URLs",a);break;case C.i.EXCEEDS_MAX_UPLOAD_SIZE:o=i("%d file could not be uploaded because it exceeds the maximum upload size.","%d files could not be uploaded because they exceed the maximum upload size.",a);break;case C.i.NOT_ENOUGH_SPACE:c="plan-media-storage-error",d="extra-storage",o=i("%d file could not be uploaded because there is not enough space left.","%d files could not be uploaded because there is not enough space left.",a);break;case C.i.EXCEEDS_PLAN_STORAGE_LIMIT:c="plan-media-storage-error",d="extra-storage",o=i("%d file could not be uploaded because you have reached your plan storage limit.","%d files could not be uploaded because you have reached your plan storage limit.",a);break;case C.i.SERVICE_AUTH_FAILED:o=this.getAuthFailMessageForSource(),l="is-warning",p=!1;break;case C.i.SERVICE_FAILED:o=i("We are unable to retrieve your full media library."),p=!0;break;default:o=i("%d file could not be uploaded because an error occurred while uploading.","%d files could not be uploaded because errors occurred while uploading.",a)}return r.a.createElement(j.b,{key:t,status:l,text:o,onDismissClick:n},this.renderNoticeAction(c,d),p&&this.renderTryAgain())})}getAuthFailMessageForSource(){const e=this.props,t=e.translate;return t("google_photos"===e.source?"We are moving to a new and faster Photos from Google service. Please reconnect to continue accessing your photos.":"Your service has been disconnected. Please reconnect to continue.")}renderTryAgain(){return r.a.createElement(y.a,{onClick:this.retryList},this.props.translate("Retry"))}renderNoticeAction(e,t){if(!e)return null;const s={cta_name:e,cta_feature:t};return r.a.createElement(y.a,{external:!0,href:t?"/plans/compare/".concat(this.props.siteSlug,"?feature=").concat(t):"/plans/".concat(this.props.siteSlug),onClick:this.recordPlansNavigation.bind(this,"calypso_upgrade_nudge_cta_click",s)},this.props.translate("Upgrade Plan"),r.a.createElement(f.a,{eventName:"calypso_upgrade_nudge_impression",eventProperties:s}))}recordPlansNavigation(e,t){b.default.ga.recordEvent("Media","Clicked Upload Error Action"),b.default.tracks.recordEvent(e,t)}renderGooglePhotosConnect(){const e=this.props.translate("To show your Google Photos library you need to connect your Google account.");return r.a.createElement("div",{className:"media-library__connect-message"},r.a.createElement("p",null,r.a.createElement("img",{src:"/calypso/images/sharing/google-photos-connect.png",width:"400",alt:""})),r.a.createElement("p",null,e),r.a.createElement(Xe,{serviceName:"google_photos"}))}renderConnectExternalMedia(){switch(this.props.source){case"google_photos":return this.renderGooglePhotosConnect()}return null}getThumbnailType(){return""!==this.props.source?C.e:C.d}needsToBeConnected(){const e=this.props,t=e.source,s=e.isConnected;return""!==t&&!s||!(""===t||!s||!this.hasGoogleExpired(this.props))}renderMediaList(){return!this.props.site||this.props.isRequesting&&!this.hasRequested?(this.hasRequested=!0,r.a.createElement(He,{key:"list-loading",filterRequiresUpgrade:this.props.filterRequiresUpgrade})):this.needsToBeConnected()?this.renderConnectExternalMedia():r.a.createElement(S,{siteId:this.props.site.ID,postId:this.props.postId,filter:this.props.filter,search:this.props.search,source:this.props.source},r.a.createElement(O.a,{siteId:this.props.site.ID},r.a.createElement(He,{key:"list-"+[this.props.site.ID,this.props.search,this.props.filter].join(),site:this.props.site,filter:this.props.filter,filterRequiresUpgrade:this.props.filterRequiresUpgrade,search:this.props.search,containerWidth:this.props.containerWidth,thumbnailType:this.getThumbnailType(),single:this.props.single,scrollable:this.props.scrollable,onEditItem:this.props.onEditItem})))}renderHeader(){return this.needsToBeConnected()?null:""!==this.props.source?r.a.createElement(pe,{onMediaScaleChange:this.props.onMediaScaleChange,site:this.props.site,visible:!this.props.isRequesting,canCopy:void 0===this.props.postId,source:this.props.source,onSourceChange:this.props.onSourceChange,selectedItems:this.props.selectedItems,sticky:!this.props.scrollable,hasAttribution:"pexels"===this.props.source,hasRefreshButton:"pexels"!==this.props.source}):this.props.filterRequiresUpgrade?null:r.a.createElement(le,{site:this.props.site,filter:this.props.filter,onMediaScaleChange:this.props.onMediaScaleChange,onAddMedia:this.props.onAddMedia,onAddAndEditImage:this.props.onAddAndEditImage,selectedItems:this.props.selectedItems,onViewDetails:this.props.onViewDetails,onDeleteItem:this.props.onDeleteItem,sticky:!this.props.scrollable})}render(){return r.a.createElement("div",{className:"media-library__content"},this.renderHeader(),this.renderErrors(),this.renderMediaList())}}o()(it,"propTypes",{site:p.a.object,mediaValidationErrors:p.a.object,filter:p.a.string,filterRequiresUpgrade:p.a.bool,search:p.a.string,source:p.a.string,containerWidth:p.a.number,single:p.a.bool,scrollable:p.a.bool,onAddMedia:p.a.func,onMediaScaleChange:p.a.func,onEditItem:p.a.func,postId:p.a.number,isConnected:p.a.bool}),o()(it,"defaultProps",{mediaValidationErrors:Object.freeze({}),onAddMedia:c.noop,source:""});var ot=Object(u.b)((e,t)=>{const s=Object(et.a)(e),i=Object(c.values)(t.mediaValidationErrors).map(c.head),o=!Object(c.isEmpty)(s.tour)&&0<Object(c.size)(i),n=Object(Be.c)(e,"google_photos");return{siteSlug:t.site?Object(P.v)(e,t.site.ID):"",isRequesting:Object(Be.d)(e),mediaValidationErrorTypes:i,shouldPauseGuidedTour:o,googleConnection:1===n.length?n[0]:null}},()=>({toggleGuidedTour:e=>{Object(st.b)(e?Object($e.b)():Object($e.f)())},deleteKeyringConnection:e=>{const t=Object(tt.h)(()=>Object(qe.a)(e));Object(st.b)(t())}}),null,{pure:!1})(Object(g.localize)(it)),nt=s("./client/my-sites/media-library/drop-zone.jsx"),rt=s("./client/lib/media/library-selected-store.js"),at=function(e){let t;switch(e){case"images":t="image";break;case"audio":t="audio";break;case"videos":t="video";break;case"documents":t="application"}return t},lt=s("./client/components/section-nav/index.jsx"),ct=s("./client/components/section-nav/tabs.jsx"),dt=s("./client/components/section-nav/item.jsx"),pt=s("./client/components/search/index.jsx"),ut=s("./client/blocks/plan-storage/index.jsx");var ht=()=>r.a.createElement("svg",{className:"gridicon",viewBox:"0 0 48 48",height:"24",width:"24",xmlns:"http://www.w3.org/2000/svg"},r.a.createElement("path",{fill:"none",d:"M0 0h48v48H0V0z"}),r.a.createElement("path",{d:"M12.63 14l-8.89 8.96c-.1.11-.26.36-.26.52 0 .32.2.52.52.52h14c2.28 0 4-1.72 4-4v-6h-9.37zM44 24H30c-2.28 0-4 1.72-4 4v6h9.37l8.89-8.96c.1-.11.26-.36.26-.52 0-.32-.2-.52-.52-.52zM25.04 3.74c-.11-.1-.36-.26-.52-.26-.32 0-.52.2-.52.52v14c0 2.28 1.72 4 4 4h6v-9.37l-8.96-8.89zM20 26h-6v9.37l8.96 8.89c.11.1.36.26.52.26.32 0 .52-.2.52-.52V30c0-2.28-1.72-4-4-4z"})),mt=s("./client/config/index.js");class gt extends n.Component{constructor(){super(...arguments),o()(this,"state",{popover:!1}),o()(this,"storeButtonRef",e=>this.buttonRef=e),o()(this,"togglePopover",()=>{this.setState({popover:!this.state.popover})}),o()(this,"changeSource",e=>()=>{e!==this.props.source&&this.props.onSourceChange(e)}),o()(this,"getSources",()=>{const e=this.props,t=e.disabledSources,s=e.translate,i=[{value:"",label:s("WordPress library"),icon:r.a.createElement(w.a,{icon:"image",size:24})},{value:"google_photos",label:s("Google Photos library"),icon:r.a.createElement(ht,null)}];return mt.a.isEnabled("external-media/free-photo-library")&&i.push({value:"pexels",label:s("Free photo library"),icon:r.a.createElement(w.a,{icon:"image-multiple",size:24})}),i.filter(e=>{let s=e.value;return!Object(c.includes)(t,s)})})}renderScreenReader(e){return r.a.createElement(B.a,null,e&&e.label)}renderMenuItems(e){return e.map(e=>{let t=e.icon,s=e.label,i=e.value;return r.a.createElement(k.a,{key:i,"data-source":i,onClick:this.changeSource(i)},t,s)})}render(){const e=this.props,t=e.translate,s=e.source,i=this.getSources(),o=Object(c.find)(i,e=>e.value===s),n=l()("media-library__datasource",{"is-single-source":1===i.length}),a=l()("button media-library__source-button",{"is-open":this.state.popover});return mt.a.isEnabled("external-media")||i.length?r.a.createElement("div",{className:n},r.a.createElement(te.a,{borderless:!0,ref:this.storeButtonRef,className:a,onClick:this.togglePopover,title:t("Choose media library source")},o&&o.icon,this.renderScreenReader(o),r.a.createElement(w.a,{icon:"chevron-down",size:18})),i.length>1&&r.a.createElement(R.a,{context:this.buttonRef,isVisible:this.state.popover,position:"bottom right",onClose:this.togglePopover,className:"is-dialog-visible media-library__header-popover"},this.renderMenuItems(i))):null}}o()(gt,"propTypes",{source:p.a.string.isRequired,onSourceChange:p.a.func.isRequired,disabledSources:p.a.array}),o()(gt,"defaultProps",{disabledSources:[]});var bt=Object(g.localize)(gt);const ft=["pexels"];class jt extends n.Component{constructor(){super(...arguments),o()(this,"changeFilter",e=>()=>{this.props.onFilterChange(e)})}getSearchPlaceholderText(){const e=this.props,t=e.filter,s=e.source,i=e.translate;if("pexels"===s)return i("Search for free photos");switch(t){case"this-post":return i("Search media uploaded to this post");case"images":return i("Search images");case"audio":return i("Search audio files");case"videos":return i("Search videos");case"documents":return i("Search documents");default:return i("Search all media")}}getFilterLabel(e){const t=this.props.translate;switch(e){case"this-post":return t("This Post",{comment:"Filter label for media list"});case"images":return t("Images",{comment:"Filter label for media list"});case"audio":return t("Audio",{comment:"Filter label for media list"});case"videos":return t("Videos",{comment:"Filter label for media list"});case"documents":return t("Documents",{comment:"Filter label for media list"});default:return t("All",{comment:"Filter label for media list"})}}isFilterDisabled(e){const t=this.props.enabledFilters;return t&&(!e.length||!Object(c.includes)(t,e))}renderTabItems(){if(""!==this.props.source)return null;const e=["","this-post","images","documents","videos","audio"];return this.props.post||Object(c.pull)(e,"this-post"),r.a.createElement(ct.a,null,e.map(e=>r.a.createElement(dt.a,{key:"filter-tab-"+e,selected:this.props.filter===e,onClick:this.changeFilter(e),disabled:this.isFilterDisabled(e)},this.getFilterLabel(e))))}renderSearchSection(){const e=this.props,t=e.source,s=e.onSearch,i=e.search,o=e.filterRequiresUpgrade,n=e.isConnected;if(o||!n)return null;if("google_photos"===t)return null;const a=""===t;return r.a.createElement(pt.a,{key:t,analyticsGroup:"Media",pinned:a,fitsContainer:!0,onSearch:s,initialValue:i,placeholder:this.getSearchPlaceholderText(),delaySearch:!0})}renderPlanStorage(){if(this.props.source)return null;return r.a.createElement(ut.a,{siteId:this.props.site.ID},r.a.createElement(f.a,{eventName:"calypso_upgrade_nudge_impression",eventProperties:{cta_name:"plan-media-storage"}}))}render(){const e=this.props.disableLargeImageSources?Object(c.union)(this.props.disabledDataSources,ft):this.props.disabledDataSources;return r.a.createElement("div",{className:"media-library__filter-bar"},r.a.createElement(bt,{source:this.props.source,onSourceChange:this.props.onSourceChange,disabledSources:e}),r.a.createElement(lt.a,{selectedText:this.getFilterLabel(this.props.filter),hasSearch:!0,allowDropdown:!this.props.source},this.renderTabItems(),this.renderSearchSection()),this.renderPlanStorage())}}o()(jt,"propTypes",{basePath:p.a.string,enabledFilters:p.a.arrayOf(p.a.string),filter:p.a.string,filterRequiresUpgrade:p.a.bool,search:p.a.string,source:p.a.string,site:p.a.object,onFilterChange:p.a.func,onSearch:p.a.func,translate:p.a.func,post:p.a.bool,isConnected:p.a.bool,disableLargeImageSources:p.a.bool,disabledDataSources:p.a.arrayOf(p.a.string)}),o()(jt,"defaultProps",{filter:"",basePath:"/media",onFilterChange:c.noop,onSourceChange:c.noop,onSearch:c.noop,translate:c.identity,source:"",post:!1,isConnected:!0,disableLargeImageSources:!1,disabledDataSources:[]});var yt=Object(g.localize)(jt),xt=s("./client/lib/media/validation-store.js");function vt(e){return{mediaValidationErrors:xt.a.getAllErrors(e)}}class Et extends r.a.Component{constructor(){super(...arguments),o()(this,"state",vt(this.props.siteId)),o()(this,"updateState",()=>{this.setState(vt(this.props.siteId))})}componentDidMount(){xt.a.on("change",this.updateState)}componentWillUnmount(){xt.a.off("change",this.updateState)}componentWillReceiveProps(e){this.props.siteId!==e.siteId&&this.setState(vt(e.siteId))}render(){return Object(E.a)(this,this.state)}}o()(Et,"displayName","MediaValidationData"),o()(Et,"propTypes",{siteId:p.a.number.isRequired});var _t=s("./client/components/data/query-preferences/index.jsx"),It=s("./client/lib/search-url/index.js");s("./client/my-sites/media-library/style.scss");const St=["pexels"],Ot=e=>""!==e&&!Object(c.includes)(St,e),Ct=(e,t)=>!Ot(t)||Object(c.some)(Object(Be.b)(e),{type:"other",status:"ok",service:t}),Pt=(e,t)=>Ot(t)&&!Object(Be.d)(e)&&!Object(c.some)(Object(Be.b)(e),{type:"other",status:"ok"});class wt extends n.Component{constructor(){super(...arguments),o()(this,"doSearch",e=>{Object(It.a)(e,this.props.search,this.props.onSearch)}),o()(this,"onAddMedia",()=>{const e=rt.a.getAll(this.props.site.ID);let t=e;this.props.site&&(this.props.filter&&(t=Object(Q.d)(t,at(this.props.filter))),this.props.single&&t.length>1&&(t=t.slice(-1)),Object(c.isEqual)(e,t)||x.a.setLibrarySelectedItems(this.props.site.ID,t),this.props.onAddMedia())})}componentDidMount(){this.props.needsKeyring&&this.props.requestKeyringConnections()}componentDidUpdate(e){this.props.needsKeyring&&!Ot(e.source)&&this.props.requestKeyringConnections()}filterRequiresUpgrade(){const e=this.props,t=e.filter,s=e.site;if(e.source)return!1;switch(t){case"audio":return!(s&&s.options.upgraded_filetypes_enabled||s.jetpack);case"videos":return!(s&&s.options.videopress_enabled||s.jetpack)}return!1}renderDropZone(){return""!==this.props.source?null:r.a.createElement(nt.a,{site:this.props.site,filter:this.props.filter,fullScreen:this.props.fullScreenDropZone,onAddMedia:this.onAddMedia})}render(){let e;e=r.a.createElement(ot,{site:this.props.site,filter:this.props.filter,filterRequiresUpgrade:this.filterRequiresUpgrade(),search:this.props.search,source:this.props.source,isConnected:this.props.isConnected,containerWidth:this.props.containerWidth,single:this.props.single,scrollable:this.props.scrollable,onAddMedia:this.onAddMedia,onAddAndEditImage:this.props.onAddAndEditImage,onMediaScaleChange:this.props.onScaleChange,onSourceChange:this.props.onSourceChange,selectedItems:this.props.mediaLibrarySelectedItems,onDeleteItem:this.props.onDeleteItem,onEditItem:this.props.onEditItem,onViewDetails:this.props.onViewDetails,postId:this.props.postId}),this.props.site&&(e=r.a.createElement(Et,{siteId:this.props.site.ID},e));const t=l()("media-library",{"is-single":this.props.single},this.props.className);return r.a.createElement("div",{className:t},r.a.createElement(_t.a,null),this.renderDropZone(),r.a.createElement(yt,{site:this.props.site,filter:this.props.filter,filterRequiresUpgrade:this.filterRequiresUpgrade(),enabledFilters:this.props.enabledFilters,search:this.props.search,onFilterChange:this.props.onFilterChange,onSourceChange:this.props.onSourceChange,source:this.props.source,onSearch:this.doSearch,isConnected:this.props.isConnected,post:!!this.props.postId,disableLargeImageSources:this.props.disableLargeImageSources,disabledDataSources:this.props.disabledDataSources}),e)}}o()(wt,"propTypes",{className:p.a.string,site:p.a.object,filter:p.a.string,enabledFilters:p.a.arrayOf(p.a.string),search:p.a.string,source:p.a.string,onAddMedia:p.a.func,onFilterChange:p.a.func,onSourceChange:p.a.func,onSearch:p.a.func,onScaleChange:p.a.func,onEditItem:p.a.func,fullScreenDropZone:p.a.bool,containerWidth:p.a.number,single:p.a.bool,scrollable:p.a.bool,postId:p.a.number,disableLargeImageSources:p.a.bool,disabledDataSources:p.a.arrayOf(p.a.string)}),o()(wt,"defaultProps",{fullScreenDropZone:!0,onAddMedia:()=>{},onScaleChange:()=>{},scrollable:!1,source:"",disableLargeImageSources:!1,disabledDataSources:[]});t.a=Object(u.b)((e,t)=>{let s=t.source,i=void 0===s?"":s;return{isConnected:Ct(e,i),needsKeyring:Pt(e,i)}},{requestKeyringConnections:qe.c})(wt)},"./client/my-sites/media-library/list-item-file-details.scss":function(e,t,s){},"./client/my-sites/media-library/list-item-video.scss":function(e,t,s){},"./client/my-sites/media-library/list-item.jsx":function(e,t,s){"use strict";var i=s("./node_modules/@babel/runtime/helpers/extends.js"),o=s.n(i),n=s("./node_modules/@babel/runtime/helpers/defineProperty.js"),r=s.n(n),a=s("./node_modules/lodash/lodash.js"),l=s("./node_modules/prop-types/index.js"),c=s.n(l),d=s("./node_modules/react/index.js"),p=s.n(d),u=s("./node_modules/classnames/index.js"),h=s.n(u),m=s("./client/components/spinner/index.jsx"),g=s("./client/components/gridicon/index.jsx"),b=s("./client/lib/media/utils.js");s("./client/my-sites/media-library/list-item-file-details.scss");class f extends p.a.Component{render(){return p.a.createElement("div",{className:"media-library__list-item-file-details media-library__list-item-centered"},p.a.createElement("div",{className:"media-library__list-item-icon"},p.a.createElement(g.a,{icon:this.props.icon})),p.a.createElement("div",{className:"media-library__list-item-file-name",style:{fontSize:12*(1+this.props.scale)}},this.props.media.title),p.a.createElement("hr",{className:"media-library__list-item-details-separator"}),p.a.createElement("div",{className:"media-library__list-item-file-extension",style:{fontSize:9*(1+this.props.scale)}},(this.props.media.extension||"").toUpperCase()))}}r()(f,"displayName","MediaLibraryListItemFileDetails"),r()(f,"propTypes",{media:c.a.object,scale:c.a.number,icon:c.a.string}),r()(f,"defaultProps",{icon:"pages"});var j=s("./client/lib/media/constants.js");class y extends p.a.Component{constructor(){super(...arguments),r()(this,"state",{}),r()(this,"getImageDimensions",()=>{return{width:this.props.media.width||this.state.imageWidth,height:this.props.media.height||this.state.imageHeight}}),r()(this,"getImageStyle",()=>{const e=this.getImageDimensions();return{maxHeight:e.height>e.width?"none":"100%",maxWidth:e.height<e.width?"none":"100%"}}),r()(this,"setUnknownImageDimensions",e=>{let t=null;this.props.media.width||(t={imageWidth:e.target.clientWidth}),this.props.media.height||((t=t||{}).imageHeight=e.target.clientHeight),t&&this.setState(t)})}static getDerivedStateFromProps(e,t){const s=t.maxSeenScale||0;return e.scale>s?{maxSeenScale:e.scale}:null}render(){const e=Math.round(1/this.props.maxScale*this.state.maxSeenScale*this.props.maxImageWidth),t=Object(b.s)(this.props.media,{resize:"".concat(e,",").concat(e),size:this.props.thumbnailType===j.e&&"medium"});return t?p.a.createElement("img",{src:t,onLoad:this.setUnknownImageDimensions,alt:this.props.media.alt||this.props.media.title,style:this.getImageStyle(),className:"media-library__list-item-centered",draggable:"false"}):p.a.createElement(f,{scale:this.props.scale,media:this.props.media,icon:"image"})}}r()(y,"propTypes",{media:c.a.object,scale:c.a.number,maxScale:c.a.number,maxImageWidth:c.a.number,thumbnailType:c.a.string}),r()(y,"defaultProps",{maxImageWidth:450,maxScale:j.g[j.g.length-1]});var x=s("./packages/photon/dist/esm/index.js"),v=s.n(x);s("./client/my-sites/media-library/list-item-video.scss");class E extends p.a.Component{constructor(){super(...arguments),r()(this,"getHighestQualityThumbnail",()=>{if(this.props.media.thumbnails)return this.props.media.thumbnails.fmt_hd||this.props.media.thumbnails.fmt_dvd||this.props.media.thumbnails.fmt_std})}render(){const e=this.getHighestQualityThumbnail();if(e){const t=this.props.thumbnailType===j.e?e:v()(e,{width:this.props.maxImageWidth});return p.a.createElement("div",{className:"media-library__list-item-video",style:{backgroundImage:"url("+t+")"}},p.a.createElement("span",{className:"media-library__list-item-icon media-library__list-item-centered"},p.a.createElement(g.a,{icon:"video-camera"})))}return p.a.createElement(f,o()({},this.props,{icon:"video-camera"}))}}r()(E,"displayName","MediaLibraryListItemVideo"),r()(E,"propTypes",{media:c.a.object,maxImageWidth:c.a.number,thumbnailType:c.a.string}),r()(E,"defaultProps",{maxImageWidth:450});class _ extends p.a.Component{render(){return p.a.createElement(f,o()({},this.props,{icon:"audio"}))}}r()(_,"displayName","MediaLibraryListItemDocument");class I extends p.a.Component{render(){return p.a.createElement(f,this.props)}}r()(I,"displayName","MediaLibraryListItemDocument");var S=s("./packages/i18n-calypso/dist/esm/index.js"),O=s("./node_modules/react-redux/es/index.js"),C=s("./node_modules/redux/es/redux.js"),P=s("./client/lib/viewport/index.js"),w=s("./client/components/popover/index.jsx"),R=s("./client/components/forms/form-checkbox/index.jsx"),k=s("./client/components/button/index.jsx"),N=s("./client/state/preferences/actions.js"),T=s("./client/state/preferences/selectors.js"),D=s("./client/state/ui/selectors.js"),M=s("./client/components/data/query-preferences/index.jsx");class L extends p.a.PureComponent{constructor(){var e;super(...arguments),e=this,r()(this,"state",{isDismissed:!1,rememberDismiss:!0}),r()(this,"setRenderContext",e=>{e&&this.setState({renderContext:e})}),r()(this,"toggleRememberDismiss",()=>{setTimeout(()=>{this.setState({rememberDismiss:!this.state.rememberDismiss})},0)}),r()(this,"dismiss",function(){let t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).remember;e.setState({isDismissed:!0}),e.props.onDismiss({remember:t})}),r()(this,"renderPopover",()=>{const e=this.state,t=e.renderContext,s=e.isDismissed;if(t&&!s)return p.a.createElement(w.a,{onClose:()=>this.dismiss(),context:t,position:"bottom",isVisible:!Object(P.e)(),className:"popover__gallery-help is-dialog-visible"},p.a.createElement("div",{className:"editor-media-modal__gallery-help-content"},p.a.createElement("div",{className:"editor-media-modal__gallery-help-instruction"},p.a.createElement("span",{className:"editor-media-modal__gallery-help-icon"},p.a.createElement(g.a,{icon:"image-multiple",size:20})),p.a.createElement("span",{className:"editor-media-modal__gallery-help-text"},this.props.translate("Select more than one image to create a gallery."))),p.a.createElement("div",{className:"editor-media-modal__gallery-help-actions"},p.a.createElement("label",{className:"editor-media-modal__gallery-help-remember-dismiss"},p.a.createElement(R.a,{checked:this.state.rememberDismiss,onChange:this.toggleRememberDismiss}),p.a.createElement("span",null,this.props.translate("Don't show again"))),p.a.createElement(k.a,{onClick:()=>this.dismiss({remember:this.state.rememberDismiss}),compact:!0},this.props.translate("Got it",{context:"Button label",comment:"User clicks this to confirm that he has understood the text"})))))})}render(){return"post-editor"!==this.props.sectionName?null:this.props.isMediaModalGalleryInstructionsDismissed?null:p.a.createElement("div",{ref:this.setRenderContext,className:"editor-media-modal__gallery-help"},p.a.createElement(M.a,null),this.renderPopover())}}r()(L,"displayName","EditorMediaModalGalleryHelp"),r()(L,"propTypes",{onDismiss:c.a.func,sectionName:c.a.string}),r()(L,"defaultProps",{onDismiss:()=>{}});var H=Object(O.b)(e=>({sectionName:Object(D.c)(e),isMediaModalGalleryInstructionsDismissed:Object(T.b)(e,"mediaModalGalleryInstructionsDismissed")||Object(T.b)(e,"mediaModalGalleryInstructionsDismissedForSession")}),e=>Object(C.b)({onDismiss:e=>e.remember?Object(N.b)("mediaModalGalleryInstructionsDismissed",!0):Object(N.c)("mediaModalGalleryInstructionsDismissedForSession",!0)},e))(Object(S.localize)(L));s("./client/my-sites/media-library/list-item.scss");s.d(t,"a",function(){return U});class U extends p.a.Component{constructor(){super(...arguments),r()(this,"clickItem",e=>{this.props.onToggle(this.props.media,e.shiftKey)}),r()(this,"renderItem",()=>{let e;if(this.props.media){switch(Object(b.g)(this.props.media)){case"image":e=y;break;case"video":e=E;break;case"audio":e=_;break;default:e=I}return p.a.createElement(e,this.props)}}),r()(this,"renderSpinner",()=>{if(this.props.media&&this.props.media.transient)return p.a.createElement("div",{className:"media-library__list-item-spinner"},p.a.createElement(m.a,null))})}shouldComponentUpdate(e){return!(e.media===this.props.media&&e.scale===this.props.scale&&e.maxImageWidth===this.props.maxImageWidth&&e.thumbnailType===this.props.thumbnailType&&e.selectedIndex===this.props.selectedIndex&&Object(a.isEqual)(e.style,this.props.style))}render(){let e,t;const s=h()("media-library__list-item",{"is-placeholder":!this.props.media,"is-selected":-1!==this.props.selectedIndex,"is-transient":this.props.media&&this.props.media.transient,"is-small":this.props.scale<=.125}),i=Object(a.omit)(this.props,Object.keys(this.constructor.propTypes)),n=Object(a.assign)({width:100*this.props.scale+"%"},this.props.style);return this.props.media&&(e=this.props.media.file),-1!==this.props.selectedIndex&&(t=this.props.selectedIndex+1,i["data-selected-number"]=t>99?"99+":t),p.a.createElement("div",o()({className:s,style:n,onClick:this.clickItem},i),p.a.createElement("span",{className:"media-library__list-item-selected-icon"},p.a.createElement(g.a,{icon:"checkmark",size:18})),p.a.createElement("figure",{className:"media-library__list-item-figure",title:e},this.renderItem(),this.renderSpinner(),this.props.showGalleryHelp&&p.a.createElement(H,null)))}}r()(U,"displayName","MediaLibraryListItem"),r()(U,"propTypes",{media:c.a.object,scale:c.a.number.isRequired,maxImageWidth:c.a.number,thumbnailType:c.a.string,showGalleryHelp:c.a.bool,selectedIndex:c.a.number,onToggle:c.a.func,onEditItem:c.a.func,style:c.a.object}),r()(U,"defaultProps",{maxImageWidth:450,selectedIndex:-1,onToggle:a.noop,onEditItem:a.noop})},"./client/my-sites/media-library/list-item.scss":function(e,t,s){},"./client/my-sites/media-library/style.scss":function(e,t,s){},"./client/my-sites/media-library/upload-url.scss":function(e,t,s){},"./client/my-sites/no-results/index.jsx":function(e,t,s){"use strict";var i=s("./node_modules/@babel/runtime/helpers/defineProperty.js"),o=s.n(i),n=s("./node_modules/react/index.js"),r=s.n(n);class a extends r.a.Component{render(){return r.a.createElement("div",{className:"no-results"},this.props.image?r.a.createElement("img",{className:"no-results__img",src:this.props.image}):null,r.a.createElement("span",null,this.props.text))}}o()(a,"defaultProps",{text:"No results",image:!1}),t.a=a},"./client/post-editor/media-modal/content.jsx":function(e,t,s){"use strict";var i=s("./node_modules/react/index.js"),o=s.n(i),n=s("./node_modules/classnames/index.js"),r=s.n(n);s("./client/post-editor/media-modal/content.scss");t.a=(e=>{let t=e.children,s=e.className;return o.a.createElement("div",{className:r()("editor-media-modal__content",s)},t)})},"./client/post-editor/media-modal/content.scss":function(e,t,s){},"./client/post-editor/media-modal/detail/detail-preview-video.jsx":function(e,t,s){"use strict";var i=s("./node_modules/@babel/runtime/helpers/defineProperty.js"),o=s.n(i),n=s("./node_modules/prop-types/index.js"),r=s.n(n),a=s("./node_modules/react/index.js"),l=s.n(a),c=s("./node_modules/classnames/index.js"),d=s.n(c),p=s("./client/lib/media/utils.js"),u=s("./node_modules/lodash/lodash.js"),h=s("./node_modules/debug/src/browser.js"),m=s.n(h),g=s("./client/lib/load-script/index.js");const b=m()("calypso:post-editor:videopress"),f="https://wordpress.com/wp-content/plugins/video/assets/js/next/videopress.js";class j extends a.Component{constructor(){super(...arguments),o()(this,"setVideoInstance",e=>this.video=e),o()(this,"onScriptLoaded",e=>{const t=this.props,s=t.isPlaying,i=t.item,o=t.onScriptLoadError;if(e)return b("Script".concat(Object(u.get)(e,"src","")," failed to load.")),void o();const n=i.height,r=void 0===n?480:n,a=i.videopress_guid,l=i.width,c=void 0===l?854:l;a&&"undefined"!=typeof window&&window.videopress&&(this.player=window.videopress(a,this.video,{autoPlay:s,height:r,width:c}))}),o()(this,"receiveMessage",e=>{if(e.origin&&e.origin!==location.origin)return;const t=e.data;t&&"videopress_loading_state"===t.event&&"state"in t&&"converting"in t&&("loaded"!==t.state||t.converting||this.props.onVideoLoaded())})}componentDidMount(){this.loadInitializeScript(),window.addEventListener("message",this.receiveMessage,!1)}componentWillUnmount(){Object(g.c)(f,this.onScriptLoaded),this.destroy()}componentWillReceiveProps(e){this.props.isPlaying&&!e.isPlaying?this.pause():!this.props.isPlaying&&e.isPlaying&&this.play()}componentDidUpdate(e){this.props.item.videopress_guid!==e.item.videopress_guid&&(this.destroy(),this.loadInitializeScript())}shouldComponentUpdate(e){return this.props.item.videopress_guid!==e.item.videopress_guid}loadInitializeScript(){Object(g.a)(f,this.onScriptLoaded)}destroy(){if(window.removeEventListener("message",this.receiveMessage),this.player)for(Object(u.invoke)(this,"player.destroy");this.video.firstChild;)this.video.removeChild(this.video.firstChild)}play(){Object(u.get)(this,"player.state")&&Object(u.invoke)(this,"player.state.play")}pause(){if(!Object(u.get)(this,"player.state"))return;Object(u.invoke)(this,"player.state.pause");const e=Object(u.invoke)(this,"player.state.videoAt");e&&this.props.onPause(e)}render(){const e=d()(this.props.className,"is-video");return l.a.createElement("div",{className:e,ref:this.setVideoInstance})}}o()(j,"propTypes",{className:r.a.string,isPlaying:r.a.bool,item:r.a.object.isRequired,onPause:r.a.func,onScriptLoadError:r.a.func,onVideoLoaded:r.a.func}),o()(j,"defaultProps",{isPlaying:!1,onPause:u.noop,onScriptLoadError:u.noop,onVideoLoaded:u.noop});var y=j;s.d(t,"a",function(){return x});class x extends l.a.Component{render(){if(Object(p.p)(this.props.item))return l.a.createElement(y,this.props);const e=d()(this.props.className,"is-video");return l.a.createElement("video",{src:Object(p.s)(this.props.item),controls:!0,className:e})}}o()(x,"displayName","EditorMediaModalDetailPreviewVideo"),o()(x,"propTypes",{className:r.a.string,item:r.a.object.isRequired})},"./client/post-editor/media-modal/detail/index.jsx":function(e,t,s){"use strict";var i=s("./node_modules/@babel/runtime/helpers/defineProperty.js"),o=s.n(i),n=s("./node_modules/prop-types/index.js"),r=s.n(n),a=s("./packages/i18n-calypso/dist/esm/index.js"),l=s("./node_modules/react/index.js"),c=s.n(l),d=s("./node_modules/react-redux/es/index.js"),p=s("./node_modules/lodash/lodash.js"),u=s("./node_modules/classnames/index.js"),h=s.n(u),m=s("./node_modules/url/url.js"),g=s.n(m),b=s("./client/components/gridicon/index.jsx"),f=s("./client/post-editor/media-modal/content.jsx"),j=s("./node_modules/react-dom/index.js"),y=s.n(j),x=s("./client/lib/analytics/index.js"),v=s("./client/lib/media/utils.js"),E=s("./client/lib/media/actions.js"),_=s("./client/components/clipboard-button-input/index.jsx"),I=s("./client/components/forms/form-textarea/index.jsx"),S=s("./client/components/forms/form-text-input/index.jsx"),O=s("./client/components/track-input-changes/index.jsx"),C=s("./client/post-editor/media-modal/fieldset.jsx");class P extends l.Component{constructor(){super(...arguments),o()(this,"bumpTitleStat",()=>{x.default.ga.recordEvent("Media","Changed Item Title"),x.default.mc.bumpStat("calypso_media_edit_details","title")}),o()(this,"bumpAltStat",()=>{x.default.ga.recordEvent("Media","Changed Image Alt"),x.default.mc.bumpStat("calypso_media_edit_details","alt")}),o()(this,"bumpCaptionStat",()=>{x.default.ga.recordEvent("Media","Changed Item Caption"),x.default.mc.bumpStat("calypso_media_edit_details","caption")}),o()(this,"bumpDescriptionStat",()=>{x.default.ga.recordEvent("Media","Changed Item Description"),x.default.mc.bumpStat("calypso_media_edit_details","description")}),o()(this,"setFieldValue",e=>{let t=e.target;const s=Object.assign({ID:this.props.item.ID},Object(p.get)(this.state,"modifiedItem",{}),{[t.name]:t.value});this.setState({modifiedItem:s}),this.persistChange()}),o()(this,"scrollToShowVisibleDropdown",e=>{e.open&&"scrollIntoView"in window.Element.prototype&&y.a.findDOMNode(e.target).scrollIntoView()}),this.persistChange=Object(p.debounce)(this.persistChange,1e3)}componentWillReceiveProps(e){this.props.item&&e.item&&e.item.ID!==this.props.item.ID&&(this.setState({modifiedItem:null}),this.persistChange.cancel())}isMimePrefix(e){return Object(v.g)(this.props.item)===e}persistChange(){this.props.site&&this.state.modifiedItem&&E.a.update(this.props.site.ID,this.state.modifiedItem)}getItemValue(e){const t=Object(p.get)(this.state,["modifiedItem",e],null);return null!==t?t:this.props.item?this.props.item[e]:void 0}renderImageAltText(){return this.isMimePrefix("image")?c.a.createElement(C.a,{legend:this.props.translate("Alt text")},c.a.createElement(O.a,{onNewValue:this.bumpAltStat},c.a.createElement(S.a,{name:"alt",value:this.getItemValue("alt"),onChange:this.setFieldValue}))):null}render(){const e=this.props.translate;return c.a.createElement("div",{className:"editor-media-modal-detail__fields"},c.a.createElement(C.a,{legend:e("Title")},c.a.createElement(O.a,{onNewValue:this.bumpTitleStat},c.a.createElement(S.a,{name:"title",value:this.getItemValue("title"),onChange:this.setFieldValue}))),c.a.createElement(C.a,{legend:e("Caption")},c.a.createElement(O.a,{onNewValue:this.bumpCaptionStat},c.a.createElement(I.a,{name:"caption",value:this.getItemValue("caption"),onChange:this.setFieldValue}))),this.renderImageAltText(),c.a.createElement(C.a,{legend:e("Description")},c.a.createElement(O.a,{onNewValue:this.bumpDescriptionStat},c.a.createElement(I.a,{name:"description",value:this.getItemValue("description"),onChange:this.setFieldValue}))),c.a.createElement(C.a,{legend:e("URL")},c.a.createElement(_.a,{value:Object(v.s)(this.props.item)})))}}o()(P,"propTypes",{site:r.a.object,item:r.a.object});var w=Object(a.localize)(P);class R extends c.a.Component{constructor(){super(...arguments),o()(this,"getItemValue",e=>{let t;if(!this.props.item)return this.props.translate("Loading");switch(e){case"extension":t=(this.props.item[e]||"").toUpperCase();break;case"dimensions":t=[c.a.createElement("abbr",{key:"width",title:this.props.translate("Width in pixels")},this.props.item.width),"  ",c.a.createElement("abbr",{key:"height",title:this.props.translate("Height in pixels")},this.props.item.height)];break;case"date":t=this.props.moment(this.props.item[e]).format("D MMMM YYYY");break;case"length":t=Object(v.q)(this.props.item[e]);break;default:t=this.props.item[e]}return t}),o()(this,"renderDimensions",()=>{if(this.props.item&&(this.props.item.width||this.props.item.height))return c.a.createElement("tr",null,c.a.createElement("th",null,this.props.translate("Dimensions")),c.a.createElement("td",null,this.getItemValue("dimensions")))}),o()(this,"renderDuration",()=>{if(this.props.item&&this.props.item.length)return c.a.createElement("tr",null,c.a.createElement("th",null,this.props.translate("Duration")),c.a.createElement("td",null,this.getItemValue("length")))})}render(){const e=h()("editor-media-modal-detail__file-info",{"is-loading":!this.props.item});return c.a.createElement("table",{className:e},c.a.createElement("tbody",null,c.a.createElement("tr",null,c.a.createElement("th",null,this.props.translate("File Name")),c.a.createElement("td",{title:this.getItemValue("file")},c.a.createElement("span",null,this.getItemValue("file")))),c.a.createElement("tr",null,c.a.createElement("th",null,this.props.translate("File Type")),c.a.createElement("td",null,this.getItemValue("extension"))),this.renderDimensions(),this.renderDuration(),c.a.createElement("tr",null,c.a.createElement("th",null,this.props.translate("Upload Date")),c.a.createElement("td",null,this.getItemValue("date")))))}}o()(R,"displayName","EditorMediaModalDetailFileInfo"),o()(R,"propTypes",{item:r.a.object});var k=Object(a.localize)(R),N=s("./client/components/image-preloader/index.jsx"),T=s("./client/components/spinner/index.jsx");class D extends l.Component{constructor(e){super(e),this.onImagePreloaderLoad=this.onImagePreloaderLoad.bind(this),this.state={loading:!1}}componentWillReceiveProps(e){if(this.props.item.URL===e.item.URL)return null;this.setState({loading:!0})}onImagePreloaderLoad(){this.setState({loading:!1}),this.props.onLoad()}render(){const e=Object(v.s)(this.props.item,{photon:this.props.site&&!this.props.site.is_private}),t=Object(v.k)(this.props.item),s=this.state.loading,i=/^blob/.test(e),o=h()(this.props.className,"is-image",{"is-uploading":t},{"is-loading":s},{"is-blob":i}),n=h()(this.props.className,"is-image","is-fake",{"is-uploading":t},{"is-loading":s},{"is-blob":i});return c.a.createElement("div",null,c.a.createElement("img",{src:e,width:this.props.item.width,height:this.props.item.height,alt:this.props.item.alt||this.props.item.title,className:n}),c.a.createElement(N.a,{src:e,width:this.props.item.width,height:this.props.item.height,onLoad:this.onImagePreloaderLoad,placeholder:c.a.createElement("span",null),alt:this.props.item.alt||this.props.item.title,className:o}),(t||s)&&c.a.createElement(T.a,null))}}o()(D,"propTypes",{className:r.a.string,item:r.a.object.isRequired,site:r.a.object}),o()(D,"defaultProps",{onLoad:p.noop});var M=s("./client/post-editor/media-modal/detail/detail-preview-video.jsx");class L extends c.a.Component{render(){const e=h()(this.props.className,"is-audio");return c.a.createElement("audio",{src:Object(v.s)(this.props.item),controls:!0,className:e})}}o()(L,"displayName","EditorMediaModalDetailPreviewAudio"),o()(L,"propTypes",{className:r.a.string,item:r.a.object.isRequired});class H extends c.a.Component{render(){const e=h()(this.props.className,"is-document");return c.a.createElement("div",{className:e},c.a.createElement(b.a,{icon:"pages",size:120}))}}o()(H,"displayName","EditorMediaModalDetailPreviewDocument"),o()(H,"propTypes",{className:r.a.string});var U=s("./client/components/button/index.jsx"),A=s("./client/components/screen-reader-text/index.js"),F=s("./client/components/data/query-jetpack-modules/index.jsx"),V=s("./client/lib/version-compare/index.js"),q=s("./client/config/index.js"),B=s("./client/state/ui/selectors.js"),z=s("./client/state/sites/selectors.js"),G=s("./client/state/selectors/can-current-user.js"),W=s("./client/state/selectors/is-private-site.js");class Y extends l.Component{constructor(){super(...arguments),o()(this,"handleOnRestoreClick",()=>{const e=this.props,t=e.site,s=e.item;(0,e.onRestore)(t&&t.ID,s)})}shouldShowVideoEditingButtons(e){const t=this.props,s=t.isJetpack,i=t.isVideoPressEnabled,o=t.isVideoPressModuleActive;if(!Object(v.p)(e))return!1;if(s){if(!o)return!1}else if(!i)return!1;return!0}shouldShowImageEditingButtons(e,t){const s=this.props.isSitePrivate;return!!e&&(!!q.a.isEnabled("post-editor/image-editor")&&(!s&&(!Object(p.get)(t,"jetpack",!1)||!Object(V.a)(Object(p.get)(t,"options.jetpack_version","0.0"),"4.7-alpha","<"))))}renderEditButton(){const e=this.props,t=e.item,s=e.onEdit,i=e.translate;if(!e.canUserUploadFiles)return null;const o=Object(v.g)(t);if(!Object(p.includes)(["image","video"],o))return null;const n=i("video"===o?"Edit Thumbnail":"Edit Image");return c.a.createElement(U.a,{className:"editor-media-modal-detail__edit",onClick:s,disabled:Object(v.k)(t)},c.a.createElement(b.a,{icon:"pencil",size:36})," ",n)}renderRestoreButton(){const e=this.props,t=e.item,s=e.translate,i=g.a.parse(t.guid),o=g.a.parse(t.URL);return i.pathname!==o.pathname&&c.a.createElement(U.a,{className:h()("editor-media-modal-detail__restore"),onClick:this.handleOnRestoreClick,disabled:Object(v.k)(t)},c.a.createElement(b.a,{icon:"refresh",size:36}),s("Restore Original"))}renderMediaEditorButtons(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"is-desktop";if(!e)return null;return"video"===Object(v.g)(e)?this.renderVideoEditorButtons(e,t):this.renderImageEditorButtons(t)}renderImageEditorButtons(e){const t=this.props,s=t.item,i=t.site;if(!this.shouldShowImageEditingButtons(s,i))return null;const o=h()("editor-media-modal-detail__edition-bar",e);return c.a.createElement("div",{className:o},this.renderRestoreButton(e),this.renderEditButton())}renderVideoEditorButtons(e,t){if(!this.shouldShowVideoEditingButtons(e))return null;const s=h()("editor-media-modal-detail__edition-bar",t);return c.a.createElement("div",{className:s},this.renderEditButton())}renderFields(){const e=this.props,t=e.site,s=e.item;return e.canUserUploadFiles?c.a.createElement(w,{site:t,item:s}):null}renderPreviousItemButton(){const e=this.props,t=e.hasPreviousItem,s=e.onShowPreviousItem,i=e.translate;return t?c.a.createElement("button",{onClick:s,className:"editor-media-modal-detail__previous"},c.a.createElement(b.a,{icon:"chevron-left",size:36}),c.a.createElement(A.a,null,i("Previous"))):null}renderNextItemButton(){const e=this.props,t=e.hasNextItem,s=e.onShowNextItem,i=e.translate;return t?c.a.createElement("button",{onClick:s,className:"editor-media-modal-detail__next"},c.a.createElement(b.a,{icon:"chevron-right",size:36}),c.a.createElement(A.a,null,i("Next"))):null}renderItem(){const e=this.props,t=e.item,s=e.site;if(!t)return null;let i;switch(Object(v.g)(t)){case"image":i=D;break;case"video":i=M.a;break;case"audio":i=L;break;default:i=H}return c.a.createElement(i,{className:"editor-media-modal-detail__preview",site:s,item:t})}render(){const e=this.props,t=e.isJetpack,s=e.item,i=e.siteId,o=h()("editor-media-modal-detail__item",{"is-loading":!s});return c.a.createElement("figure",{className:o},c.a.createElement(f.a,{className:"editor-media-modal-detail__content"},c.a.createElement("div",{className:"editor-media-modal-detail__preview-wrapper"},this.renderItem(),this.renderMediaEditorButtons(s),this.renderPreviousItemButton(),this.renderNextItemButton()),c.a.createElement("div",{className:"editor-media-modal-detail__sidebar"},t&&c.a.createElement(F.a,{siteId:i}),this.renderMediaEditorButtons(s,"is-mobile"),this.renderFields(),c.a.createElement(k,{item:s}))))}}o()(Y,"propTypes",{site:r.a.object,item:r.a.object,hasPreviousItem:r.a.bool,hasNextItem:r.a.bool,onShowPreviousItem:r.a.func,onShowNextItem:r.a.func,onEdit:r.a.func,onRestore:r.a.func}),o()(Y,"defaultProps",{hasPreviousItem:!1,hasNextItem:!1,onShowPreviousItem:p.noop,onShowNextItem:p.noop,onEdit:p.noop,onRestore:p.noop});const K=Object(d.b)(e=>{const t=Object(B.e)(e),s=Object(G.b)(e,t,"upload_files");return{isJetpack:Object(z.J)(e,t),isVideoPressEnabled:Object(z.r)(e,t,"videopress_enabled"),isVideoPressModuleActive:Object(z.I)(e,t,"videopress"),isSitePrivate:Object(W.a)(e,t),siteId:t,canUserUploadFiles:s}});var Q=Object(p.flowRight)(K,a.localize)(Y),J=s("./client/components/header-cake/index.jsx"),Z=Object(p.memoize)(function(e){(new window.Image).src=e}),X=s("./client/state/ui/media-modal/constants.js"),$=s("./client/state/ui/editor/actions.js");s("./client/post-editor/media-modal/detail/style.scss");s.d(t,"a",function(){return te});class ee extends c.a.Component{constructor(){super(...arguments),o()(this,"preloadImages",()=>{Object(v.d)(this.props.items,"image").forEach(function(e){const t=Object(v.s)(e,{photon:this.props.site&&!this.props.site.is_private});Z(t)},this)}),o()(this,"incrementIndex",e=>{this.props.onSelectedIndexChange(this.props.selectedIndex+e)})}componentDidMount(){this.preloadImages()}componentDidUpdate(){this.preloadImages()}render(){const e=this.props,t=e.items,s=e.selectedIndex,i=e.site,o=e.backButtonText,n=e.onEditImageItem,r=e.onEditVideoItem,a=e.onRestoreItem,l=e.onReturnToList,d=e.translate,p=t[s],u=Object(v.g)(p);return c.a.createElement("div",{className:"editor-media-modal-detail"},c.a.createElement(J.a,{onClick:l,backText:o||d("Media Library")}),c.a.createElement(Q,{site:i,item:p,hasPreviousItem:s-1>=0,hasNextItem:s+1<t.length,onShowPreviousItem:this.incrementIndex.bind(this,-1),onShowNextItem:this.incrementIndex.bind(this,1),onRestore:a,onEdit:"video"===u?r:n}))}}o()(ee,"propTypes",{site:r.a.object,items:r.a.array,selectedIndex:r.a.number,onSelectedIndexChange:r.a.func,onReturnToList:r.a.func,onEdit:r.a.func,onRestore:r.a.func}),o()(ee,"defaultProps",{selectedIndex:0,onSelectedIndexChange:p.noop});const te=Object(a.localize)(ee);t.b=Object(d.b)(null,{onReturnToList:Object(p.partial)($.l,X.a.LIST),onEditImageItem:Object(p.partial)($.l,X.a.IMAGE_EDITOR),onEditVideoItem:Object(p.partial)($.l,X.a.VIDEO_EDITOR)})(te)},"./client/post-editor/media-modal/detail/style.scss":function(e,t,s){},"./client/post-editor/media-modal/fieldset.jsx":function(e,t,s){"use strict";s.d(t,"a",function(){return p});var i=s("./node_modules/@babel/runtime/helpers/defineProperty.js"),o=s.n(i),n=s("./node_modules/prop-types/index.js"),r=s.n(n),a=s("./node_modules/react/index.js"),l=s.n(a),c=s("./node_modules/classnames/index.js"),d=s.n(c);s("./client/post-editor/media-modal/fieldset.scss");class p extends l.a.Component{render(){return l.a.createElement("fieldset",{className:d()("editor-media-modal__fieldset",this.props.className)},l.a.createElement("legend",{className:"editor-media-modal__fieldset-legend"},this.props.legend),this.props.children)}}o()(p,"displayName","EditorMediaModalFieldset"),o()(p,"propTypes",{legend:r.a.oneOfType([r.a.string,r.a.element]).isRequired})},"./client/post-editor/media-modal/fieldset.scss":function(e,t,s){},"./client/state/selectors/get-initial-query-arguments.js":function(e,t,s){"use strict";var i=s("./node_modules/lodash/lodash.js");t.a=(e=>Object(i.get)(e,"ui.route.query.initial",null))},"./client/state/selectors/is-site-google-my-business-eligible.js":function(e,t,s){"use strict";s.d(t,"a",function(){return c});var i=s("./client/lib/create-selector/index.js"),o=s("./client/state/sites/selectors.js"),n=s("./client/lib/plans/index.js"),r=s("./client/lib/plans/constants.js");const a=Object(i.a)((e,t)=>{const s=Object(o.t)(e,t);return Object(n.z)(s,r.X)},(e,t)=>[Object(o.t)(e,t)]),l=Object(i.a)((e,t)=>{const s=Object(o.t)(e,t);return Object(n.B)(s,{group:r.Xb,type:r.Cc})},(e,t)=>[Object(o.t)(e,t)]);function c(e,t){return a(e,t)||l(e,t)}},"./client/state/sharing/keyring/actions.js":function(e,t,s){"use strict";s.d(t,"c",function(){return r}),s.d(t,"a",function(){return a}),s.d(t,"b",function(){return l});var i=s("./node_modules/@babel/runtime/helpers/objectSpread.js"),o=s.n(i),n=s("./client/lib/wp/browser.js");function r(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return t=>(t({type:"KEYRING_CONNECTIONS_REQUEST"}),n.a.undocumented().mekeyringConnections(e).then(e=>{let s=e.connections;t({type:"KEYRING_CONNECTIONS_RECEIVE",connections:s}),t({type:"KEYRING_CONNECTIONS_REQUEST_SUCCESS"})}).catch(e=>t({type:"KEYRING_CONNECTIONS_REQUEST_FAILURE",error:e})))}function a(e){return{type:"KEYRING_CONNECTION_DELETE",connection:e}}function l(e){return t=>n.a.undocumented().deletekeyringConnection(e.ID).then(()=>t(a(e))).catch(s=>{s&&404===s.statusCode&&t(a(e)),t({type:"KEYRING_CONNECTION_DELETE_FAILURE",error:o()({},s,{label:e.label})})})}},"./client/state/sharing/keyring/selectors.js":function(e,t,s){"use strict";s.d(t,"b",function(){return n}),s.d(t,"a",function(){return r}),s.d(t,"c",function(){return a}),s.d(t,"d",function(){return l});var i=s("./node_modules/lodash/lodash.js"),o=s("./client/lib/create-selector/index.js");function n(e){return Object(i.values)(e.sharing.keyring.items)}function r(e,t){return e.sharing.keyring.items[t]||null}const a=Object(o.a)((e,t)=>Object(i.filter)(n(e),{service:t}),e=>[e.sharing.keyring.items]);function l(e){return e.sharing.keyring.isFetching}},"./client/state/sharing/services/actions.js":function(e,t,s){"use strict";s.d(t,"a",function(){return o});var i=s("./client/lib/wp/browser.js");function o(){return e=>(e({type:"KEYRING_SERVICES_REQUEST"}),i.a.undocumented().metaKeyring().then(t=>{e({type:"KEYRING_SERVICES_RECEIVE",services:t.services}),e({type:"KEYRING_SERVICES_REQUEST_SUCCESS"})}).catch(t=>e({type:"KEYRING_SERVICES_REQUEST_FAILURE",error:t})))}},"./client/state/sharing/services/selectors.js":function(e,t,s){"use strict";s.d(t,"b",function(){return c}),s.d(t,"a",function(){return d}),s.d(t,"c",function(){return p});var i=s("./node_modules/lodash/lodash.js"),o=s("./client/config/index.js"),n=s("./client/state/selectors/can-current-user.js"),r=s("./client/state/sites/selectors.js"),a=s("./client/state/selectors/is-site-google-my-business-eligible.js");function l(e){return e.sharing.services.items}function c(e,t){const s=l(e);return!!s[t]&&s[t]}function d(e,t,s){const c=function(e,t){return Object(i.filter)(l(e),{type:t})}(e,s);return t?c.filter(s=>!(Object(r.J)(e,t)&&!s.jetpack_support)&&(!(Object(r.J)(e,t)&&s.jetpack_module_required&&!Object(r.I)(e,t,s.jetpack_module_required))&&(!("eventbrite"===s.ID&&!Object(n.b)(e,t,"manage_options"))&&(!("publicize"===s.type&&!Object(n.b)(e,t,"publish_posts"))&&(!!("google_my_business"!==s.ID||Object(n.b)(e,t,"manage_options")&&Object(a.a)(e,t)&&o.a.isEnabled("google-my-business"))&&("google_site_verification"!==s.ID&&"path"!==s.ID)))))):c}function p(e){return e.sharing.services.isFetching}},"./client/state/sites/media-storage/selectors.js":function(e,t,s){"use strict";function i(e,t){return e.sites.mediaStorage.items[t]}function o(e,t){return!!e.sites.mediaStorage.fetchingItems[t]}s.d(t,"a",function(){return i}),s.d(t,"b",function(){return o})},"./client/state/ui/action-log/selectors.js":function(e,t,s){"use strict";s.d(t,"a",function(){return n}),s.d(t,"d",function(){return r}),s.d(t,"c",function(){return a}),s.d(t,"b",function(){return l});var i=s("./node_modules/lodash/lodash.js"),o=s("./client/lib/create-selector/index.js");function n(e){return e.ui.actionLog}const r=Object(o.a)(e=>n(e).filter(e=>"ROUTE_SET"===e.type),e=>[e.ui.actionLog]),a=Object(o.a)(e=>Object(i.findLast)(n(e),e=>"ROUTE_SET"===e.type),e=>[e.ui.actionLog]),l=Object(o.a)(e=>Object(i.last)(e.ui.actionLog)||!1,e=>[e.ui.actionLog])},"./client/state/ui/guided-tours/actions.js":function(e,t,s){"use strict";s.d(t,"c",function(){return n}),s.d(t,"a",function(){return r}),s.d(t,"d",function(){return a}),s.d(t,"e",function(){return l}),s.d(t,"b",function(){return c}),s.d(t,"f",function(){return d});var i=s("./client/state/preferences/actions.js"),o=s("./client/state/preferences/selectors.js");function n(e){let t=e.tour,s=e.stepName,n=e.finished;const r={type:"GUIDED_TOUR_UPDATE",shouldShow:!1,shouldReallyShow:!1,tour:t,stepName:s,finished:n};return(e,s)=>{e(function(e,t){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Object(i.b)("guided-tours-history",[...Object(o.b)(e(),"guided-tours-history"),{timestamp:Date.now(),tourName:t,finished:s}])}(s,t,n)),e(r)}}function r(e){return{type:"GUIDED_TOUR_UPDATE",tour:e.tour,stepName:e.stepName,isPaused:!1}}function a(e){return r({tour:e,stepName:"init"})}function l(){return Object(i.b)("guided-tours-history",[])}function c(){return{type:"GUIDED_TOUR_PAUSE",isPaused:!0}}function d(){return{type:"GUIDED_TOUR_RESUME",isPaused:!1}}},"./client/state/ui/guided-tours/contexts.js":function(e,t,s){"use strict";s.d(t,"a",function(){return u}),s.d(t,"d",function(){return h}),s.d(t,"e",function(){return m}),s.d(t,"l",function(){return b}),s.d(t,"f",function(){return f}),s.d(t,"g",function(){return j}),s.d(t,"k",function(){return y}),s.d(t,"h",function(){return x}),s.d(t,"b",function(){return v}),s.d(t,"c",function(){return E}),s.d(t,"i",function(){return _}),s.d(t,"j",function(){return I});var i=s("./node_modules/lodash/lodash.js"),o=s("./client/components/tinymce/plugins/wpcom-track-paste/sources.js"),n=s("./client/config/index.js"),r=(s("./client/lib/abtest/index.js"),s("./client/lib/media/store.js")),a=s("./client/state/ui/selectors.js"),l=s("./client/state/ui/action-log/selectors.js"),c=s("./client/state/current-user/selectors.js"),d=(s("./client/state/selectors/can-current-user.js"),s("./client/state/sites/selectors.js"));const p=r.a.getAll,u=6048e5,h=e=>t=>Object(a.c)(t)===e,m=e=>()=>n.a.isEnabled(e),g=e=>{const t=Object(c.b)(e),s=t&&Date.parse(t.date);return!!s&&Date.now()-s},b=e=>t=>{const s=g(t);return!1!==s&&s<=e},f=e=>b(u)(e),j=e=>!f(e),y=e=>Object(i.get)(Object(a.d)(e),"is_previewable",!1),x=e=>Object(a.d)(e)&&Object(a.d)(e).is_customizable,v=e=>{const t=Object(a.e)(e);if(!t)return!1;const s=p(t);return s&&s.length&&s.length>0},E=e=>{const t=Object(l.b)(e)||!1;return t&&"EDITOR_PASTE_EVENT"===t.type&&t.source===o.a},_=e=>{const t=Object(a.e)(e);return!!t&&Object(d.J)(e,t)},I=e=>{const t=Object(a.e)(e);return!!t&&!Object(d.J)(e,t)}},"./client/state/ui/guided-tours/selectors/get-tours-history.js":function(e,t,s){"use strict";var i=s("./client/state/preferences/selectors.js");t.a=(e=>Object(i.b)(e,"guided-tours-history"))},"./client/state/ui/guided-tours/selectors/index.js":function(e,t,s){"use strict";var i=s("./node_modules/@babel/runtime/helpers/objectSpread.js"),o=s.n(i),n=s("./node_modules/lodash/lodash.js"),r=s("./node_modules/debug/src/browser.js"),a=s.n(r),l=s("./client/state/ui/selectors.js"),c=s("./client/state/selectors/get-current-query-arguments.js"),d=s("./client/state/selectors/get-initial-query-arguments.js"),p=s("./client/state/ui/action-log/selectors.js"),u=s("./client/state/preferences/selectors.js"),h=s("./client/layout/guided-tours/tours/activity-log-jetpack-intro-tour/meta.js"),m=s("./client/layout/guided-tours/tours/activity-log-wpcom-intro-tour/meta.js"),g=s("./client/layout/guided-tours/tours/main-tour/meta.js"),b=s("./client/layout/guided-tours/tours/tutorial-site-preview-tour/meta.js"),f=s("./client/layout/guided-tours/tours/gdocs-integration-tour/meta.js"),j=s("./client/layout/guided-tours/tours/simple-payments-tour/meta.js"),y=s("./client/layout/guided-tours/tours/editor-basics-tour/meta.js"),x=s("./client/layout/guided-tours/tours/media-basics-tour/meta.js"),v=s("./client/layout/guided-tours/tours/checklist-about-page-tour/meta.js"),E=s("./client/layout/guided-tours/tours/checklist-contact-page-tour/meta.js"),_=s("./client/layout/guided-tours/tours/checklist-domain-register-tour/meta.js"),I=s("./client/layout/guided-tours/tours/checklist-publish-post-tour/meta.js"),S=s("./client/layout/guided-tours/tours/checklist-site-icon-tour/meta.js"),O=s("./client/layout/guided-tours/tours/checklist-site-tagline-tour/meta.js"),C=s("./client/layout/guided-tours/tours/checklist-site-title-tour/meta.js"),P=s("./client/layout/guided-tours/tours/checklist-user-avatar-tour/meta.js"),w=s("./client/layout/guided-tours/tours/jetpack-basic-tour/meta.js"),R=s("./client/layout/guided-tours/tours/jetpack-backups-rewind-tour/meta.js"),k=s("./client/layout/guided-tours/tours/jetpack-monitoring-tour/meta.js"),N=s("./client/layout/guided-tours/tours/jetpack-plugin-updates-tour/meta.js"),T=s("./client/layout/guided-tours/tours/jetpack-sign-in-tour/meta.js"),D=s("./client/layout/guided-tours/tours/simple-payments-email-tour/meta.js"),M=s("./client/layout/guided-tours/tours/plugins-basic-tour/meta.js"),L={activityLogJetpackIntroTour:h.a,activityLogWpcomIntroTour:m.a,checklistAboutPage:v.a,checklistContactPage:E.a,checklistDomainRegister:_.a,checklistPublishPost:I.a,checklistSiteIcon:S.a,checklistSiteTagline:O.a,checklistSiteTitle:C.a,checklistUserAvatar:P.a,jetpack:w.a,jetpackBackupsRewind:R.a,jetpackMonitoring:k.a,jetpackPluginUpdates:N.a,jetpackSignIn:T.a,main:g.a,editorBasicsTour:y.a,mediaBasicsTour:x.a,tutorialSitePreview:b.a,gdocsIntegrationTour:f.a,simplePaymentsTour:j.a,simplePaymentsEmailTour:D.a,pluginsBasicTour:M.a},H=s("./client/lib/create-selector/index.js"),U=s("./client/state/ui/guided-tours/selectors/get-tours-history.js");s.d(t,"a",function(){return J});const A=["signup","upgrades","checkout-thank-you"],F=a()("calypso:guided-tours"),V=Object(n.flatMap)(L,(e,t)=>(e=>Array.isArray(e)?e:[e])(e.path).map(s=>({tour:t,when:e.when,path:s}))),q=Object(H.a)(e=>Object(n.uniq)(Object(p.a)(e).filter(e=>{return"ROUTE_SET"===e.type}).reduceRight((e,t)=>{let s=t.path;const i=V.filter(e=>{let t=e.path;return Object(n.startsWith)(s,t)}).map(e=>e.tour);return i?[...e,...i]:e},[])),[p.a]),B=Object(H.a)(e=>Object(n.uniq)(Object(n.map)(Object(U.a)(e),"tourName")),[U.a]),z=Object(H.a)(e=>{const t=Object(d.a)(e),s=Object(c.a)(e),i=["tour","_timestamp"],o=s&&s.tour?Object(n.pick)(s,i):Object(n.pick)(t,i),r=o.tour,a=o._timestamp;if(r&&Object(n.find)(V,{tour:r}))return{tour:r,_timestamp:a}},[d.a,c.a]),G=e=>{const t=z(e);if(t&&!((e,t)=>{let s=t.tour,i=t._timestamp;return Object(U.a)(e).some(e=>e.tourName===s&&e.timestamp>i)})(e,t))return t.tour},W=Object(H.a)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now();const s=Object(n.findLast)(Object(p.a)(e),{type:"GUIDED_TOUR_UPDATE",shouldShow:!1});return s&&t-s.timestamp<6e4},[p.a]),Y=e=>(e=>Object(n.includes)(A,Object(l.c)(e)))(e),K=Object(H.a)(e=>{if(!Y(e))return(e=>{const t=Object(n.findLast)(Object(p.a)(e),{type:"GUIDED_TOUR_UPDATE"});return t&&void 0===t.shouldShow&&t.tour})(e)||!(e=>W(e))(e)&&(G(e)||(e=>{if(!Object(u.e)(e))return void F("No fresh user preferences, bailing.");const t=Object(n.uniq)([...q(e)]),s=Object(n.uniq)([...B(e)]),i=Object(n.difference)(t,s);return Object(n.find)(i,t=>{const s=Object(n.find)(V,{tour:t}).when;return(void 0===s?Object(n.constant)(!0):s)(e)})})(e))||void 0},[p.a,U.a]),Q=e=>Object(n.get)(e,"ui.guidedTour",!1),J=Object(H.a)(e=>{const t={shouldShow:!1},s=Q(e),i=K(e),n="gutenberg"===Object(l.b)(e),r=!!i&&!n,a=!!s.isPaused;return F("tours: reached",q(e),"seen",B(e),"found",i),i?o()({},s,{tour:i,shouldShow:r,isPaused:a}):o()({},s,t)},[Q,p.a,u.e])},"./client/state/ui/media-modal/selectors.js":function(e,t,s){"use strict";function i(e){return e.ui.mediaModal.view}s.d(t,"a",function(){return i})}}]);