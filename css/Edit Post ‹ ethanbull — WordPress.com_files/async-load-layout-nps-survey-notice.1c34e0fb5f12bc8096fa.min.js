(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{"./client/blocks/nps-survey/index.jsx":function(e,s,t){"use strict";var n=t("./node_modules/@babel/runtime/helpers/defineProperty.js"),r=t.n(n),o=t("./node_modules/prop-types/index.js"),i=t.n(o),a=t("./node_modules/react/index.js"),c=t.n(a),l=t("./client/components/gridicon/index.jsx"),u=t("./node_modules/react-redux/es/index.js"),d=t("./node_modules/classnames/index.js"),p=t.n(d),h=t("./packages/i18n-calypso/dist/esm/index.js"),m=t("./node_modules/lodash/lodash.js"),S=t("./client/components/button/index.jsx"),y=t("./client/components/card/index.jsx"),b=t("./client/components/forms/form-textarea/index.jsx"),_=t("./client/components/screen-reader-text/index.js");class v extends a.Component{constructor(e){super(e),this.handleChange=this.handleChange.bind(this)}handleChange(e){this.props.onChange(parseInt(e.target.value,10))}render(){const e=p()("nps-survey__recommendation-option",{"is-selected":this.props.selected});return c.a.createElement("label",{className:e},c.a.createElement("input",{type:"radio",name:"nps-survey-recommendation-option",value:this.props.value,checked:this.props.selected,disabled:this.props.disabled,onChange:this.handleChange}),c.a.createElement("span",null,this.props.value))}}r()(v,"propTypes",{disabled:i.a.bool,selected:i.a.bool,value:i.a.number});var N=v;class E extends a.PureComponent{renderOption(e){return c.a.createElement(N,{key:e,value:e,selected:this.props.value===e,disabled:this.props.disabled,onChange:this.props.onChange})}render(){const e=this.props.translate,s=Object(m.range)(0,11).map(e=>this.renderOption(e));return c.a.createElement("div",{className:"nps-survey__recommendation-select"},c.a.createElement("div",{className:"nps-survey__scale-labels"},c.a.createElement("span",null,e("Unlikely",{context:"NPS",comment:"Answer to the question: How likely are you to recommend WordPress.com to your friends, family, or colleagues?"})),c.a.createElement("span",{className:"nps-survey__very-likely-label"},e("Very likely",{context:"NPS",comment:"Answer to the question: How likely are you to recommend WordPress.com to your friends, family, or colleagues?"}))),c.a.createElement("div",{className:"nps-survey__options"},s))}}r()(E,"propTypes",{disabled:i.a.bool});var f=Object(h.localize)(E),g=t("./client/state/nps-survey/actions.js"),k=t("./client/state/notices/actions.js"),j=t("./client/state/nps-survey/selectors.js"),C=t("./client/lib/analytics/index.js");class w extends a.Component{constructor(){super(...arguments),r()(this,"state",{score:null,feedback:"",showFeedbackForm:!1}),r()(this,"handleRecommendationSelectChange",e=>{this.setState({score:e})}),r()(this,"handleFinishClick",()=>{this.props.submitNpsSurvey(this.props.name,this.state.score),this.setState({showFeedbackForm:!0})}),r()(this,"handleDismissClick",()=>{this.props.hasAnswered||this.props.submitNpsSurveyWithNoScore(this.props.name),this.onClose(m.noop)}),r()(this,"handleTextBoxChange",e=>{this.setState({feedback:Object(m.trim)(e.target.value)})}),r()(this,"handleSendFeedbackClick",()=>{this.props.sendNpsSurveyFeedback(this.props.name,this.state.feedback),this.onClose(this.showThanksNotice)}),r()(this,"handleFeedbackFormClose",()=>{this.onClose(this.showThanksNotice)}),r()(this,"showThanksNotice",()=>{this.props.successNotice(this.props.translate("Thanks for your feedback!"),{duration:5e3})}),r()(this,"onClose",e=>{setTimeout(()=>{this.props.onClose(e)},0)})}componentWillMount(){C.default.mc.bumpStat("calypso_nps_survey","survey_displayed"),C.default.tracks.recordEvent("calypso_nps_survey_displayed")}renderScoreForm(){const e=this.props.translate;return c.a.createElement(a.Fragment,null,c.a.createElement("div",{className:"nps-survey__question"},e("How likely are you to recommend WordPress.com to your friends, family, or colleagues?")),c.a.createElement("div",{className:"nps-survey__recommendation-select-wrapper"},c.a.createElement(f,{value:this.state.score,disabled:this.props.hasAnswered,onChange:this.handleRecommendationSelectChange})),c.a.createElement("div",{className:"nps-survey__buttons"},c.a.createElement(S.a,{primary:!0,className:"nps-survey__finish-button",disabled:this.props.hasAnswered,onClick:this.handleFinishClick},e("Submit")),c.a.createElement(S.a,{borderless:!0,className:"nps-survey__not-answer-button",disabled:this.props.hasAnswered,onClick:this.handleDismissClick},e("Close"))))}renderFeedbackForm(){const e=this.props.translate;return c.a.createElement(a.Fragment,null,c.a.createElement("div",{className:"nps-survey__question"},e("What is the most important reason for your score?")),c.a.createElement("div",{className:"nps-survey__recommendation-select-wrapper"},c.a.createElement(b.a,{onChange:this.handleTextBoxChange,placeholder:e("Please input your thoughts here")})),c.a.createElement("div",{className:"nps-survey__buttons"},c.a.createElement(S.a,{primary:!0,className:"nps-survey__finish-button",disabled:!this.state.feedback,onClick:this.handleSendFeedbackClick},e("Submit")),c.a.createElement(S.a,{borderless:!0,className:"nps-survey__not-answer-button",onClick:this.handleFeedbackFormClose},e("Close"))))}render(){const e=this.props.translate,s=p()("nps-survey",{"is-recommendation-selected":Number.isInteger(this.state.score),"is-submitted":this.props.hasAnswered});return c.a.createElement(y.a,{className:s},c.a.createElement(S.a,{borderless:!0,className:"nps-survey__close-button",onClick:this.state.showFeedbackForm?this.handleFeedbackFormClose:this.handleDismissClick},c.a.createElement(l.a,{icon:"cross"}),c.a.createElement(_.a,null,e("Close"))),c.a.createElement("div",{className:"nps-survey__question-screen"},this.state.showFeedbackForm?this.renderFeedbackForm():this.renderScoreForm()))}}r()(w,"propTypes",{onClose:i.a.func,name:i.a.string});s.a=Object(u.b)(e=>({hasAnswered:Object(j.d)(e)}),{submitNpsSurvey:g.e,submitNpsSurveyWithNoScore:g.f,sendNpsSurveyFeedback:g.b,successNotice:k.f})(Object(h.localize)(w))},"./client/components/forms/form-textarea/index.jsx":function(e,s,t){"use strict";var n=t("./node_modules/@babel/runtime/helpers/extends.js"),r=t.n(n),o=t("./node_modules/@babel/runtime/helpers/objectWithoutProperties.js"),i=t.n(o),a=t("./node_modules/react/index.js"),c=t.n(a),l=t("./node_modules/classnames/index.js"),u=t.n(l);s.a=(e=>{let s=e.className,t=e.isError,n=e.isValid,o=e.children,a=i()(e,["className","isError","isValid","children"]);return c.a.createElement("textarea",r()({},a,{className:u()(s,"form-textarea",{"is-error":t,"is-valid":n})}),o)})},"./client/layout/nps-survey-notice/index.jsx":function(e,s,t){"use strict";t.r(s);var n=t("./node_modules/@babel/runtime/helpers/defineProperty.js"),r=t.n(n),o=t("./node_modules/react/index.js"),i=t.n(o),a=t("./node_modules/react-redux/es/index.js"),c=t("./client/components/dialog/index.jsx"),l=t("./client/blocks/nps-survey/index.jsx"),u=t("./client/config/index.js"),d=t("./client/state/nps-survey/actions.js");var p=t("./node_modules/lodash/lodash.js");function h(e){return Object(p.get)(e.ui,"npsSurveyNotice.isNpsSurveyDialogShowing",!1)}var m=t("./client/state/nps-survey/selectors.js"),S=t("./client/state/support/selectors.js"),y=t("./client/lib/analytics/index.js");const b="calypso-global-notice-radio-buttons-v1";s.default=Object(a.b)(e=>({isSupportSession:Object(S.a)(e),isNpsSurveyDialogShowing:h(e),hasAnswered:Object(m.d)(e),hasAnsweredWithNoScore:Object(m.e)(e),isSectionAndSessionEligible:Object(m.h)(e),wasShownThisSession:Object(m.i)(e)}),{setNpsSurveyDialogShowing:function(e){return{type:"NPS_SURVEY_DIALOG_IS_SHOWING",isShowing:e}},submitNpsSurveyWithNoScore:d.f,setupNpsSurveyDevTrigger:function(){return e=>{u.a.isEnabled("nps-survey/dev-trigger")&&(window.npsSurvey=function(){e(Object(d.c)(!0))})}},setupNpsSurveyEligibility:d.d,markNpsSurveyShownThisSession:d.a})(class extends o.Component{constructor(){super(...arguments),r()(this,"handleDialogClose",()=>{this.props.hasAnswered||this.props.hasAnsweredWithNoScore||this.props.submitNpsSurveyWithNoScore(b),this.props.setNpsSurveyDialogShowing(!1)}),r()(this,"handleSurveyClose",e=>{this.props.setNpsSurveyDialogShowing(!1),setTimeout(e,500)})}componentDidMount(){this.props.setupNpsSurveyEligibility(),this.props.setupNpsSurveyDevTrigger()}componentDidUpdate(){this.props.isSectionAndSessionEligible&&!this.props.wasShownThisSession&&(this.props.setNpsSurveyDialogShowing(!0),this.props.markNpsSurveyShownThisSession(),y.default.mc.bumpStat("calypso_nps_survey","notice_displayed"),y.default.tracks.recordEvent("calypso_nps_notice_displayed"))}render(){return this.props.isSupportSession||!this.props.isSectionAndSessionEligible?null:i.a.createElement(c.a,{additionalClassNames:"nps-survey-notice",isVisible:this.props.isNpsSurveyDialogShowing,onClose:this.handleDialogClose},i.a.createElement(l.a,{name:b,onClose:this.handleSurveyClose}))}})},"./client/state/nps-survey/actions.js":function(e,s,t){"use strict";t.d(s,"c",function(){return c}),t.d(s,"d",function(){return l}),t.d(s,"a",function(){return u}),t.d(s,"e",function(){return d}),t.d(s,"f",function(){return p}),t.d(s,"b",function(){return h});var n=t("./node_modules/debug/src/browser.js"),r=t.n(n),o=t("./client/lib/wp/browser.js"),i=t("./client/lib/analytics/index.js");const a=r()("calypso:nps-survey");function c(e){return{type:"NPS_SURVEY_SET_ELIGIBILITY",isSessionPicked:e}}function l(){return e=>(a("Checking NPS eligibility..."),o.a.undocumented().checkNPSSurveyEligibility().then(s=>{a("...Eligibility returned from endpoint.",s),e(c(s.display_survey))}).catch(s=>{a("...Error querying NPS survey eligibility.",s),e(c(!1))}))}function u(){return{type:"NPS_SURVEY_MARK_SHOWN_THIS_SESSION"}}function d(e,s){return t=>(a("Submitting NPS survey..."),t(function(e,s){return{type:"NPS_SURVEY_SUBMIT_REQUESTING",surveyName:e,score:s}}(e,s)),i.default.mc.bumpStat("calypso_nps_survey","survey_submitted"),i.default.tracks.recordEvent("calypso_nps_survey_submitted"),o.a.undocumented().submitNPSSurvey(e,s).then(()=>{a("...Successfully submitted NPS survey."),t({type:"NPS_SURVEY_SUBMIT_REQUEST_SUCCESS"})}).catch(e=>{a("...Error submitting NPS survey.",e),t(function(e){return{type:"NPS_SURVEY_SUBMIT_REQUEST_FAILURE",error:e}}(e))}))}function p(e){return s=>(a("Submitting NPS survey with no score..."),s(function(e){return{type:"NPS_SURVEY_SUBMIT_WITH_NO_SCORE_REQUESTING",surveyName:e}}(e)),i.default.mc.bumpStat("calypso_nps_survey","survey_dismissed"),i.default.tracks.recordEvent("calypso_nps_survey_dismissed"),o.a.undocumented().dismissNPSSurvey(e).then(()=>{a("...Successfully submitted NPS survey with no score."),s({type:"NPS_SURVEY_SUBMIT_WITH_NO_SCORE_REQUEST_SUCCESS"})}).catch(e=>{a("...Error submitting NPS survey with no score.",e),s(function(e){return{type:"NPS_SURVEY_SUBMIT_WITH_NO_SCORE_REQUEST_FAILURE",error:e}}(e))}))}function h(e,s){return t=>(a("Sending NPS survey feedback..."),t(function(e,s){return{type:"NPS_SURVEY_SEND_FEEDBACK_REQUESTING",surveyName:e,feedback:s}}(e,s)),i.default.mc.bumpStat("calypso_nps_survey","feedback_submitted"),i.default.tracks.recordEvent("calypso_nps_survey_feedback_submitted"),o.a.undocumented().sendNPSSurveyFeedback(e,s).then(()=>{a("...Successfully sent NPS survey feedback."),t({type:"NPS_SURVEY_SEND_FEEDBACK_REQUEST_SUCCESS"})}).catch(e=>{a("...Error sending NPS survey feedback."),t(function(e){return{type:"NPS_SURVEY_SEND_FEEDBACK_REQUEST_FAILURE",error:e}}(e))}))}},"./client/state/nps-survey/selectors.js":function(e,s,t){"use strict";t.d(s,"h",function(){return a}),t.d(s,"i",function(){return c}),t.d(s,"g",function(){return d}),t.d(s,"f",function(){return p}),t.d(s,"b",function(){return h}),t.d(s,"c",function(){return m}),t.d(s,"a",function(){return S}),t.d(s,"d",function(){return y}),t.d(s,"e",function(){return b});var n=t("./node_modules/lodash/lodash.js"),r=t("./client/state/nps-survey/constants.js"),o=t("./client/state/ui/selectors.js");const i=["discover","menus","people","plugins","posts-pages","reader","reader-activities","reader-list","reader-recommendations","reader-tags","settings","sharing","stats"];function a(e){return function(e){const s=Object(o.c)(e);return i.indexOf(s)>-1}(e)&&function(e){return Object(n.get)(e.npsSurvey,"isSessionEligible",!1)}(e)}function c(e){return Object(n.get)(e.npsSurvey,"wasShownThisSession",!1)}function l(e){return Object(n.get)(e.npsSurvey,"surveyState",r.a)}function u(e){return l(e)===r.a}function d(e){return l(e)===r.b}function p(e){return l(e)===r.d}function h(e){return Object(n.get)(e.npsSurvey,"surveyName",null)}function m(e){return Object(n.get)(e.npsSurvey,"score",null)}function S(e){return Object(n.get)(e.npsSurvey,"feedback",null)}function y(e){return!u(e)&&Number.isInteger(m(e))}function b(e){return!u(e)&&!Number.isInteger(m(e))}}}]);