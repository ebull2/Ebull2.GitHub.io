(window.webpackJsonp=window.webpackJsonp||[]).push([[107],{"./client/components/forms/form-input-validation/index.jsx":function(e,t,n){"use strict";n.d(t,"a",function(){return _});var o=n("./node_modules/@babel/runtime/helpers/defineProperty.js"),r=n.n(o),s=n("./node_modules/react/index.js"),c=n.n(s),a=n("./node_modules/prop-types/index.js"),i=n.n(a),l=n("./node_modules/classnames/index.js"),d=n.n(l),u=n("./client/components/gridicon/index.jsx");class _ extends c.a.Component{render(){const e=d()(this.props.className,{"form-input-validation":!0,"is-warning":this.props.isWarning,"is-error":this.props.isError,"is-hidden":this.props.isHidden}),t=this.props.isError||this.props.isWarning?"notice-outline":"checkmark";return c.a.createElement("div",{className:e,role:"alert"},c.a.createElement("span",{id:this.props.id},c.a.createElement(u.a,{size:24,icon:this.props.icon?this.props.icon:t})," ",this.props.text))}}r()(_,"displayName","FormInputValidation"),r()(_,"propTypes",{isError:i.a.bool,isWarning:i.a.bool,text:i.a.node,icon:i.a.string,id:i.a.string}),r()(_,"defaultProps",{isError:!1,id:null})},"./client/components/forms/form-label/index.jsx":function(e,t,n){"use strict";var o=n("./node_modules/@babel/runtime/helpers/extends.js"),r=n.n(o),s=n("./node_modules/@babel/runtime/helpers/objectWithoutProperties.js"),c=n.n(s),a=n("./node_modules/@babel/runtime/helpers/objectSpread.js"),i=n.n(a),l=n("./node_modules/react/index.js"),d=n.n(l),u=n("./node_modules/prop-types/index.js"),_=n.n(u),p=n("./node_modules/classnames/index.js"),O=n.n(p),m=n("./packages/i18n-calypso/dist/esm/index.js"),b=n("./node_modules/lodash/lodash.js");const j=e=>{let t=e.children,n=e.required,o=e.optional,s=e.translate,a=e.className,l=c()(e,["children","required","optional","translate","className"]);return t=d.a.Children.toArray(t)||[],n&&t.push((e=>d.a.createElement("small",{className:"form-label__required"},e("Required")))(s)),o&&t.push((e=>d.a.createElement("small",{className:"form-label__optional"},e("Optional")))(s)),d.a.createElement("label",r()({},Object(b.omit)(l,"moment","numberFormat"),{className:O()(a,"form-label")}),t.length?(e=>e.map((e,t)=>Object(b.isObject)(e)?i()({},e,{key:t}):e))(t):null)};j.propTypes={required:_.a.bool},t.a=Object(m.localize)(j)},"./client/state/login/actions.js":function(e,t,n){"use strict";var o=n("./node_modules/@babel/runtime/helpers/objectSpread.js"),r=n.n(o),s=n("./node_modules/superagent/lib/client.js"),c=n.n(s),a=n("./node_modules/lodash/lodash.js"),i=n("./packages/i18n-calypso/dist/esm/index.js"),l=n("./client/config/index.js"),d=n("./client/state/login/selectors.js"),u=n("./client/state/current-user/selectors.js"),_=n("./client/state/login/utils.js"),p=n("./client/lib/wp/browser.js"),O=n("./client/lib/i18n-utils/browser.js"),m=n("./client/state/analytics/actions.js"),b=n("./client/state/http/actions.js"),j=n("./client/state/data-layer/wpcom-http/utils.js"),g=n("./client/state/data-layer/handler-registry.js");const E=e=>(t,n)=>{const o=n(),r=Object(d.t)(o),s=Object(d.n)(o,"push"),c=Object(d.s)(o);t(Object(b.a)({url:Object(O.j)("https://wordpress.com/wp-login.php?action=two-step-authentication-endpoint"),method:"POST",headers:[["Content-Type","application/x-www-form-urlencoded"]],withCredentials:!0,body:{user_id:r,auth_type:"push",remember_me:!0,two_step_nonce:s,two_step_push_token:c,client_id:Object(l.a)("wpcom_signup_id"),client_secret:Object(l.a)("wpcom_signup_key")}},e))},T=Object(j.a)({fetch:E,onSuccess:(e,t)=>W(Object(a.get)(t,"body.data.token_links")),onError:(e,t)=>(e,n)=>{const o=!t.status,r=Object(a.get)(t,"response.body.data.two_step_nonce");if(r)e(f("push",r));else if(!o)return void e(Q());setTimeout(()=>{Object(d.q)(n())&&e(E(F()))},5e3)}});Object(g.b)("state/data-layer/wpcom/login-2fa/index.js",{TWO_FACTOR_AUTHENTICATION_PUSH_POLL_START:[T]});var C=n("./client/state/data-layer/wpcom-http/actions.js"),y=n("./client/state/data-layer/wpcom-http/pipeline/retry-on-failure/policies.js");const h=Object(j.a)({fetch:e=>Object(C.a)({path:"/users/".concat(e.usernameOrEmail,"/auth-options"),method:"GET",apiVersion:"1.1",retryPolicy:Object(y.b)()},e),onSuccess:(e,t)=>{return[{type:"LOGIN_AUTH_ACCOUNT_TYPE_REQUEST_SUCCESS",data:{type:Object(a.get)(t,"passwordless")?"passwordless":"regular"}},Object(m.j)("calypso_login_block_login_form_get_auth_type_success")]},onError:(e,t)=>{let n=t.error,o=t.message;return[{type:"LOGIN_AUTH_ACCOUNT_TYPE_REQUEST_FAILURE",error:{code:n,message:o,field:"usernameOrEmail"}},Object(m.j)("calypso_login_block_login_form_get_auth_type_failure",{error_code:n,error_message:o})]}});Object(g.b)("state/data-layer/wpcom/users/auth-options/index.js",{LOGIN_AUTH_ACCOUNT_TYPE_REQUESTING:[h]}),n.d(t,"h",function(){return A}),n.d(t,"p",function(){return f}),n.d(t,"i",function(){return U}),n.d(t,"g",function(){return N}),n.d(t,"b",function(){return I}),n.d(t,"a",function(){return R}),n.d(t,"d",function(){return L}),n.d(t,"c",function(){return P}),n.d(t,"m",function(){return k}),n.d(t,"n",function(){return F}),n.d(t,"o",function(){return Q}),n.d(t,"e",function(){return x}),n.d(t,"j",function(){return H}),n.d(t,"f",function(){return G}),n.d(t,"l",function(){return v}),n.d(t,"k",function(){return W});const w=e=>new Promise((t,n)=>{setTimeout(()=>n(new Error("timeout of ".concat(e," reached"))),e)}),S=e=>Promise.all(e.map(e=>(function(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:25e3;const o=new Promise(n=>{(t=document.createElement("iframe")).style.display="none",t.setAttribute("scrolling","no"),t.onload=n,t.src=e,document.body.appendChild(t)}),r=()=>{t.parentElement.removeChild(t)};return Promise.race([o,w(n)]).then(r,r)})(e)).map(e=>e.catch(()=>{}))),A=(e,t,n,o)=>r=>(r({type:"LOGIN_REQUEST"}),c.a.post(Object(O.j)("https://wordpress.com/wp-login.php?action=login-endpoint")).withCredentials().set("Content-Type","application/x-www-form-urlencoded").accept("application/json").send({username:e,password:t,remember_me:!0,redirect_to:n,client_id:Object(l.a)("wpcom_signup_id"),client_secret:Object(l.a)("wpcom_signup_key"),domain:o}).then(e=>("sms"===Object(a.get)(e,"body.data.two_step_notification_sent")&&r({type:"TWO_FACTOR_AUTHENTICATION_SEND_SMS_CODE_REQUEST_SUCCESS",notice:{message:Object(_.c)(e),status:"is-success"},twoStepNonce:Object(a.get)(e,"body.data.two_step_nonce_sms")}),Object(a.get)(e,"body.data.two_step_notification_sent")?r({type:"LOGIN_REQUEST_SUCCESS",data:e.body&&e.body.data}):S(Object(a.get)(e,"body.data.token_links",[])).then(()=>{r({type:"LOGIN_REQUEST_SUCCESS",data:e.body&&e.body.data})}))).catch(e=>{const t=Object(_.a)(e);return r({type:"LOGIN_REQUEST_FAILURE",error:t}),Promise.reject(t)})),f=(e,t)=>({type:"TWO_FACTOR_AUTHENTICATION_UPDATE_NONCE",nonceType:e,twoStepNonce:t}),U=(e,t)=>(n,o)=>(n({type:"TWO_FACTOR_AUTHENTICATION_LOGIN_REQUEST"}),c.a.post(Object(O.j)("https://wordpress.com/wp-login.php?action=two-step-authentication-endpoint")).withCredentials().set("Content-Type","application/x-www-form-urlencoded").accept("application/json").send({user_id:Object(d.t)(o()),auth_type:t,two_step_code:Object(a.replace)(e,/\s/g,""),two_step_nonce:Object(d.n)(o(),t),remember_me:!0,client_id:Object(l.a)("wpcom_signup_id"),client_secret:Object(l.a)("wpcom_signup_key")}).then(e=>S(Object(a.get)(e,"body.data.token_links",[])).then(()=>{n({type:"TWO_FACTOR_AUTHENTICATION_LOGIN_REQUEST_SUCCESS"})})).catch(e=>{const o=Object(a.get)(e,"response.body.data.two_step_nonce");o&&n(f(t,o));const r=Object(_.a)(e);return n({type:"TWO_FACTOR_AUTHENTICATION_LOGIN_REQUEST_FAILURE",error:r}),Promise.reject(r)})),N=(e,t)=>n=>(n({type:"SOCIAL_LOGIN_REQUEST"}),c.a.post(Object(O.j)("https://wordpress.com/wp-login.php?action=social-login-endpoint")).withCredentials().set("Content-Type","application/x-www-form-urlencoded").accept("application/json").send(r()({},e,{redirect_to:t,client_id:Object(l.a)("wpcom_signup_id"),client_secret:Object(l.a)("wpcom_signup_key")})).then(e=>("sms"===Object(a.get)(e,"body.data.two_step_notification_sent")&&n({type:"TWO_FACTOR_AUTHENTICATION_SEND_SMS_CODE_REQUEST_SUCCESS",notice:{message:Object(_.c)(e),status:"is-success"},twoStepNonce:Object(a.get)(e,"body.data.two_step_nonce_sms")}),S(Object(a.get)(e,"body.data.token_links",[])).then(()=>{n({type:"SOCIAL_LOGIN_REQUEST_SUCCESS",data:Object(a.get)(e,"body.data")})}))).catch(t=>{const o=Object(_.a)(t);return o.email=Object(a.get)(t,"response.body.data.email"),n({type:"SOCIAL_LOGIN_REQUEST_FAILURE",error:o,authInfo:e,data:Object(a.get)(t,"response.body.data")}),Promise.reject(o)})),I=(e,t)=>n=>(n({type:"SOCIAL_CREATE_ACCOUNT_REQUEST",notice:{message:Object(i.translate)("Creating your account")}}),p.a.undocumented().usersSocialNew(r()({},e,{signup_flow_name:t})).then(e=>{const t={username:e.username,bearerToken:e.bearer_token};return n({type:"SOCIAL_CREATE_ACCOUNT_REQUEST_SUCCESS",data:t}),t},e=>{const t=Object(_.b)(e);return n({type:"SOCIAL_CREATE_ACCOUNT_REQUEST_FAILURE",error:t}),Promise.reject(t)})),R=(e,t)=>n=>(n({type:"SOCIAL_CONNECT_ACCOUNT_REQUEST",notice:{message:Object(i.translate)("Creating your account")}}),p.a.undocumented().me().socialConnect(r()({},e,{redirect_to:t})).then(e=>{n({type:"SOCIAL_CONNECT_ACCOUNT_REQUEST_SUCCESS",redirect_to:e.redirect_to})},e=>{const t=Object(_.b)(e);return n({type:"SOCIAL_CONNECT_ACCOUNT_REQUEST_FAILURE",error:t}),Promise.reject(t)})),L=e=>t=>(t({type:"SOCIAL_DISCONNECT_ACCOUNT_REQUEST",notice:{message:Object(i.translate)("Creating your account")}}),p.a.undocumented().me().socialDisconnect(e).then(()=>{t({type:"SOCIAL_DISCONNECT_ACCOUNT_REQUEST_SUCCESS"})},e=>{const n=Object(_.b)(e);return t({type:"SOCIAL_DISCONNECT_ACCOUNT_REQUEST_FAILURE",error:n}),Promise.reject(n)})),P=(e,t)=>({type:"SOCIAL_CREATE_ACCOUNT_REQUEST_FAILURE",authInfo:e,error:t.field?t:Object(_.b)(t)}),k=()=>(e,t)=>(e({type:"TWO_FACTOR_AUTHENTICATION_SEND_SMS_CODE_REQUEST",notice:{message:Object(i.translate)("Sending you a text message…")}}),c.a.post(Object(O.j)("https://wordpress.com/wp-login.php?action=send-sms-code-endpoint")).set("Content-Type","application/x-www-form-urlencoded").accept("application/json").send({user_id:Object(d.t)(t()),two_step_nonce:Object(d.n)(t(),"sms"),client_id:Object(l.a)("wpcom_signup_id"),client_secret:Object(l.a)("wpcom_signup_key")}).then(t=>{const n=Object(_.c)(t);e({type:"TWO_FACTOR_AUTHENTICATION_SEND_SMS_CODE_REQUEST_SUCCESS",notice:{message:n,status:"is-success"},twoStepNonce:Object(a.get)(t,"body.data.two_step_nonce")})}).catch(t=>{const n=Object(_.a)(t);e({type:"TWO_FACTOR_AUTHENTICATION_SEND_SMS_CODE_REQUEST_FAILURE",error:n,twoStepNonce:Object(a.get)(t,"response.body.data.two_step_nonce")})})),F=()=>({type:"TWO_FACTOR_AUTHENTICATION_PUSH_POLL_START"}),Q=()=>({type:"TWO_FACTOR_AUTHENTICATION_PUSH_POLL_STOP"}),x=()=>({type:"LOGIN_FORM_UPDATE"}),H=e=>(t,n)=>{t({type:"LOGOUT_REQUEST"});const o=(Object(u.b)(n()).logout_URL||"").match(/_wpnonce=([^&]*)/),r=o&&o[1];return c.a.post(Object(O.j)("https://wordpress.com/wp-login.php?action=logout-endpoint")).withCredentials().set("Content-Type","application/x-www-form-urlencoded").accept("application/json").send({redirect_to:e,client_id:Object(l.a)("wpcom_signup_id"),client_secret:Object(l.a)("wpcom_signup_key"),logout_nonce:r}).then(e=>{const n=Object(a.get)(e,"body.data",{});return t({type:"LOGOUT_REQUEST_SUCCESS",data:n}),Promise.resolve(n)}).catch(e=>{const n=Object(_.a)(e);return t({type:"LOGOUT_REQUEST_FAILURE",error:n}),Promise.reject(n)})},G=e=>t=>{if(t(Object(m.j)("calypso_login_block_login_form_get_auth_type")),t({type:"LOGIN_AUTH_ACCOUNT_TYPE_REQUEST",usernameOrEmail:e}),""===e){const e={code:"empty_username",message:Object(i.translate)("Please enter a username or email address."),field:"usernameOrEmail"};return t(Object(m.j)("calypso_login_block_login_form_get_auth_type_failure",{error_code:e.code,error_message:e.message})),void Object(a.defer)(()=>{t({type:"LOGIN_AUTH_ACCOUNT_TYPE_REQUEST_FAILURE",error:e})})}t({type:"LOGIN_AUTH_ACCOUNT_TYPE_REQUESTING",usernameOrEmail:e})},v=()=>({type:"LOGIN_AUTH_ACCOUNT_TYPE_RESET"}),W=e=>t=>{if(!Array.isArray(e))return t({type:"TWO_FACTOR_AUTHENTICATION_PUSH_POLL_COMPLETED"});S(e).then(()=>t({type:"TWO_FACTOR_AUTHENTICATION_PUSH_POLL_COMPLETED"}))}},"./client/state/login/selectors.js":function(e,t,n){"use strict";n.d(t,"t",function(){return r}),n.d(t,"n",function(){return s}),n.d(t,"p",function(){return c}),n.d(t,"s",function(){return a}),n.d(t,"q",function(){return i}),n.d(t,"r",function(){return l}),n.d(t,"y",function(){return d}),n.d(t,"o",function(){return u}),n.d(t,"x",function(){return _}),n.d(t,"v",function(){return p}),n.d(t,"g",function(){return O}),n.d(t,"h",function(){return m}),n.d(t,"e",function(){return b}),n.d(t,"f",function(){return j}),n.d(t,"u",function(){return g}),n.d(t,"a",function(){return E}),n.d(t,"w",function(){return T}),n.d(t,"d",function(){return C}),n.d(t,"c",function(){return y}),n.d(t,"b",function(){return h}),n.d(t,"i",function(){return w}),n.d(t,"j",function(){return S}),n.d(t,"l",function(){return A}),n.d(t,"m",function(){return f}),n.d(t,"k",function(){return U});var o=n("./node_modules/lodash/lodash.js");const r=e=>Object(o.get)(e,"login.twoFactorAuth.user_id",null),s=(e,t)=>Object(o.get)(e,"login.twoFactorAuth.two_step_nonce_".concat(t),null),c=e=>Object(o.get)(e,"login.twoFactorAuth.two_step_notification_sent",null),a=e=>Object(o.get)(e,"login.twoFactorAuth.push_web_token",null),i=e=>Object(o.get)(e,"login.twoFactorAuthPushPoll.inProgress",!1),l=e=>Object(o.get)(e,"login.twoFactorAuthPushPoll.success",!1),d=e=>{const t=Object(o.get)(e,"login.twoFactorAuth");return!Object(o.isEmpty)(t)},u=e=>Object(o.get)(e,"login.twoFactorAuthRequestError",null),_=(e,t)=>{const n=(e=>Object(o.get)(e,"login.twoFactorAuth.two_step_supported_auth_types",null))(e);return n&&n.indexOf(t)>=0},p=e=>Object(o.get)(e,"login.isRequesting",!1),O=e=>Object(o.get)(e,"login.requestError",null),m=e=>Object(o.get)(e,"login.requestNotice",null),b=e=>Object(o.get)(e,"login.redirectTo.original",null),j=e=>Object(o.get)(e,"login.redirectTo.sanitized",null),g=e=>Object(o.get)(e,"login.isFormDisabled",!1),E=e=>Object(o.get)(e,"login.authAccountType",null),T=e=>Object(o.get)(e,"login.socialAccount.isCreating",null),C=e=>Object(o.get)(e,"login.socialAccount.username",null),y=e=>Object(o.get)(e,"login.socialAccount.bearerToken",null),h=e=>Object(o.get)(e,"login.socialAccount.createError",null),w=e=>Object(o.get)(e,"login.socialAccount.requestError",null),S=e=>Object(o.get)(e,"login.socialAccountLink.isLinking",null),A=e=>Object(o.get)(e,"login.socialAccountLink.email",null),f=e=>Object(o.get)(e,"login.socialAccountLink.authInfo.service",null),U=e=>Object(o.get)(e,"login.socialAccountLink.authInfo",null)},"./client/state/login/utils.js":function(e,t,n){"use strict";n.d(t,"c",function(){return d}),n.d(t,"a",function(){return _}),n.d(t,"b",function(){return p}),n.d(t,"e",function(){return O}),n.d(t,"d",function(){return m});var o=n("./node_modules/@babel/runtime/helpers/objectSpread.js"),r=n.n(o),s=n("./node_modules/react/index.js"),c=n.n(s),a=n("./node_modules/lodash/lodash.js"),i=n("./packages/i18n-calypso/dist/esm/index.js"),l=n("./client/lib/i18n-utils/browser.js");function d(e){const t=Object(a.get)(e,"body.data.phone_number");return Object(i.translate)("Message sent to phone number ending in %(phoneNumber)s",{args:{phoneNumber:t}})}const u={empty_password:"password",empty_two_step_code:"twoStepCode",empty_username:"usernameOrEmail",incorrect_password:"password",invalid_email:"usernameOrEmail",invalid_two_step_code:"twoStepCode",invalid_username:"usernameOrEmail"};function _(e){let t="global";if(!e.status)return{code:"network_error",message:e.message,field:t};const n=Object(a.get)(e,"response.body.data.errors[0].code");if(n)if(n in u)t=u[n];else if("admin_login_attempt"===n){const e=Object(l.j)("https://wordpress.com/wp-login.php?action=lostpassword");return{code:n,message:c.a.createElement("div",null,c.a.createElement("p",null,Object(i.translate)("You attempted to login with the username {{em}}admin{{/em}} on WordPress.com.",{components:{em:c.a.createElement("em",null)}})),c.a.createElement("p",null,Object(i.translate)("If you were trying to access your self hosted {{a}}WordPress.org{{/a}} site, try {{strong}}yourdomain.com/wp-admin/{{/strong}} instead.",{components:{a:c.a.createElement("a",{href:"http://wordpress.org",target:"_blank",rel:"noopener noreferrer"}),strong:c.a.createElement("strong",null)}})),c.a.createElement("p",null,Object(i.translate)("If you can’t remember your WordPress.com username, you can {{a}}reset your password{{/a}} by providing your email address.",{components:{a:c.a.createElement("a",{href:e,rel:"external"})}}))),field:t}}let o=Object(a.get)(e,"response.body.data.errors[0].message");return o||(o=Object(a.get)(e,"response.body.data",e.message)),{code:n,message:o,field:t}}const p=e=>r()({message:e.message,code:e.error,field:"global"},Object(a.omit)(e,["error","message","field"])),O=e=>"regular"===e,m=e=>"passwordless"===e}}]);