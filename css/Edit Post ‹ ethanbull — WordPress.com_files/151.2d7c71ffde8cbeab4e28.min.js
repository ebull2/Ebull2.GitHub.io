(window.webpackJsonp=window.webpackJsonp||[]).push([[151],{"./client/lib/media/constants.js":function(e,t,i){"use strict";i.d(t,"i",function(){return n}),i.d(t,"h",function(){return o}),i.d(t,"j",function(){return a}),i.d(t,"a",function(){return r}),i.d(t,"c",function(){return s}),i.d(t,"b",function(){return d}),i.d(t,"f",function(){return c}),i.d(t,"e",function(){return p}),i.d(t,"d",function(){return l}),i.d(t,"g",function(){return m});const n={FILE_TYPE_UNSUPPORTED:"FILE_TYPE_UNSUPPORTED",FILE_TYPE_NOT_IN_PLAN:"FILE_TYPE_NOT_IN_PLAN",SERVER_ERROR:"SERVER_ERROR",UPLOAD_VIA_URL_404:"UPLOAD_VIA_URL_404",EXCEEDS_MAX_UPLOAD_SIZE:"EXCEEDS_MAX_UPLOAD_SIZE",EXCEEDS_PLAN_STORAGE_LIMIT:"EXCEEDS_PLAN_STORAGE_LIMIT",NOT_ENOUGH_SPACE:"NOT_ENOUGH_SPACE",SERVICE_FAILED:"SERVICE_FAILED",SERVICE_AUTH_FAILED:"SERVICE_AUTH_FAILED"},o={thumbnail:{width:150,height:150},medium:{width:300,height:300},large:{width:1024,height:1024}},a=["ogv","mp4","m4v","mov","wmv","avi","mpg","3gp","3g2"],r=["default","circle","square"],s=["default"],d={items:[],type:"default",columns:3,orderBy:"menu_order",link:"",size:"thumbnail"},c={jpg:"image/jpeg",jpeg:"image/jpeg",jpe:"image/jpeg",gif:"image/gif",png:"image/png",bmp:"image/bmp",tif:"image/tiff",tiff:"image/tiff",ico:"image/x-icon",asf:"video/x-ms-asf",asx:"video/x-ms-asf",wmv:"video/x-ms-wmv",wmx:"video/x-ms-wmx",wm:"video/x-ms-wm",avi:"video/avi",divx:"video/divx",flv:"video/x-flv",mov:"video/quicktime",qt:"video/quicktime",mpeg:"video/mpeg",mpg:"video/mpeg",mpe:"video/mpeg",mp4:"video/mp4",m4v:"video/mp4",ogv:"video/ogg",webm:"video/webm",mkv:"video/x-matroska",txt:"text/plain",asc:"text/plain",c:"text/plain",cc:"text/plain",h:"text/plain",csv:"text/csv",tsv:"text/tab-separated-values",ics:"text/calendar",rtx:"text/richtext",css:"text/css",htm:"text/html",html:"text/html",mp3:"audio/mpeg",m4a:"audio/mpeg",m4b:"audio/mpeg",ra:"audio/x-realaudio",ram:"audio/x-realaudio",wav:"audio/wav",ogg:"audio/ogg",oga:"audio/ogg",mid:"audio/midi",midi:"audio/midi",wma:"audio/x-ms-wma",wax:"audio/x-ms-wax",mka:"audio/x-matroska",rtf:"application/rtf",js:"application/javascript",pdf:"application/pdf",swf:"application/x-shockwave-flash",class:"application/java",tar:"application/x-tar",zip:"application/zip",gz:"application/x-gzip",gzip:"application/x-gzip",rar:"application/rar","7z":"application/x-7z-compressed",exe:"application/x-msdownload",doc:"application/msword",pot:"application/vnd.ms-powerpoint",pps:"application/vnd.ms-powerpoint",ppt:"application/vnd.ms-powerpoint",wri:"application/vnd.ms-write",xla:"application/vnd.ms-excel",xls:"application/vnd.ms-excel",xlt:"application/vnd.ms-excel",xlw:"application/vnd.ms-excel",mdb:"application/vnd.ms-access",mpp:"application/vnd.ms-project",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",docm:"application/vnd.ms-word.document.macroEnabled.12",dotx:"application/vnd.openxmlformats-officedocument.wordprocessingml.template",dotm:"application/vnd.ms-word.template.macroEnabled.12",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.12",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.12",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template",xltm:"application/vnd.ms-excel.template.macroEnabled.12",xlam:"application/vnd.ms-excel.addin.macroEnabled.12",pptx:"application/vnd.openxmlformats-officedocument.presentationml.presentation",pptm:"application/vnd.ms-powerpoint.presentation.macroEnabled.12",ppsx:"application/vnd.openxmlformats-officedocument.presentationml.slideshow",ppsm:"application/vnd.ms-powerpoint.slideshow.macroEnabled.12",potx:"application/vnd.openxmlformats-officedocument.presentationml.template",potm:"application/vnd.ms-powerpoint.template.macroEnabled.12",ppam:"application/vnd.ms-powerpoint.addin.macroEnabled.12",sldx:"application/vnd.openxmlformats-officedocument.presentationml.slide",sldm:"application/vnd.ms-powerpoint.slide.macroEnabled.12",onetoc:"application/onenote",onetoc2:"application/onenote",onetmp:"application/onenote",onepkg:"application/onenote",odt:"application/vnd.oasis.opendocument.text",odp:"application/vnd.oasis.opendocument.presentation",ods:"application/vnd.oasis.opendocument.spreadsheet",odg:"application/vnd.oasis.opendocument.graphics",odc:"application/vnd.oasis.opendocument.chart",odb:"application/vnd.oasis.opendocument.database",odf:"application/vnd.oasis.opendocument.formula",wp:"application/wordperfect",wpd:"application/wordperfect",key:"application/vnd.apple.keynote",numbers:"application/vnd.apple.numbers",pages:"application/vnd.apple.pages"},p="MEDIA_IMAGE_THUMBNAIL",l="MEDIA_IMAGE_RESIZER",m=[.077,.115,.157,.24,.323]},"./client/lib/media/store.js":function(e,t,i){"use strict";var n=i("./node_modules/lodash/lodash.js"),o=i("./client/lib/media/utils.js"),a=i("./client/dispatcher/index.js"),r=i("./client/lib/mixins/emitter/index.js"),s=i("./client/lib/media/validation-store.js");const d={_media:{},_pointers:{}};function c(e,t,i){if(e in d._media||(d._media[e]={}),i){e in d._pointers||(d._pointers[e]={}),d._pointers[e][i]=t.ID;const n=d._media[e][i];Object(o.k)(n)&&(t.description=n.description,t.alt=n.alt,t.caption=n.caption),delete d._media[e][i]}d._media[e][t.ID]=t}function p(e,t){e in d._media&&(d._media[e][t.ID]={ID:t.ID,status:t.status})}Object(r.a)(d),d.get=function(e,t){if(e in d._media)return e in d._pointers&&t in d._pointers[e]?d.get(e,d._pointers[e][t]):d._media[e][t]},d.getAll=function(e){if(e in d._media)return Object(n.values)(d._media[e])},d.dispatchToken=a.a.register(function(e){const t=e.action;switch(a.a.waitFor([s.a.dispatchToken]),t.type){case"CHANGE_MEDIA_SOURCE":i=t.siteId,d._pointers[i]={},d._media[i]={},d.emit("change");break;case"CREATE_MEDIA_ITEM":case"RECEIVE_MEDIA_ITEM":case"RECEIVE_MEDIA_ITEMS":if(t.error&&t.siteId&&t.id&&(p(t.siteId,{ID:t.id}),d.emit("change")),t.error||!t.siteId||!t.data)break;Array.isArray(t.data.media)?function(e,t){t.forEach(function(t){c(e,t)})}(t.siteId,t.data.media):c(t.siteId,t.data,t.id),d.emit("change","RECEIVE_MEDIA_ITEM"===t.type&&t);break;case"REMOVE_MEDIA_ITEM":if(!t.siteId||!t.data)break;t.error?c(t.siteId,t.data):p(t.siteId,t.data),d.emit("change","deleted"===t.data.status&&t);break;case"FETCH_MEDIA_ITEM":if(!t.siteId||!t.id)break;c(t.siteId,{ID:t.id}),d.emit("change");break;case"FETCH_MEDIA_LIMITS":if(!t.siteId)break;d.emit("fetch-media-limits")}var i}),t.a=d},"./client/lib/media/utils.js":function(e,t,i){"use strict";i.d(t,"s",function(){return x}),i.d(t,"g",function(){return h}),i.d(t,"h",function(){return v}),i.d(t,"d",function(){return b}),i.d(t,"r",function(){return w}),i.d(t,"l",function(){return j}),i.d(t,"f",function(){return A}),i.d(t,"n",function(){return R}),i.d(t,"m",function(){return O}),i.d(t,"j",function(){return L}),i.d(t,"p",function(){return D}),i.d(t,"q",function(){return y}),i.d(t,"i",function(){return T}),i.d(t,"e",function(){return U}),i.d(t,"a",function(){return k}),i.d(t,"b",function(){return M}),i.d(t,"k",function(){return C}),i.d(t,"o",function(){return S}),i.d(t,"c",function(){return N});var n=i("./node_modules/url/url.js"),o=i.n(n),a=i("./node_modules/path-browserify/index.js"),r=i.n(a),s=i("./packages/photon/dist/esm/index.js"),d=i.n(s),c=i("./node_modules/lodash/lodash.js"),p=i("./node_modules/valid-url/index.js"),l=i("./client/lib/resize-image-url/index.js"),m=i("./client/lib/media/constants.js"),u=i("./client/lib/shortcode/index.js"),f=i("./client/lib/impure-lodash/index.js"),_=i("./client/lib/version-compare/index.js");const E=f.a.uniqueId,g=/^[a-z\d]+$/i;function x(e,t){if(e){if(e.transient)return e.URL;if(e.URL)return(t=t||{}).photon?t.maxWidth?d()(e.URL,{width:t.maxWidth}):t.resize?d()(e.URL,{resize:t.resize}):d()(e.URL):e.thumbnails&&t.size in e.thumbnails?e.thumbnails[t.size]:t.maxWidth?Object(l.a)(e.URL,{w:t.maxWidth}):t.resize?Object(l.a)(e.URL,{resize:t.resize}):e.URL}}function I(e){let t;if(!e)return;const i="string"==typeof e,n="File"in window&&e instanceof window.File;if(i){let i;i=Object(p.isUri)(e)?o.a.parse(e).pathname:e,t=r.a.extname(i).slice(1)}else if(n)t=r.a.extname(e.name).slice(1);else if(e.extension)t=e.extension;else{const i=o.a.parse(e.URL||e.file||e.guid||"").pathname||"";t=r.a.extname(i).slice(1)}return t}function h(e){const t=v(e);if(!t)return;const i=t.match(/^([^\/]+)\//);return i?i[1]:void 0}function v(e){if(!e)return;if(e.mime_type)return e.mime_type;if("File"in window&&e instanceof window.File)return e.type;let t=I(e);return t?(t=t.toLowerCase(),m.f.hasOwnProperty(t)?m.f[t]:void 0):void 0}function b(e,t){return e.filter(function(e){return h(e)===t})}function w(e){return e.slice(0).sort(function(e,t){if(e.date&&t.date){const i=Date.parse(t.date)-Date.parse(e.date);if(0!==i)return i}return t.ID-e.ID})}function j(e){return!e||!e.jetpack}function A(e){return e?e.options.allowed_file_types:[]}function R(e,t){return!(!t||!e)&&(!j(t)||m.j.some(function(t){return t.toLowerCase()===e.extension.toLowerCase()}))}function O(e,t){return!(!t||!e)&&(!j(t)||A(t).some(function(t){return t.toLowerCase()===e.extension.toLowerCase()}))}function L(e,t){const i=e.size;return t&&t.options&&isFinite(i)&&t.options.max_upload_size?t.jetpack&&Object(c.includes)(Object(c.get)(t,"options.active_modules"),"videopress")&&Object(_.a)(Object(c.get)(t,"options.jetpack_version"),"4.5",">=")&&Object(c.startsWith)(v(e),"video/")?null:i>t.options.max_upload_size:null}function D(e){return!(!e||!e.videopress_guid)&&g.test(e.videopress_guid)}function y(e){if(isNaN(e))return;const t=Math.floor(e/3600);let i=[Math.floor(e/60)%60,Math.floor(e)%60].map(function(e){return("0"+e).slice(-2)}).join(":");return t&&(i=[t,i].join(":")),-1===(i=i.replace(/^(00:)+/g,"")).indexOf(":")&&(i="0:"+i),i.replace(/^0(\d)(.*)/,"$1$2")}function T(e,t){let i,n;return t&&t.options&&(i=t.options["image_"+e+"_width"],n=t.options["image_"+e+"_height"]),e in m.h&&(i=i||m.h[e].width,n=n||m.h[e].height),{width:i,height:n}}function U(e){let t;if(e.items.length)return delete(t=Object.assign({ids:e.items.map(e=>e.ID).join()},e)).items,Object(c.includes)(m.a,t.type)||delete t.columns,Object(c.includes)(m.c,t.type)||delete t.size,(t=Object(c.omitBy)(t,function(e,t){return m.b[t]===e})).orderBy&&(t.orderby=t.orderBy,delete t.orderBy),Object(u.c)({tag:"gallery",type:"single",attrs:t})}function k(e,t,i){return t.ID===e.author_ID?i.capabilities.delete_posts:i.capabilities.delete_others_posts}function M(e,t,i,n){HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(e,t,i){const n=atob(this.toDataURL(t,i).split(",")[1]),o=n.length,a=new Uint8Array(o);for(let e=0;e<o;e++)a[e]=n.charCodeAt(e);e(new Blob([a],{type:t||"image/png"}))}}),e.toBlob(t,i,n)}function C(e){return e?!!e.transient:null}function S(e){return!(!e||!e.URL)}function N(e){const t={transient:!0,ID:E("media-")};if("string"==typeof e)Object.assign(t,{file:e,title:r.a.basename(e),extension:I(e),mime_type:v(e)});else if(e.thumbnails)Object.assign(t,{file:e.URL,title:e.name,caption:e.caption||"",extension:e.extension,mime_type:e.mime_type,guid:e.URL,URL:e.URL,external:!0});else{const i=e.fileContents||e,n=e.fileName||e.name,o=window.URL.createObjectURL(i);Object.assign(t,{URL:o,guid:o,file:n,title:e.title||r.a.basename(n),extension:I(e.fileName||i),mime_type:v(e.fileName||i),size:i.size})}return t}},"./client/lib/media/validation-store.js":function(e,t,i){"use strict";var n=i("./node_modules/lodash/lodash.js"),o=i("./client/dispatcher/index.js"),a=i("./client/lib/mixins/emitter/index.js"),r=i("./client/lib/media/utils.js"),s=i("./client/lib/media/constants.js");const d={_errors:{}};function c(e){e in d._errors||(d._errors[e]={})}Object(a.a)(d);d.validateItem=function(e,t){const i=[];e&&(r.m(t,e)||(r.n(t,e)?i.push(s.i.FILE_TYPE_NOT_IN_PLAN):i.push(s.i.FILE_TYPE_UNSUPPORTED)),!0===r.j(t,e)&&i.push(s.i.EXCEEDS_MAX_UPLOAD_SIZE),i.length&&(c(e.ID),d._errors[e.ID][t.ID]=i))},d.clearValidationErrors=function(e,t){e in d._errors&&(t?delete d._errors[e][t]:delete d._errors[e])},d.clearValidationErrorsByType=function(e,t){e in d._errors&&(d._errors[e]=Object(n.pickBy)(Object(n.mapValues)(d._errors[e],e=>Object(n.without)(e,t)),e=>!Object(n.isEmpty)(e)))},d.getAllErrors=function(e){return d._errors[e]||{}},d.getErrors=function(e,t){return e in d._errors&&d._errors[e][t]||[]},d.hasErrors=function(e,t){return t?d.getErrors(e,t).length:Object.keys(d.getAllErrors(e)).length},d.dispatchToken=o.a.register(function(e){const t=e.action;let i,n;switch(t.type){case"CREATE_MEDIA_ITEM":if(!t.siteId||!t.data)break;(n=(i=Array.isArray(t.data.media)?t.data.media:[t.data]).reduce(function(e,i){d.validateItem(t.site,i);const n=d.getErrors(t.siteId,i.ID);return n.length&&(e[i.ID]=n),e},{}))&&Object.keys(n).length&&(t.error=d.getAllErrors(t.siteId),d.emit("change"));break;case"RECEIVE_MEDIA_ITEM":case"RECEIVE_MEDIA_ITEMS":if(!(e=>e.error&&(e.id||(e=>e.error&&("servicefail"===e.error||"keyring_token_error"===e.error))(e.error)))(t))break;n=Array.isArray(t.error.errors)?t.error.errors:[t.error],function(e,t,i){c(e),d._errors[e][t]=i.map(e=>{switch(e.error){case"http_404":return s.i.UPLOAD_VIA_URL_404;case"upload_error":return 0===e.message.indexOf("Not enough space to upload")?s.i.NOT_ENOUGH_SPACE:0===e.message.indexOf("You have used your space quota")?s.i.EXCEEDS_PLAN_STORAGE_LIMIT:s.i.SERVER_ERROR;case"keyring_token_error":return s.i.SERVICE_AUTH_FAILED;case"servicefail":return s.i.SERVICE_FAILED;default:return s.i.SERVER_ERROR}})}(t.siteId,t.id?t.id:0,n),d.emit("change");break;case"CHANGE_MEDIA_SOURCE":case"CLEAR_MEDIA_VALIDATION_ERRORS":if(!t.siteId)break;t.errorType?d.clearValidationErrorsByType(t.siteId,t.errorType):d.clearValidationErrors(t.siteId,t.itemId),d.emit("change")}}),t.a=d}}]);